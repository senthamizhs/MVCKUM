@using System.Configuration;
@{
    string StrVersion = ConfigurationManager.AppSettings["updateversion"] != null ? ConfigurationManager.AppSettings["updateversion"].ToString() : "";
    string assignedcurrency = Session["App_currency"] != null && Session["App_currency"].ToString() != "" ? Session["App_currency"].ToString() : ConfigurationManager.AppSettings["currency"].ToString();
    string apptheme = ConfigurationManager.AppSettings["apptheme"] != null ? ConfigurationManager.AppSettings["apptheme"].ToString() : "";
    string twooneway = ConfigurationManager.AppSettings["2oneway"] != null ? ConfigurationManager.AppSettings["2oneway"].ToString() : "";
    string Allowcalendar = ConfigurationManager.AppSettings["Allowcalendar"] != null ? ConfigurationManager.AppSettings["Allowcalendar"].ToString() : "0";
    string assignedcountry = ConfigurationManager.AppSettings["COUNTRY"] != null ? ConfigurationManager.AppSettings["COUNTRY"].ToString() : "";
    string qrystrflg = Session["UniqueSessionid"] != null ? Session["UniqueSessionid"].ToString() : "v1.0";
    string app_login_Currencycode = Session["Allowappcurrency"] != null && Session["Allowappcurrency"].ToString() != "" ? Session["Allowappcurrency"].ToString() : "";
    string Product = ConfigurationManager.AppSettings["Producttype"].ToString();
    string ClientID = Session["POS_ID"] != null ? Session["POS_ID"].ToString() : "";
    string BranchID = Session["branchid"] != null ? Session["branchid"].ToString() : "";
    string ClientName = Session["agencyname"] != null ? Session["agencyname"].ToString() : "";
    string strTerminaltype = Session["TERMINALTYPE"] != null && Session["TERMINALTYPE"].ToString() != "" ? Session["TERMINALTYPE"].ToString() : ConfigurationManager.AppSettings["TerminalType"].ToString().ToUpper();
    string strAppHosting = ConfigurationManager.AppSettings["APP_HOSTING"].ToString().ToUpper();
    string strImageURL = ConfigurationManager.AppSettings["LogoUrl"].ToString();
    string strLoaderURL = strImageURL + "/" + Product + "/" + "loader.gif?" + StrVersion;
    var sessionstrg = Session["terminalid"] != null ? Session["terminalid"].ToString() : "";
}

<meta charset="utf-8" content="" />
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="keywords" content="riya express" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="HandheldFriendly" content="True" />
<meta name="MobileOptimized" content="320" />
<meta http-equiv='cache-control' content='no-cache' />
<meta http-equiv='expires' content='0' />
<meta http-equiv='pragma' content='no-cache' />
<meta name="description" content="">
<meta name="author" content="Stunner">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Page-Enter" content="blendTrans(Duration=0)">
<meta http-equiv="Page-Exit" content="blendTrans(Duration=0)">

<link href="~/Content/CSS/Slider/camera.css?@StrVersion" rel="stylesheet" />
<link href="~/Content/CSS/tooltipster.css?@StrVersion" rel="stylesheet" />
<link href="~/Content/CSS/Controlpanel.css?@StrVersion" rel="stylesheet" />
<link href="~/Content/CSS/Component.css?@StrVersion" rel="stylesheet" />
<link href="~/Content/CSS/GDSAvail.css?@StrVersion" rel="stylesheet" />
<link href="~/Content/CSS/raysModal.css?@StrVersion" rel="stylesheet" />
<script src="~/js/raysModal.js?@StrVersion"></script>
<script src="~/js/jquery.tooltipster.min.js?@StrVersion"></script>
<script src="~/js/jquery.nice-select.js?@StrVersion"></script>
<script src="~/js/AppsJS/AvailSelect.js?@StrVersion"></script>
<script src="~/js/AppsJS/Booking.js?@StrVersion"></script>
<script src="~/js/CommonJS/bootstrap-typeahead.js?@StrVersion"></script>
<script src="~/js/tinysort.js?@StrVersion"></script>

@if (apptheme == "THEME4")
{ 
    <link href="~/Content/CSS/Theme4/style.css?@StrVersion" rel="stylesheet" />
}
<link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<link href="~/Content/CSS/@apptheme/AvilBuilder.css?@StrVersion" rel="stylesheet" />


<style>
    .m-t-60 {
        margin-bottom: -21px;
    }

    .m-t-80 {
        margin-top: 80px;
    }

    .clssmallhdr {
        background-image: url(../Images/elements_header_background.png);
    }

        .clssmallhdr ul li {
            color: #333;
        }

        .clssmallhdr span {
            text-decoration: none !important;
        }

    .nice-select.form-control.clshideErrch {
        border: none !important;
        padding: 1px 0px 0px 5px !important;
        height: 100%;
    }

    .basicfares, .roundreplace {
        display: block;
    }

    .Goesstooltip_head {
        /*display: none;*/
    }

    .mk-trc {
        margin-bottom: 0px !important;
    }

    .addtop {
        top: 50%;
    }

    .full-height {
        /*height: 100vh;*/
        position: relative;
        float: left;
        width: 100%;
    }

    .clip {
        clip: rect(auto,auto,auto,auto);
        height: inherit;
        position: static;
        width: 100%;
    }

    .bg {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
    }

    .bg-bg-chrome {
        background-position: 54% 57%;
        position: fixed;
        background-repeat: no-repeat;
        background-attachment: fixed !important;
        -moz-background-size: cover;
        -ms-background-size: cover;
        background-size: cover;
        opacity: 0.9;
    }

    .clsswapcity {
        position: absolute;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        right: -15px;
        top: 3px;
        border: 1px solid #eee;
        z-index: 1;
        cursor: pointer;
    }

    #dvmoreAvailload {
        min-height: 60px;
        background-color: #fff;
        width: 100%;
        padding-top: 25px;
        padding-left: 10px;
        padding-right: 10px;
    }

    article.commonbox {
        display: none;
    }

    #dvsamplemain {
        background-color: #ddd;
        position: relative;
    }

    .rcntsearchtitle {
        font-size: 15px;
        color: #000;
        border-bottom: 2px solid;
        line-height: 30px;
    }

    #dvRSearch {
        min-height: 175px;
        margin-bottom: 20px;
    }

    .blockUI.blockMsg.blockPage {
        background-color: transparent !important;
        padding: 0 !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100% !important;
        border-radius: 0 !important;
    }

    .spnclosepopup {
        position: absolute;
        top: -18px;
        right: -7px;
        background: #fff;
        border: 1px solid #eee;
        border-radius: 50%;
        font-size: 18px;
        padding: 5px 6px;
        cursor: pointer;
    }

    .DeptDateboxs:before {
        top: 50%;
        left: 83px;
    }

    .DeptDateboxs_edit:before {
        top: 50% !important;
        left: 10px !important;
    }

    @@media screen and (max-width:768px) {
    }

    .confrm-hdr {
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        font-size: 15px;
        font-weight: 600;
        color: #000;
    }


    /*round trip radio button style (like button style)-11092017-sri*/




    .tgl {
        display: none;
    }

        .tgl + .tgl-btn {
            outline: 0;
            display: block;
            width: 5em;
            /*height: 2em;*/
            position: relative;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            margin-bottom: 13px;
        }

    .tgl-flat + .tgl-btn {
        padding: 2px;
        -webkit-transition: all .1s ease;
        transition: all .1s ease;
        background: #fff;
        border: 4px solid #f2f2f2;
        border-radius: 2em;
    }

        .tgl-flat + .tgl-btn:after {
            -webkit-transition: all .1s ease;
            transition: all .1s ease;
            background: #f2f2f2;
            content: "";
            border-radius: 1em;
        }

    .tgl-flat:checked + .tgl-btn {
        border: 4px solid #7FC6A6;
    }

        .tgl-flat:checked + .tgl-btn:after {
            left: 50%;
            background: #7FC6A6;
        }

    .tgl-flip + .tgl-btn {
        /*padding: 2px;*/
        -webkit-transition: all .1s ease;
        transition: all .1s ease;
        font-family: sans-serif;
        -webkit-perspective: 100px;
        perspective: 100px;
        font-size: 11px !important;
        font-weight: 500 !important;
    }

        .tgl-flip + .tgl-btn:after, .tgl-flip + .tgl-btn:before {
            display: inline-block;
            -webkit-transition: all .2s ease;
            transition: all .2s ease;
            width: 100%;
            text-align: center;
            position: absolute;
            line-height: 2em;
            font-weight: bold;
            color: #fff;
            position: absolute;
            top: 0;
            left: 0;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 4px;
        }

        .tgl-flip + .tgl-btn:after {
            content: attr(data-tg-on);
            background: #02C66F;
            -webkit-transform: rotateY(-180deg);
            transform: rotateY(-180deg);
        }

        .tgl-flip + .tgl-btn:before {
            background: #FF3A19;
            content: attr(data-tg-off);
        }

        .tgl-flip + .tgl-btn:active:before {
            -webkit-transform: rotateY(-20deg);
            transform: rotateY(-20deg);
        }

    .tgl-flip:checked + .tgl-btn:before {
        -webkit-transform: rotateY(180deg);
        transform: rotateY(180deg);
    }

    .tgl-flip:checked + .tgl-btn:after {
        -webkit-transform: rotateY(0);
        transform: rotateY(0);
        left: 0;
        background: #7FC6A6;
    }

    .tgl-flip:checked + .tgl-btn:active:after {
        -webkit-transform: rotateY(20deg);
        transform: rotateY(20deg);
    }

    .availshowhidecls:before {
        background: rgb(153, 203, 51) !important;
        /*background: rgb(242, 85, 104) !important;*/
    }

    /*END   button style (like button style) */

    .clsFareruleSelect {
        font-size: 15px;
        cursor: pointer;
        font-weight: bold;
        border: 1px solid #a9a9a9;
        padding: 5px 10px;
        background: #d3d3d3;
        color: #000;
        float: left;
        background-color: #d3d3d3;
        color: #000000;
        border-color: #a9a9a9;
    }

    .clsSgFareRule {
        width: 100%;
        float: left;
        padding-top: 10px;
        border: 1px dashed #a9a9a9;
        padding-left: 5px;
        color: #000 !important;
        background: #d3d3d3;
    }

    .clsRuleHead {
        width: 100%;
        font-size: 12px;
        font-weight: bold;
        /* border-bottom: 1px dashed; */
        padding: 10px 0px;
        color: #000;
        cursor: pointer;
    }

    .clsFaretextArea:read-only {
        width: 100%;
        /* height: 450px; */
        border: #fff;
        color: black;
        background: #efefef;
        display: none;
    }

    .clsFaretextArea {
        width: 100%;
        /* height: 450px; */
        border: #fff;
        color: black;
        background: #efefef;
        display: none;
    }

    pre {
        display: block;
        padding: 9.5px;
        margin: 0 0 10px;
        font-size: 13px;
        line-height: 1.42857143;
        color: #333;
        word-break: break-all;
        word-wrap: break-word;
        /*background-color: #f5f5f5;*/
        border: 1px solid #ccc;
        border-radius: 4px;
    }
</style>
@{
    string _fareCode = Session["App_currency"] != null && Session["App_currency"] != "" ? Session["App_currency"].ToString() : ConfigurationManager.AppSettings["currency"].ToString();
    string _mCityFlg = Session["multicity"] != null ? Session["multicity"].ToString().Trim() : "";
    string _segFlg = Session["tripConfig"] != null ? Session["tripConfig"].ToString().Trim() : "O|Y"; // Oneway and Roundtrip
    string[] _image = Session["accessimage"] != null ? Session["accessimage"].ToString().TrimEnd('|').TrimStart('|').Split('|') : "".Split('|');
    string currenctdate_ad = Session["Serverdatetime"] != null ? Session["Serverdatetime"].ToString().Trim() : ViewBag.currentdate;
}

@if (Allowcalendar == "1")
{
    <link href="~/Content/CSS/Search/jquerycalender-new.css?@StrVersion" rel="stylesheet" />
}
else
{
    <link href="~/Content/CSS/Search/jquerycalender-new.css?@StrVersion" rel="stylesheet" />
}

<div class="full-height R_gdsp2e">


    <div class="container mobNoContainer">
        <div class="hero-wrap" id="_Msearchview" style="padding-top: 12px">
            @*0712*@
            <div class="hero-content py-0 py-lg-3 searchviews" id="dvSearchArea">
                <i class="fa fa-close modifyclosebtn" id="imodifyclosebtn" style="display: none;"></i>@*2212*@
                <div class="container _Mcont">
                    <div class="row">
                        <div class="col-lg-9" id="searc9cls">
                            <div class="position-relative px-4 pt-3 pb-4 bg-dark">
                                <div class="hero-mask bg-dark rounded"></div>
                                <div class="hero-content">
                                    <h3 class="box-title">
                                        <img src="@Url.Content("~/Images/FlightSearch.png")" />GDS Search
                                    </h3>
                                    <div class="tab-content" id="myTabContent">
                                        <!-- Search Flight -->
                                        <div class="tab-pane active show" id="first" role="tabpanel" aria-labelledby="first-tab">
                                            <form id="bookingFlight" class="search-input-line" method="post">
                                                @if (Product.ToString() == "RBOA" || Product.ToString() == "RIYA")
                                                {
                                                    <div class="row">
                                                        <div class="text-light mb-2">
                                                            <div class="custom-control custom-radio custom-control-inline disnclt">
                                                                <input id="domastic" name="flight-trip " class="custom-control-input " onchange="airlinecityloadfun_contr()" checked="" required="" type="radio">
                                                                <label class="custom-control-label" for="domastic">Domestic</label>
                                                            </div>
                                                            <div class="custom-control custom-radio custom-control-inline disnclt">
                                                                <input id="international" name="flight-trip " class="custom-control-input " onchange="airlinecityloadfun_contr()" required="" type="radio">
                                                                <label class="custom-control-label" for="international">International</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                                <div class="text-light mb-20">
                                                    <div class="custom-radio disnclt radio-group1">
                                                        <input id="lioneways" name="flight-trip" class="custom-control-input comlisttriptype" checked="" required="" type="radio">
                                                        <label class="custom-control-label1" for="lioneways">One Way</label>
                                                    </div>
                                                    <div class="custom-radio disnclt radio-group1">
                                                        <input id="liRoundTrip" name="flight-trip" class="custom-control-input comlisttriptype" required="" type="radio">
                                                        <label class="custom-control-label1" for="liRoundTrip">Round Trip</label>
                                                    </div>

                                                </div>
                                                <div class="forms" id="dvNormalSearch">
                                                    <div class="row">
                                                        <div class="col-sm-4 col3 form-group">
                                                            <input type="text" class="form-control clrcity" id="txtorigincity" required="" autocomplete="off" data-type="geolocate" data-button="true" value="" placeholder="Origin" onkeypress="javascript:return ValidateAlphaCaps(event);" autocorrect="off" autocapitalize="off">
                                                            <span class="icon-inside"><i class="fas fa-map-marker-alt"></i></span>
                                                        </div>
                                                        @if (Product.ToString() == "RIYA")
                                                        {
                                                            <div class="col-sm-1 form-group interchange">
                                                                <div class="tabs-block">
                                                                    <div class="txt-cntr m-t-10">
                                                                        <span onclick="ChangeCityNames();"><i class="fa fa-exchange fa-2x clsRotateIcon"></i></span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        }
                                                        <div class="col-sm-4 col3 form-group b-r-gry">
                                                            <input type="text" class="form-control clrcity" id="txtdestinationcity" autocomplete="off" data-type="geolocate" data-button="true" value="" placeholder="Destination" onkeypress="javascript:return ValidateAlphaCaps(event);" autocorrect="off" autocapitalize="off">
                                                            <span class="icon-inside"><i class="fas fa-map-marker-alt"></i></span>
                                                        </div>
                                                        <div class="col-sm-2 col2 form-group b-r-gry">
                                                            <input id="txtdeparture" type="text" class="form-control" readonly="" data-type="calendar">
                                                            <span class="icon-inside"><i class="far fa-calendar-alt"></i></span>
                                                        </div>
                                                        <div class="col-sm-2 col2 form-group col0">
                                                            <input id="txtarrivaldate" type="text" disabled class="form-control" data-type="calendar" readonly="">
                                                            <span class="icon-inside"><i class="far fa-calendar-alt"></i></span>
                                                        </div>
                                                    </div>
                                                    <div class="row">

                                                        @if (strAppHosting == "BSA")
                                                        {
                                                            <div class="col-md-5">
                                                                <div class="row align-items-center">
                                                                    <div class="col-sm-4 col-xs-4">
                                                                        <p class="mb-0 font-13 hidden-xs">Adults <small class="text-muted">(12+ yrs)</small></p>
                                                                        <div class="form-group">
                                                                            <select class="custom-select_1" id="ddladult" onchange="javascript:AdultLoad(); return false;">
                                                                                <option value="1" selected="selected">1</option>
                                                                                <option value="2">2</option>
                                                                                <option value="3">3</option>
                                                                                <option value="4">4</option>
                                                                                <option value="5">5</option>
                                                                                <option value="6">6</option>
                                                                                <option value="7">7</option>
                                                                                <option value="8">8</option>
                                                                                <option value="9">9</option>
                                                                            </select>
                                                                            <span class="hidden-lg icon-inside l-10"><i class="las la-user-alt font-20"></i></span>
                                                                            <span id="uaedown_1" class="icon-inside_01"><i class="fas fa-caret-down"></i></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-4 col-xs-4">
                                                                        <p class="mb-0 font-13 hidden-xs">Children <small class="text-muted">(2-12 yrs)</small></p>
                                                                        <div class="form-group">
                                                                            <select class="custom-select_1" id="ddlchild">
                                                                                <option value="0">Child</option>
                                                                                <option value="1">1</option>
                                                                                <option value="2">2</option>
                                                                                <option value="3">3</option>
                                                                                <option value="4">4</option>
                                                                                <option value="5">5</option>
                                                                                <option value="6">6</option>
                                                                                <option value="7">7</option>
                                                                                <option value="8">8</option>
                                                                            </select>
                                                                            <span class="hidden-lg icon-inside l-10"><i class="las la-male font-20"></i></span>
                                                                            <span id="uaedown_2" class="icon-inside_01"><i class="fas fa-caret-down"></i></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-4 col-xs-4">
                                                                        <p class="mb-0 font-13 hidden-xs">Infants <small class="text-muted">(Below 2 yrs)</small></p>
                                                                        <div class="form-group">
                                                                            <select class="custom-select_1" id="ddlinfant">
                                                                                <option value="0">Infant</option>
                                                                                <option value="1">1</option>
                                                                            </select>
                                                                            <span class="hidden-lg icon-inside l-10"><i class="las la-child font-20"></i></span>
                                                                            <span id="uaedown_3" class="icon-inside_01"><i class="fas fa-caret-down"></i></span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-sm-4 col4 travellers-class form-group">
                                                                <p class="mb-0 font-13">Class</p>
                                                                <input type="text" autocomplete="off" id="FlightTravellersClass" class="travellers-class-input form-control" name="flight-travellers-class" placeholder="Travellers, Class" readonly="" required="" onkeypress="return false;">
                                                                <a href="#"></a><span class="icon-inside_01 icon_clsdrop_down"><i class="fas fa-caret-down"></i></span>
                                                                <!-- Travellers & Class Dropdown -->
                                                                <div class="travellers-dropdown" style="display: none;">
                                                                    <div class="mb-3">
                                                                        <div class="custom-control custom-radio " id="ddlclass">
                                                                            <input id="flightClassEconomic" name="flight-class" class="flight-class custom-control-input" data-value="Economy" value="E" checked="" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassEconomic">Economy</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassPremiumEconomic" name="flight-class" class="flight-class custom-control-input" data-value="Premium Economy" value="P" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassPremiumEconomic">Premium Economy</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassBusiness" name="flight-class" class="flight-class custom-control-input" data-value="Business" value="B" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassBusiness">Business</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassFirstClass" name="flight-class" class="flight-class custom-control-input" data-value="First Class" value="F" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassFirstClass">First Class</label>
                                                                        </div>
                                                                    </div>
                                                                    <button class="btn btn-riya btn-block submit-done" type="button">Done</button>
                                                                </div>
                                                            </div>    
                                                        }
                                                        else
                                                        {
                                                            <div class="col-sm-4 col4 travellers-class form-group">
                                                                <input type="text" id="FlightTravellersClass" class="travellers-class-input form-control" name="flight-travellers-class" placeholder="Travellers, Class" readonly="">
                                                                <a href="#"></a><span class="icon-inside_01"><i class="fa fa-caret-down"></i></span>
                                                                <!-- Travellers & Class Dropdown -->
                                                                <div class="travellers-dropdown" style="display: none;">
                                                                    <div class="row align-items-center">
                                                                        <div class="col-sm-4 col-xs-4">
                                                                            <p class="mb-sm-0">Adults <small class="text-muted">(12+ yrs)</small></p>
                                                                            <div class="form-group">
                                                                                <select class="custom-select_1" id="ddladult" onchange="javascript:AdultLoad(); return false;">

                                                                                    <option value="1" selected="selected">1</option>
                                                                                    <option value="2">2</option>
                                                                                    <option value="3">3</option>
                                                                                    <option value="4">4</option>
                                                                                    <option value="5">5</option>
                                                                                    <option value="6">6</option>
                                                                                    <option value="7">7</option>
                                                                                    <option value="8">8</option>
                                                                                    <option value="9">9</option>
                                                                                </select>
                                                                                <span id="uaedown_1" class="icon-inside_01"><i class="fa fa-caret-down"></i></span>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-4 col-xs-4">
                                                                            <p class="mb-sm-0">Children <small class="text-muted">(2-12 yrs)</small></p>
                                                                            <div class="form-group">
                                                                                <select class="custom-select_1" id="ddlchild">
                                                                                    <option value="0">Child</option>
                                                                                    <option>1</option>
                                                                                    <option>2</option>
                                                                                    <option>3</option>
                                                                                    <option>4</option>
                                                                                    <option>5</option>
                                                                                    <option>6</option>
                                                                                    <option>7</option>
                                                                                </select>
                                                                                <span id="uaedown_2" class="icon-inside_01"><i class="fa fa-caret-down"></i></span>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-4 col-xs-4">
                                                                            <p class="mb-sm-0">Infants <small class="text-muted">(Below 2 yrs)</small></p>
                                                                            <div class="form-group">
                                                                                <select class="custom-select_1" id="ddlinfant" required="">
                                                                                    <option value="0">Infant</option>
                                                                                    <option>1</option>
                                                                                </select>
                                                                                <span id="uaedown_3" class="icon-inside_01"><i class="fa fa-caret-down"></i></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-3">
                                                                        <div class="custom-control custom-radio " id="ddlclass">
                                                                            <input id="flightClassEconomic" name="flight-class" class="flight-class custom-control-input" data-value="Economy" value="E" checked="" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassEconomic">Economy</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassPremiumEconomic" name="flight-class" class="flight-class custom-control-input" data-value="Premium Economy" value="P" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassPremiumEconomic">Premium Economy</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassBusiness" name="flight-class" class="flight-class custom-control-input" data-value="Business" value="B" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassBusiness">Business</label>
                                                                        </div>
                                                                        <div class="custom-control custom-radio">
                                                                            <input id="flightClassFirstClass" name="flight-class" class="flight-class custom-control-input" data-value="First Class" value="F" required="" type="radio">
                                                                            <label class="custom-control-label" for="flightClassFirstClass">First Class</label>
                                                                        </div>

                                                                    </div>
                                                                    <button class="btn btn-riya btn-block submit-done" type="button">Done</button>
                                                                </div>
                                                            </div>
                                                        }

                                                        <div class="col-sm-2 col-xs-5 form-group b-r-gry">
                                                            @if (strAppHosting == "BSA")
                                                            {
                                                                <p class="mb-0 font-13">Type</p>
                                                            }
                                                            <select class="custom-select" id="fli_option" onchange="hideoldavaildetails();">
                                                                <option selected="" value="ALL">ALL</option>
                                                                <option value="FSC">FSC</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-sm-2 col-xs-7 form-group b-r-gry slct_airline">
                                                            @if (strAppHosting == "BSA")
                                                            {
                                                                <p class="mb-0 font-13">Airline</p>
                                                            }
                                                            <select id="FlightName" autocomplete="off" onkeyup="disblockall();" placeholder="Airline Code" multiple="multiple" class="form-control"></select>
                                                        </div>
                                                        <div class="col-md-2 col-xs-12 margintop2 commonadvancesearch col0 b-r-gry" style="display: none;">
                                                            <div class="row row5" id="roundtrsricon" style="visibility: hidden;">
                                                                <div class="cntr" style="text-align: center;">
                                                                    <input style="display: none;" id="rd_roundtripcnt" class="cb" type="checkbox" onclick="roundtrip_or_tripspl()">
                                                                    <label class="cbx" for="rd_roundtripcnt" style="margin-bottom: 3px;"></label>
                                                                    <label class="lbl" for="rd_roundtripcnt" style="font-size: 13px; padding: 0px 2px;">Sector Specific</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        @*<div class="clsMultiCityRoutesnew col-sm-3 col-xs-12 margintop2 col0 clsFtypeahead"></div>*@
                                                        @if (strTerminaltype == "T")
                                                        {
                                                            <div class="clsMultiCityRoutesnew col-sm-3 col-xs-12 margintop2 col0 clsFtypeahead">
                                                                <input class="form-control ui-autocomplete-input" type="text" id="ddlclient" placeholder="Agency Name" />
                                                                <span class="icon-inside"><i class="fas fa-user"></i></span>
                                                            </div>
                                                            <div class="clsMultiCityRoutesnew col-md-2 col-sm-2 col-xs-12 margintop2 clsFtypeahead" style="float: right;">
                                                                <select class="custom-select" id="ddlTerminalId">
                                                                    <option value="">Terminal ID</option>
                                                                </select>
                                                            </div>
                                                        }
                                                    </div>
                                                    <div class="row row0">
                                                        <div class="col-sm-2 col-xs-12 form-group" id="searchcontainer">
                                                            <a class="btn btn-riya btn-block mt-4" id="btn_Search" onclick="searchgds()">
                                                                <i class="fa fa-paper-plane hidden-md" aria-hidden="true"></i>
                                                                Search Flights
                                                            </a>
                                                        </div>
                                                    </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="dvGDSStickbottom" style="display: none;">
            <span class="yrselectedFlights" onclick="javascript:showHideRoundtrip(); return false;">Your selected flights</span>
            <div style="margin-top: 5px;">
                <div class="col-md-10 col5">
                    <div class="row row10 hidden-lg hidden-md clsShowRoundtrip">
                        <a href="#" id="showhidegds" class="clsshowhidbtn" onclick="javascript:showHideGDSsticky(); return false;">hide</a>
                    </div>
                    <div class="row row10" id="dvGdsselectedFlights">
                    </div>
                </div>
                <div class="col-md-2 col10 col-xs-12">
                    <div class="row row10">
                        <div class="col-md-12 col-sm-6 col-xs-12 col10" id="sltflrebtnid">
                            <p class="gdsrndfr" style="visibility: hidden;"><span class="show-GdspopFare" id="lblfare_spnGDSrndFr" data-placement="top"></span></p>
                            <a href="#" style="width: 100%;" class="c-button b-40 mygraybtn roundgetfarebtn sel-btn fltblurclss" id="btnGDSroundGetfrORselect" data-slectflg="1" onclick="javascript:Checkroundgdsnormalfare(this,'R','2'); return false;">Select</a>
                            <a href="#" style="width: 50%;" class="c-button b-40 mygraybtn cmsnorcorcls" id="btnGDSroundGetfrORselectnormal" data-slectflg="0" onclick="javascript:btnGDSRoundGetfrORselect(this,'R','2'); return false;">Normal</a>
                            <a href="#" style="width: 50%;" class="c-button b-40 mygraybtn cmsnorcorcls" id="btnGDSroundGetfrORselectcorporate" data-slectflg="0" onclick="javascript:btnGDSRoundGetfrORselect(this,'R','2','Y'); return false;">Corporate </a>
                            <a href="#" style="width: 50%;" class="c-button b-40 mygraybtn cmsnorcorcls" id="btnGDSroundGetfrORselectretail" data-slectflg="0" onclick="javascript:btnGDSRoundGetfrORselect(this,'R','2','R'); return false;">Retail</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row DGS_AvialPG" id="dvAvailView" style="display: none;">
            <div class="col-lg-12 col-sm-12 col-xs-12">
                <div id="dvmodifydetails" class="clsmodifydetails" style="margin-top: 1%;">
                    <div class="row row10">
                        <div class="col-sm-3 col10 col-xs-12 hidden-xs clsborderright">
                            <p class="fnt-wt-5"><span class="clshrdstyle" id="spnmodifydettriptyp">ONEWAY</span></p>
                            <p class="fnt-wt-6"><span id="pmodifydetilsegment">--</span></p>
                        </div>
                        <div class="col-sm-3 col10 col-xs-12 hidden-xs clsborderright">
                            <div class="row row10">
                                <div class="col-sm-6 col10">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">DEPARTURE</span></p>
                                    <p class="fnt-wt-6"><span class="clsdatestyle" id="spnmodifydetdep">--</span></p>
                                </div>
                                <div class="col-sm-6 col10">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">RETURN</span></p>
                                    <p class="fnt-wt-6"><span class="clsdatestyle" id="spnmodifydetRtn">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col10 col-xs-12 hidden-xs clsborderright">
                            <div class="row row10">
                                <div class="col-sm-4 col10 text-center">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">ADULT(S)</span></p>
                                    <p class="fnt-wt-6"><span class="clspaxstyle" id="spnmodifydetadt">--</span></p>
                                </div>
                                <div class="col-sm-4 col10 text-center">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">CHILD(REN)</span></p>
                                    <p class="fnt-wt-6"><span class="clspaxstyle" id="spnmodifydetchd">--</span></p>
                                </div>
                                <div class="col-sm-4 col10 text-center">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">INFANT(S)</span></p>
                                    <p class="fnt-wt-6"><span class="clspaxstyle" id="spnmodifydetinf">--</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 col10 col-xs-12">
                            <div class="row row5">
                                <div class="col-sm-4 col10 hidden-xs">
                                    <p class="fnt-wt-5"><span class="clshrdstyle">CLASS</span></p>
                                    <p class="fnt-wt-6"><span id="dvmodifydetcls">--</span></p>
                                </div>
                                <div class="col-sm-6 col-xs-4 col5">
                                    <button id="btnFmodifySearch" class="clsModifysearch"><i id="iFmodifySearch fa fa-plus hidden-sm hidden-md" class="fa fa-plus hidden-sm hidden-md" style="margin-right: 5px;"></i><span>Modify</span> <span class="hidden-xs">Search</span></button>
                                </div>
                                <div class="col-sm-2 col-xs-8 col5" style="display: none;">
                                    <div id="dvrightstckyIcons" style="display: none;">
                                        <span class="ico-sticky ico1 animated swing" data-toggle='tooltip' id="BtnFAvailPrinter" data-placement='left' title="Print">
                                            <img src="@Url.Content("~/Images/icons/printerwhitepng.png")" alt="" />
                                        </span>
                                        <span class="ico-sticky ico2 animated zoomInDown" data-toggle='tooltip' id="btnFAvailEmail" data-placement='left' title="Send Email">
                                            <img src="@Url.Content("~/Images/icons/mailsendwhite.png")" alt="" />
                                        </span>
                                        <span class="ico-sticky ico3 animated bounceInUp hidden-xs" data-toggle='tooltip' id="btnFAvailSave" data-placement='left' title="Save File">
                                            <img src="@Url.Content("~/Images/icons/savewhite.png")" alt="" />
                                        </span>
                                        <span class="ico-sticky ico4 animated bounceInUp hidden-xs" style="display: none;" data-toggle='tooltip' id="btnAvailwhtsapp" data-placement='left' title="Whatsapp">
                                            <img src="@Url.Content("~/Images/icons/Whatsapp.png")" alt="" />
                                        </span>
                                    </div>
                                    <span class="clsAvailFiltericon" id="spnAvailFiltericon" data-toggle='tooltip' data-placement='bottom' title="Filtration"><i class="fa fa-filter"></i></span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="sort-by-section clearfix" @*box*@ style="display: block;" id="onewayheaders">
                    <div class="row row5">
                        <div class="col-md-5 col-md-push-7 col-xs-push-5 col-xs-7 col5">
                            <div class="row row5">
                                <div class="col-md-7 col5 col-xs-6">
                                    @if (apptheme == "THEME4")
                                    {
                                        <div id="dvrightstckyIcons" style="display: none;">
                                            <span class="ico-sticky ico1 animated swing" data-toggle='tooltip' id="BtnFAvailPrinter" data-placement='bottom' title="Print">
                                                <img src="@Url.Content("~/Images/icons/printerwhitepng.png")" alt="" />
                                            </span>
                                            <span class="ico-sticky ico2 animated zoomInDown" data-toggle='tooltip' id="btnFAvailEmail" data-placement='bottom' title="Send Email">
                                                <img src="@Url.Content("~/Images/icons/mailsendwhite.png")" alt="" />
                                            </span>
                                            <span class="ico-sticky ico3 animated bounceInUp hidden-xs" data-toggle='tooltip' id="btnFAvailSave" data-placement='bottom' title="Save File">
                                                <img src="@Url.Content("~/Images/icons/savewhite.png")" alt="" />
                                            </span>
                                            <span class="ico-sticky ico4 animated bounceInUp hidden-xs" data-toggle='tooltip' id="btnAvailwhtsapp" data-placement='bottom' title="Whatsapp">
                                                <img src="@Url.Content("~/Images/icons/Whatsapp.png")" alt="" />
                                            </span>
                                        </div>
                                    }

                                </div>

                                <div class="col-md-3 col5 col-xs-4">
                                    <div class="availCrncy">
                                        <h6 class="allfare">All fares in <span class="crncy clscurrency">INR</span></h6>
                                    </div>
                                </div>
                                @if (apptheme == "THEME4" && ConfigurationManager.AppSettings["APP_HOSTING"].ToString().ToUpper() == "BSA")
                                {
                                    <div class="page_view_next col-sm-3 col-lg-2 col-xs-2">
                                        <span class="btnpg" id="btnNextgds">
                                            <span class="hidden-xs">Next</span>
                                            <span class="fa fa-angle-double-right arwsanim"></span>
                                        </span>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="col-md-7 col-md-pull-5 mobabsfltcont col0 col-xs-pull-7 col-xs-5">
                            <div class="row row5">
                                <div class="page_view col-sm-2 col-lg-2 col-xs-2 text-left">
                                    <span class="btnpg" id="btnPrevgds">
                                        <span class="fa fa-angle-double-left arwsanim"></span>
                                        <span class="hidden-xs">Previous</span>
                                    </span>
                                </div>
                                <div class="col-md-2 col5" id="spnTotalFAvailCntParent">
                                    <span class="clsfltAvailCnt sort-by-title">
                                        <span id="spnActlFAvailCnt" class="zeroflt">--</span><em style="font-size: 12px;">Flight(s)</em>
                                    </span>
                                </div>
                                <div class="col-md-2 col5" style="visibility: hidden;">
                                    <div class="sort-by-title block-sm dvnfare clsNFare">
                                        <div class="mk-trc" data-style="check" data-text="true" style="float: right;">
                                            <input id="airlinemat" type="checkbox" name="airlinemat" class="checkbox_availchkAll  user_name" value="2">
                                            <label for="airlinemat" class="clslblNFare">
                                                <i class="checkbox_avail checkbox_availchk1"></i>Airline Matrix
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 col-sm-3 col-xs-3 col5" style="visibility: hidden;">
                                    <div class="sort-by-title block-sm dvnfare clsNFare" style="margin-top: 9px;">
                                        <div class="mk-trc" data-style="check" data-text="true" style="float: right;">
                                            <input id="chkDirFlt" type="checkbox" name="chkDirFlt" class="checkbox_availchkAll chkcommonfilter user_name" value="2">
                                            <label for="chkDirFlt" class="clslblNFare">
                                                <i class="checkbox_avail checkbox_availchk1"></i>Direct Flight
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                @if (apptheme == "THEME4")
                                {
                                    <div class="col-md-3 col5 col-xs-3 clsNFare" style="display: none !important; margin-top: 9px;">
                                        <div class="sort-by-title block-sm dvnfare">
                                            <div class="mk-trc" data-style="check" data-text="true" style="float: right;">
                                                <input id="chkNFare" type="checkbox" name="radio1" class="checkbox_availchkAll">
                                                <label for="chkNFare" class="clslblNFare">
                                                    <i class="checkbox_avail checkbox_availchk1"></i>N.Fare
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="col-md-4 col-md-3 col5 col-xs-3 clsNFare" style="display: none !important; margin-top: 9px;">
                                        <div class="sort-by-title block-sm dvnfare">
                                            <div class="mk-trc" data-style="check" data-text="true" style="float: right;">
                                                <input id="chkNFare" type="checkbox" name="radio1" class="checkbox_availchkAll">
                                                <label for="chkNFare" class="clslblNFare">
                                                    <i class="checkbox_avail checkbox_availchk1"></i>N.Fare
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                }
                                <div class="col-md-2 col5" style="display: none">
                                    <div class="sort-by-title block-sm dvnfare clsNFare" style="margin-top: 9px;">
                                        <div class="mk-trc" data-style="check" data-text="true" style="float: right;">
                                            <input id="chkNonstpFlt" type="checkbox" name="chkNonstpFlt" class="checkbox_availchkAll chkcommonfilter">
                                            <label for="chkNonstpFlt" class="clslblNFare">
                                                <i class="checkbox_avail checkbox_availchk1"></i>Non-stop
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 col5" style="display: none">
                                    @if (apptheme == "THEME4")
                                    {
@*<span class="clsearninghdr">Earnings/N.Fare</span>*@
                                        <div class="clsNFare" style="margin-top: 9px;">
                                            <div class="mk-trc" data-style="check" data-text="true" style="float: left;">
                                                <input id="chkCommNFare" type="checkbox" name="radio1" class="clsCommNFare checkbox_availchkAll">
                                                <label for="chkCommNFare" class="clslblNFare">
                                                    <i class="checkbox_avail checkbox_availchk1"></i>Earnings/N.Fare
                                                </label>
                                            </div>
                                        </div>
                                        <div class="segmented-control clsearning" style="display: none;">
                                            <input type="radio" name="chkFEarnings" class="clsern-show-hide" id="liern-show">
                                            <input type="radio" name="chkFEarnings" class="clsern-show-hide" id="liern-hide" checked="checked">

                                            <label for="liern-show" class="availshowhidecls" data-value="show">show</label>
                                            <label for="liern-hide" class="availshowhidecls" data-value="hide">hide</label>
                                        </div>
                                    }
                                    else
                                    {
                                        <span class="clsearninghdr">Earnings</span>
                                        <div class="segmented-control clsearning">
                                            <input type="radio" name="chkFEarnings" class="clsern-show-hide" id="liern-show">
                                            <input type="radio" name="chkFEarnings" class="clsern-show-hide" id="liern-hide" checked="checked">

                                            <label for="liern-show" class="availshowhidecls" data-value="show">show</label>
                                            <label for="liern-hide" class="availshowhidecls" data-value="hide">hide</label>
                                        </div>
                                    }
                                    <span class="earnsorting animated bounce clssorting_1" data-toggle='tooltip' data-placement='bottom' title='Sort Earning' id="spnEarnsort" data-sortorder="desc" onclick="SortingFAvail_Earnings('earning_1',this);"><i class="fa fa-sort-alpha-asc"></i></span>

                                </div>
                            </div>

                        </div>

                    </div>
                </div>

                <div id="dvinnerAvail_Response">
                    <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky sorthdr sortcolr" id="Sort_filter" style="">
                        <div class="row row10">
                            @*  <span class="sortingheader">sorting</span>
                            <span class="lineheader"></span>*@
                            @*  <span class="sortingnew">sorting</span>*@
                            <div class="col-sm-2 sortfnt" style="font-weight: 700;">Airline</div>
                            <div class="col-xs-12 col-sm-2 col10 " style="text-align: -webkit-center;">
                                <div class="row ">
                                    <div class="col-lg-5 col-md-6 col-sm-8">
                                        <label onclick="javascript: Newarysorting('Depart',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Departure</label>
                                        @*SortingCBTasc('departmix1_asc_1','departmix1_desc_1')*@
                                    </div>

                                    <div class="col-md-1 col-sm-4 col0" style="margin-top: 2px;">
                                        <i class="fa fa-angle-up updep up departmix1_1 commcls_1 Depart_1" aria-hidden="true" style="display: block;"></i>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xs-12 col-sm-3  col10" style="text-align: center;">
                                <div class="Durationdsnclss Duratinunqiclass1 animated flipInX" style="display: none">
                                    <div class="layoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'1','Y'); return false;" data-sortorder="asc" style="left: -5px;">
                                        Layover
                                    </div>
                                    <div class="nonlayoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'1'); return false;" data-sortorder="asc">
                                        WithoutLayover
                                    </div>
                                </div>
                                @*<label onclick="javascript: SortingCBTasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">Arrival<i class="fa fa-angle-up uparr up" aria-hidden="true"></i></label>*@
                                <div class="row ">
                                    <div class="col-lg-8 col-md-4 col-sm-5" style="text-align: right; padding: 0;">
                                        <label onclick="javascript: Newarysorting('Duration',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Duration</label>
                                        @*javascript: Newarysorting('Duration',this,'1'); return false;*@
                                    </div>

                                    <div class="col-md-1 col-sm-2" style="margin-top: 2px;">
                                        <i class="fa fa-angle-up uparr up arrivmix1_1 commcls_1 Duration_1" aria-hidden="true" style="display: block;"></i>
                                    </div>
                                </div>

                            </div>

                            <div class="col-xs-12 col-sm-3 col10" style="text-align: center;">

                                @*<label onclick="javascript: SortingCBTasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">Arrival<i class="fa fa-angle-up uparr up" aria-hidden="true"></i></label>*@
                                <div class="row ">
                                    <div class="col-lg-5 col-lg-offset-5 col-md-4 col-sm-5" style="padding: 0; text-align: right">
                                        <label onclick="javascript: Newarysorting('Arrival',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Arrival</label>
                                    </div>

                                    <div class="col-md-1 col-sm-2" style="margin-top: 2px; padding: 0px;">
                                        <i class="fa fa-angle-up uparr up arrivmix1_1 commcls_1 Arrival_1" aria-hidden="true" style="display: block;"></i>
                                    </div>
                                </div>

                            </div>
                            <div class="col-xs-12 col-sm-2 col10" style="text-align: center;">
                                @*  <label onclick="javascript: SortingCBTasc('pricemix1_asc_1','pricemix1_desc_1'); return false;" style="cursor: pointer;">GrossFare<i class="fa fa-angle-up upprice up" aria-hidden="true"></i></label>*@
                                <div class="row ">
                                    <div class="col-lg-offset-3 col-lg-5 col-md-4 col-sm-8" style="padding: 0;">
                                        <label onclick="javascript: Newarysorting('Fare',this,'1'); return false;" data-sortorder="desc" style="cursor: pointer; white-space: nowrap;">Gross Fare</label>
                                    </div>

                                    <div class="col-md-1 col-sm-3" style="margin-top: 5px; padding-left: 5px;">
                                        <i class="fa fa-angle-down upprice up pricemix1_1 commcls_1 Fare_1" aria-hidden="true" style="display: block;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky sorthdr sortcolr" id="Sort_filter_GDS" style="display: none;">
                        <div class="row row10">
                            @* <div class="col-sm-2 sortfnt">Airline</div>*@
                            <div class="col-xs-12 col-sm-2 col10 " style="text-align: -webkit-center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libFltGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('airlinemix1_asc_1','airlinemix1_desc_1'); return false;" style="cursor: pointer;">
                                            Airline
                                        <i class="fa fa-angle-up updep up airlinemix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-2 col10 " style="text-align: right;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libDepGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('departmix1_asc_1','departmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Departure
                                        <i class="fa fa-angle-up updep up departmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-2 col10" style="text-align: center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libArrGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Arrival
                                        <i class="fa fa-angle-up uparr up arrivmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-2 col10" style="text-align: right; margin-left: 30px;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libDurGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('drtionmix1_asc_1','drtionmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Duration
                                        <i class="fa fa-angle-up upprice up drtionmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky sorthdr sortcolr" id="Sort_filter_Mul_GDS" style="display: none;">
                        <div class="row row10">
                            <div class="col-sm-2 sortfnt">Airline <span class="clsMulsortsegActive">1</span></div>
                            <div class="col-xs-12 col-sm-2 col10 " style="text-align: -webkit-center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libFltGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('airlinemix1_asc_1','airlinemix1_desc_1'); return false;" style="cursor: pointer;">
                                            Airline
                                        <i class="fa fa-angle-up updep up airlinemix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-3 col10 " style="text-align: -webkit-center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libDepGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('departmix1_asc_1','departmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Departure
                                        <i class="fa fa-angle-up updep up departmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-3 col10" style="text-align: center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libArrGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Arrival
                                        <i class="fa fa-angle-up uparr up arrivmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-2 col10" style="text-align: center;">
                                <div class="row ">
                                    <div class="col-xs-12">
                                        <label class="libDurGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('drtionmix1_asc_1','drtionmix1_desc_1'); return false;" style="cursor: pointer;">
                                            Duration
                                        <i class="fa fa-angle-up upprice up drtionmix1_1" aria-hidden="true" style="display: block;"></i>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clsAvailSingle clsAvail001 clsAvailSet001" id="dvinnerAvail_SingleResponse"></div>
                    <div class="row row0 bgwhite" id="spnTotalFRoundAvailCntParent" style="background-color: #fff; display: none;">
                        <div class="col-xs-6 col10 txt-r hidden-xs">
                            <span class="clsfltAvailCnt">Showing <span id="spnActlFAvailCnt_R_1" class="zeroflt">0</span> of <span id="spnTotalFAvailCnt_R_1" class="zeroflt">0</span> Flights found. </span>
                        </div>
                        <div class="col-xs-6 col10 txt-r hidden-xs">
                            <span class="clsfltAvailCnt">Showing <span id="spnActlFAvailCnt_R_2" class="zeroflt">0</span> of <span id="spnTotalFAvailCnt_R_2" class="zeroflt">0</span> Flights found. </span>
                        </div>
                    </div>
                    <div class="row row10">
                        <div class="col-xs-6 col10 sorthdr" id="dvrTriphdr1">
                            <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky1 sortcolr" id="Sort_filterleft" style="display: none;">
                                <div class="row row10">
                                    <div class="col-sm-1 col-lg-2 sortfnt" style="padding-left: 5px; white-space: nowrap">Airline</div>
                                    <div class="col-xs-12 col-sm-2 col10 " style="text-align: -webkit-center;">
                                        <div class="row ">
                                            <div class="col-md-3 col-sm-4">
                                                <label onclick="javascript: Newarysorting('Depart',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Departure</label>
                                            </div>

                                            <div class="col-md-1 col-sm-3" style="position: relative; left: 30px; top: 2px;">
                                                <i class="fa fa-angle-up updep up departmix1_1 commcls_1 Depart_1" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-2 col10" style="text-align: center;">

                                        <div class="Durationdsnclss Duratinunqiclass1 animated flipInX" style="display: none; top: -77%; width: 130%; left: -3%;">
                                            <div class="layoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'1','Y'); return false;" data-sortorder="asc" style="left: -5px;">
                                                Layover
                                            </div>
                                            <div class="nonlayoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'1'); return false;" data-sortorder="asc">
                                                WithoutLayover
                                            </div>
                                        </div>

                                        <div class="row ">
                                            <div class="col-md-offset-2 col-md-6 col-sm-4" style="padding: 0; text-align: right;">
                                                <label onclick="javascript: Newarysorting('Duration',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Duration</label>
                                            </div>

                                            <div class="col-md-1 col-sm-3" style="">
                                                <i class="fa updep up departmix1_1 commcls_1 Duration_1 fa-angle-down" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>


                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10" style="text-align: center;">
                                        @*<label onclick="javascript: SortingCBTasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">Arrival<i class="fa fa-angle-up uparr up" aria-hidden="true"></i></label>*@
                                        <div class="row ">
                                            <div class="col-md-9 col-sm-8" style="text-align: right; padding: 0">
                                                <label onclick="javascript: Newarysorting('Arrival',this,'1'); return false;" data-sortorder="asc" style="cursor: pointer;">Arrival</label>
                                            </div>

                                            <div class="col-md-1 col10" style="margin-top: 2px;">
                                                <i class="fa fa-angle-up uparr up arrivmix1_1 commcls_1 Arrival_1" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10" style="text-align: center;">
                                        @*<label onclick="javascript: SortingCBTasc('pricemix1_asc_1','pricemix1_desc_1'); return false;" style="cursor: pointer;"> GrossFare<i class="fa fa-angle-up upprice up" aria-hidden="true"></i></label>*@
                                        <div class="row ">
                                            <div class="col-md-6 p-0">
                                                <label onclick="javascript: Newarysorting('Fare',this,'1'); return false;" data-sortorder="desc" style="cursor: pointer;">Grossfare</label>
                                            </div>

                                            <div class="col-md-6" style="position: relative; top: 5px; left: 5px;">
                                                <i class="fa fa-angle-down upprice up pricemix1_1 commcls_1 Fare_1" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-6 col10 sorthdr" id="dvrTriphdr2">
                            <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky1 sortcolr" id="Sort_filterright" style="display: none;">
                                <div class="row row10">
                                    <div class="col-xs-12 col-sm-3 col10" style="text-align: -webkit-center;">
                                        <div class="row ">
                                            <div class="col-md-8 col-sm-offset-1 col0">
                                                <label onclick="javascript: Newarysorting('Depart',this,'2'); return false;" data-sortorder="asc" style="cursor: pointer;">Departure</label>
                                            </div>

                                            <div class="col-md-1 col0" style="padding-right: 4px;">
                                                <i class="fa fa-angle-up updep up departmix1_2 commcls_2 Depart_2" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-4 col10" style="text-align: right;">
                                        <div class="Durationdsnclss Duratinunqiclass2 animated flipInX" style="display: none; top: -77%; width: 130%; left: -3%;">
                                            <div class="layoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'2','Y'); return false;" data-sortorder="asc" style="left: -5px;">
                                                Layover
                                            </div>
                                            <div class="nonlayoverdsnclss cmnlayoverdsnclass" onclick="javascript: Newarysorting('Duration',this,'2'); return false;" data-sortorder="asc">
                                                WithoutLayover
                                            </div>
                                        </div>
                                        <div class="row ">
                                            <div class="col-md-8 col-sm-offset-1 col0">
                                                <label onclick="javascript: Newarysorting('Duration',this,'2'); return false;" data-sortorder="asc" style="cursor: pointer;">Duration</label>
                                            </div>

                                            <div class="col-md-1 col0" style="padding-right: 4px;">
                                                <i class="fa updep up departmix1_2 commcls_2 Duration_2 fa-angle-up" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10" style="text-align: center;">
                                        @*<label onclick="javascript: SortingCBTasc('arrivmix1_asc_2','arrivmix1_desc_2'); return false;" style="cursor: pointer;">Arrival<i class="fa fa-angle-up uparr up" aria-hidden="true"></i></label>*@
                                        <div class="row ">
                                            <div class="col-md-11" style="padding: 0;">
                                                <label onclick="javascript: Newarysorting('Arrival',this,'2'); return false;" data-sortorder="asc" style="cursor: pointer;">Arrival</label>
                                            </div>

                                            <div class="col-md-1" style="padding: 0; margin-top: 1px; position: relative; left: -37px;">
                                                <i class="fa fa-angle-up uparr up arrivmix1_2 commcls_2 Arrival_2" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-xs-12 col-sm-2 col10" style="text-align: center; position: relative; left: -10px">
                                        @*<label onclick="javascript: SortingCBTasc('pricemix1_asc_2','pricemix1_desc_2'); return false;" style="cursor: pointer;">GrossFare<i class="fa fa-angle-up upprice up" aria-hidden="true"></i></label>*@
                                        <div class="row ">
                                            <div class="col-md-6 p-0">
                                                <label onclick="javascript: Newarysorting('Fare',this,'2'); return false;" data-sortorder="desc" style="cursor: pointer;">Grossfare</label>
                                            </div>

                                            <div class="col-md-6" style="position: relative; top: 5px; left: 10px">
                                                <i class="fa fa-angle-down upprice up pricemix1_2 commcls_2 Fare_2" aria-hidden="true" style="display: none;"></i>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-6 col10 sorthdr" id="dvrTriphdr1_GDS" style="display: none;">
                            <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky">
                                <div class="row row10">
                                    <div class="col-sm-3 sortfnt">
                                        Airline
                                        
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libDepGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('departmix1_asc_1','departmix1_desc_1'); return false;" style="cursor: pointer;">
                                                    Departure
                                                <i class="fa fa-angle-up updep up departmix1_1" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libArrGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('arrivmix1_asc_1','arrivmix1_desc_1'); return false;" style="cursor: pointer;">
                                                    Arrival
                                                <i class="fa fa-angle-up uparr up arrivmix1_1" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libDurGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('drtionmix1_asc_1','drtionmix1_desc_1'); return false;" style="cursor: pointer;">
                                                    Duration
                                                <i class="fa fa-angle-up upprice up drtionmix1_1" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-6 col10 sorthdr" id="dvrTriphdr2_GDS" style="display: none;">
                            <div class="c-buttonc b-40  hv-red-3-o hidden-xs sticky">
                                <div class="row row10">
                                    <div class="col-sm-3 sortfnt">Airline</div>

                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libDepGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('departmix1_asc_2','departmix1_desc_2'); return false;" style="cursor: pointer;">
                                                    Departure
                                                <i class="fa fa-angle-up updep up departmix1_2" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libArrGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('arrivmix1_asc_2','arrivmix1_desc_2'); return false;" style="cursor: pointer;">
                                                    Arrival
                                                <i class="fa fa-angle-up uparr up arrivmix1_2" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 col10 txt-alignc">
                                        <div class="row ">
                                            <div class="col-xs-12">
                                                <label class="libDurGdsSort lblGdsSort" onclick="javascript: SortingAvailasc('drtionmix1_asc_2','drtionmix1_desc_2'); return false;" style="cursor: pointer;">
                                                    Duration
                                                <i class="fa fa-angle-up upprice up drtionmix1_2" aria-hidden="true" style="display: block;"></i>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clsAvailLeft clsAvail001 clsAvailSet001  clsover " id="dvinnerAvail_LeftResponse"></div>
                    <div class="cslAvailRight clsAvail001 clsAvailSet002  clsover " id="dvinnerAvail_RightResponse"></div>
                </div>
            </div>
        </div>

        <div id="dvSelectView" style="display: none; padding: 15px; position: relative;"></div>
        <div id="diverrordetails" style="display: none;"></div>
        <div id="dvBookinsuccess" style="display: none; padding: 15px; background: #fff;"></div>

        <span id="insamount"></span>
        <span id="Li_Totalfare"></span>
        <div class="modal fade" id="modal_fr_confirm" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-md">
                <div class="modal-content">
                    <div class="modal-body clsPopupBody" style="padding: 10px;">
                        <div class="main">
                            <div class="row">
                                <div class="col-xs-12" style="text-align: center;">
                                    <p class="confrm-hdr">Confirmation Alert</p>
                                    <p style="font-size: 13px; color: #333;" id="pfrConfirmMsg">Are you sure, You want to Continue ?</p>
                                </div>
                            </div>
                            <div class="row" style="margin-top: 15px;">
                                <div class="col-md-offset-3 col-md-3 col-xs-6">
                                    <input type="button" value="No" data-dismiss="modal" class="btn btn-md btn-primary width100per" />
                                </div>
                                <div class="col-md-3 col-xs-6">
                                    <input type="button" value="Yes" class="btn btn-md btn-danger width100per" id="btnContinueFrChang" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<input type="hidden" id="hdtxt_trip" />
<input type="hidden" id="hd_org_fu" value="" />
<input type="hidden" id="hd_des_fu" value="" />
<input type="hidden" id="Mealamount" value="" />
<input type="hidden" id="baggageamount" value="" />
<input type="hidden" id="Seatamount" />
<input type="hidden" id="hdtxt_origin" />
<input type="hidden" id="hdtxt_destination" />
<input type="hidden" id="hdtxt_depa_date" />
<input type="hidden" id="hdtxt_Arrivedate" />
<input type="hidden" id="hdtxt_adultcount" />
<input type="hidden" id="hdtxt_childcount" />
<input type="hidden" id="hdtxt_infantcount" />
<input type="hidden" id="hdnAppTheme" value="@apptheme" />
<input type="hidden" id="hdn_bookingprev" value="@ConfigurationManager.AppSettings["BOOKINGCONFIRMATION"]" />
<script src="~/js/AppsJS/AppsJs.js?@StrVersion"></script>
<script>
    var loadingimg = '@strLoaderURL';
    var bookingUrl = '@Url.Action("BookingRequest", "Booking")';
    var checkTrackstatusUrl = '@Url.Action("PendingTrack", "Booking")';
    var assignedcountry = '@ConfigurationManager.AppSettings["COUNTRY"].ToString()';
    var AirLogo_URL = "@ConfigurationManager.AppSettings["FlightUrl"]";
    var Airlinexml = '@Url.Content("~/XML/CityAirport_Lst.xml?" + StrVersion + "")';
    var terminal_app = '@strTerminaltype';
    var FLAG = "G";
    var FlightsearchUrl = '@Url.Action("GdsFlightSearch", "Search")';// FlightAvail_GDS / GdsFlightSearch
    var Flightgetfare = '@Url.Action("GetClassFare_GDS", "Search")';
    var AirlineNamesXmlURL = '@Url.Content("~/XML/AirlineNames.xml")';
    var loadGlobalcityArrry = [];
    var sessionstrg = "@sessionstrg";
    var JsonData_Round = "";
    var productNames_Round = new Array();
    var productIds_Round = new Object();
    var Cityinfopopup = "";
    var Cityairport = "";
    var clearflag = 0;
    var msg = "";
    $(document).ready(function () {
        $("#hdthread").val('@ViewBag.threadkey');
        $("#newthreadkey").val('@ViewBag.newthreadkey');
        $("#lccthreadkey").val('@ViewBag.lccthreadkey');
        $("#fscthreadkey").val('@ViewBag.fscthreadkey');
        $("#hdn_doublethread").val('@ViewBag.doublethread');
        $("#hdnMultiThread").val('@ViewBag.hdnMultiThread');
        /*Load Airpoart City*/
        var JsonData = "";
        var jsonresults = "";
        var productNames = new Array();
        var productIds = new Object();
        $.ajax({
            url: Airlinexml,
            dataType: 'XML',
            anync: false,
            success: function (response) {
                statedata = $("AIR", response).map(function () {
                    if ($("ID", this).text() == $("#hdn_Baseorgin").val()) {
                        var citynames = "";
                        if ($("AN", this).text().indexOf('-') != -1) {
                            citynames = $("AN", this).text().split('-')[0].trim();
                        } else { citynames = $("AN", this).text().trim(); }
                        $("#txtorigincity").val(citynames + "-(" + $("ID", this).text() + ")");
                        Cityinfopopup = $("AIR", response).map(function () {
                            return {
                                value: $("AN", this).text(),
                                id: $("ID", this).text()
                            };
                        });
                    }
                }).get();

                Cityairport = $("AIR", response).map(function () {
                    return {
                        value: $("AN", this).text() + " (" +
                        ($.trim($("ID", this).text()) + ")"),
                        id: $("ID", this).text()
                    };

                }).get();
                json = $.xml2json(response);
                JsonData = json.AIR;
                JsonData_Round = json.AIR;
                loadGlobalcityArrry = JsonData;
                jsonresults = JSON.stringify(JsonData_Round);
                var citynames = "";
                airlinecityloadfun(JsonData, assignedcountry);
            },
            error: function (e) {
            }
        });

        $("#txtdeparture")[0].value = '@currenctdate_ad';
        $("#txtarrivaldate")[0].value = '@currenctdate_ad';
    });
    function airlinecityloadfun(JsonData, assignedcountry) {
        try {
            var citynames = "";
            var productNames = new Array();
            var productIds = new Object();
            var ct = "";
            $.each(JsonData_Round, function (index, AIR) {
                if (AIR.AN.indexOf('-') != -1) {
                    citynames = AIR.AN.split('-')[0].trim();
                } else { citynames = AIR.AN.trim(); }
                if ($("#domastic")[0].checked == true) {
                    if (AIR.CN != "undefined" && AIR.CN.length > 0 && AIR.CN == assignedcountry) {
                        productNames.push(citynames + "-(" + AIR.ID + ")" + "~" + AIR.CN + "~" + AIR.AN);
                        productIds[AIR.AN] = AIR.ID;
                    }
                }
                else {
                    if (AIR.CN != "undefined" && AIR.CN.length > 0) {
                        productNames.push(citynames + "-(" + AIR.ID + ")" + "~" + AIR.CN + "~" + AIR.AN);
                        productIds[AIR.AN] = AIR.ID;
                    }
                }
            });
        }
        catch (ex) {
        }

        $('#txtorigincity, #txtdestinationcity').typeahead('destroy');
        $('#txtorigincity, #txtdestinationcity').typeahead({
            source: productNames,
            items: 5,
            scrollBar: true,
            onSelect: displayResults,
        });

        function displayResults(item) {
            var selectedvalues = item.value;
            $('.alert').show().html('You selected <strong>' + selectedvalues + '</strong>: <strong>' + item.text + '</strong>');
        }
    }

    var Airdata = "";
    $(document).ready(function () {
        LoadAirlineNames("FlightName,MulFlightName");
        $('#hdnHS').val(false);
        $('#hdndirect').val(false);
        $('#rd_Host').on("change", function () {
            hideoldavaildetails();
            if (this.checked == true) {
                $('#hdnHS').val(true);
            }
            else {
                $('#hdnHS').val(false);
            }
        });
        $('#rd_direct').on("change", function () {
            hideoldavaildetails();
            if (this.checked == true) {
                $('#hdndirect').val(true);
            }
            else {
                $('#hdndirect').val(false);
            }
        });
    });
    $(document).ready(function () {
        $("#txtdeparture,#txtarrivaldate").datepicker({
            numberOfMonths: 2,
            showButtonPanel: false,
            dateFormat: "dd/mm/yy",
            minDate: "@currenctdate_ad",
            maxDate: "@ViewBag.maxdate"
        });
        $("#txtdeparture").on("change keyup paste", function (e) {
            changeReturndate();
        });
        if (terminal_app != null && terminal_app == "T") {
            LoadClient();
        }
        else {
            sessionStorage.setItem("clientid", "@ClientID");
            sessionStorage.setItem("clientname", "@ClientName");
            sessionStorage.setItem("branchid", "@BranchID");
        }
    });
    function changeReturndate() {
        hideoldavaildetails();
        $("#txtarrivaldate").val("");
        $("#txtarrivaldate").datepicker("destroy");
        $("#txtarrivaldate").datepicker({
            numberOfMonths: 2,
            showButtonPanel: false,
            dateFormat: "dd/mm/yy",
            minDate: $("#txtdeparture").val(),
            maxDate: "@ViewBag.maxdate"
        });
        $("#txtarrivaldate").val($("#txtdeparture").val());
        if ($("body").data("tripflag") == "R" || $("body").data("tripflag") == "Y") {
            setTimeout(function () {
                $("#txtarrivaldate").focus();
            }, 200);
        }
    }

    function airlinecityloadfun_contr() {
        jQuery.each($(".clrcity"), function (key, value) {
            $(".clrcity")[key].value = "";
        });
        $('#dvGDSStickbottom').hide();
        hideoldavaildetails();
        airlinecityloadfun('', assignedcountry);


    }
    function hideoldavaildetails() {
        /*modify search time hide old avail*/
        $("#dvAvailView").hide();
        $("#imodifyclosebtn").hide();
        /*modify search time hide old avail*/
    }

    $(".comlisttriptype").click(function () {
        var checkedid = this.id;
        hideoldavaildetails();
        $('#dvMSearch').hide();
        $('#dvNormalSearch').slideDown();
        $('#callFar').hide();
        $('#dvGDSStickbottom').hide();
        if (checkedid == "lioneways") {
            $(".comlisttriptype").removeClass("active");
            $("#lioneways").addClass("active");
            $("#txtarrivaldate").attr("disabled", true);
            $('#txtarrivaldate').parent().css('background-color', '#eee');
            $('#txtarrivaldate').css('cursor', 'not-allowed');
            $('.arrivacal').css('display', 'none');
            $('.deptvacal').css('width', '100%');
            $('.DeptDateboxs').removeClass('DeptDateboxs_edit');
            $("body").data("tripflag", "O");
            $("#roundfltnum").css("visibility", "hidden");
            $("#roundfltseg").css("visibility", "hidden");
            $("#fli_option").append('<option value="ALL">ALL</option>');
            $("#fli_option")[0].value = "ALL";
            $("#themeroundtrsricon").css("display", "none");
            $("#roundtrsricon").css("visibility", "hidden");

        }
        else if (checkedid == "liRoundTrip") { //Roundtrip...

            $(".comlisttriptype").removeClass("active");
            $("#liRoundTripSpl").addClass("active");
            $('.arrivacal').css('display', 'block');
            $('.deptvacal').css('width', '50%');
            $('.DeptDateboxs').addClass('DeptDateboxs_edit');
            $("#txtarrivaldate").attr("disabled", false);
            $('#txtarrivaldate').parent().css('background-color', '#fff');
            $('#txtarrivaldate').css('cursor', 'pointer');
            $("body").data("tripflag", "Y");
            $("#fli_option").append('<option value="ALL">ALL</option>');
            $("#fli_option")[0].value = "ALL";
            $("#themeroundtrsricon").css("display", "block");
            $("#roundtrsricon").css("visibility", "visible");
            $("#roundfltnum").css("visibility", "visible");
            $("#roundfltseg").css("visibility", "visible");
        }
        else {
            $(".comlisttriptype").removeClass("active");
            $("#limulticity").addClass("active");
            $("body").data("tripflag", "M");
        }
        $("#hdtxt_trip").val($("body").data("tripflag").trim());
    });


    var availhitcnt = 0;
    var rescount = 0;
    var reqcount = 0;
    var reqsession = "0";
    var aryglobalallAvail = [];
    var availhitcnt = 0;
    var aryglobalallAvail_GDS = [];
    var airnamearray = [];
    var UIDCORP = "";
    var aryAvailParam = [];
    var aryPrevSearch = [];
    function searchgds() {
        $("#dvAvailView").hide();
        aryorgcity = [];
        arydescity = [];
        arydepdate = [];
        aryglobalallAvail_GDS = [];
        aryglobalallAvail = [];
        airnamearray = []
        aryAvailParam = [];
        aryPrevSearch = [];
        var origincity,
           destinationcity,
           departuredate,
           arrivaldate,
           adultcount,
           childcount,
           infantcout,
           triptype,
           segmenttype,
           cabin,
           flightname,
             fltnumkey,
           fltsegmentkey,
           cate,
           Class,
           flightoption = "";

        origincity = $("#txtorigincity").val().trim();
        if (origincity.split("(").length > 1) {
            $("#hdtxt_origin").val(origincity.split("(")[1].split(")")[0].trim());
            $("#hd_org_fu").val(origincity.split("-")[0].trim());
        }
        else {
            showerralert("Please select valid origin city.", "", "");
            return false;
        }
        aryorgcity.push($("#hdtxt_origin").val());
        destinationcity = $("#txtdestinationcity").val().trim();
        if (destinationcity.split("(").length > 1) {
            $("#hdtxt_destination").val(destinationcity.split("(")[1].split(")")[0].trim());
            $("#hd_des_fu").val(destinationcity.split("-")[0].trim());
        }
        else {
            showerralert("Please select valid destination city.", "", "");
            return false;
        }

        if (terminal_app == "T") {
            if ($("#ddlclient").length > 0) {
                if (sessionStorage.getItem("clientid") == "" || sessionStorage.getItem("clientid") == 'undefined' || sessionStorage.getItem("clientid") == null || $('#ddlclient').val() == "" || $('#ddlclient').val() == "0") {
                    showerralert("Please Select Agency name.", "", "");
                    return false;
                }
            }
            if ($('#ddlTerminalId').length > 0) {
                if ($('#ddlTerminalId').val() == "") {
                    showError1("Please Select Terminal ID");
                    return false;
                }
                sessionStorage.setItem("clientid", $('#ddlTerminalId').val());
            }
        }
        $('#dvinnerAvail_SingleResponse').html("");
        $('#dvinnerAvail_LeftResponse').html("");
        $('#dvinnerAvail_RightResponse').html("");
        arydescity.push($("#hdtxt_destination").val());
        departuredate = $("#txtdeparture").val().trim();
        var returndate = $("#txtarrivaldate").val().trim();
        $("#hdtxt_depa_date").val(departuredate);
        arydepdate.push($("#hdtxt_depa_date").val());
        arrivaldate = $("#txtarrivaldate").val().trim();
        $("#hdtxt_Arrivedate").val(arrivaldate);
        adultcount = $("#ddladult").val();
        $("#hdtxt_adultcount").val(adultcount);
        childcount = $("#ddlchild").val() != null && $("#ddlchild").val() != "" ? $("#ddlchild").val().trim() : "0";
        $("#hdtxt_childcount").val(childcount);
        infantcout = $("#ddlinfant").val() != null && $("#ddlinfant").val() != "" ? $("#ddlinfant").val().trim() : "0";
        $("#hdtxt_infantcount").val(infantcout);
        flightname = $("#FlightName").val() != null && $("#FlightName").val() != undefined && $("#FlightName").val() != "" ? $("#FlightName").val().join(',') : "";
        cate = $("#fli_option").val();
        Class = $("input[name='flight-class']:checked")["0"].value;
        $("body").data("GDSCategoryType", "");
        var gdsAirCate = $("body").data("GDSCategoryType");
        triptype = $("#lioneways")[0].checked == true ? "O" : "R";
        availhitcnt++;
        segmenttype = $("#domastic")[0].checked == true ? "D" : "I";

        var new_arr = $.grep(loadGlobalcityArrry, function (n, i) {
            return n.ID == $("#hdtxt_origin").val();
        });
        var new_arr_des = $.grep(loadGlobalcityArrry, function (n, i) {
            return n.ID == $("#hdtxt_destination").val();
        });
        segmenttype = new_arr[0].CN == assignedcountry && new_arr_des[0].CN == assignedcountry ? "D" : "I";
        if ($("#international")[0].checked == true && segmenttype == "D") {
            showerralert("Please select international city only.", "", "");
            return false;
        }
        var InetFlg = checkconnection();
        if (!InetFlg) {
            showerralert("Please check connectivity.", "", "");
            return false;
        }
        $("#dvGDSStickbottom").hide();
        $('#dvGdsselectedFlights').html('');
        if (triptype == "R") {
            for (var i = 1; i <= 2; i++) {
                $('#dvGdsselectedFlights').append('<div class="col-xs-12 col-sm-6"><div class="row row10 selectedfltOuter gdsstickyfltoutr" id="divselectedFlightsGDS_' + i + '" style="margin-bottom:2px;"></div></div>');
            }
        }
        sessionStorage.setItem("Triptype", triptype);
        sessionStorage.setItem('segtype', segmenttype);
        $('body').data('segtype', segmenttype);

        var searchDet = adultcount + "~" + childcount + "~" + infantcout + "~" + triptype + "~" + segmenttype + "~" + Class + "~" + origincity + "~" + destinationcity;
        $('body').data('fltsearchdet', searchDet);

        $('#pmodifydetilsegment').html("<span>" + $("#txtorigincity").val().trim() + "</span>" + " to " + "<span>" + $("#txtdestinationcity").val().trim() + "</span>");
        $('#spnmodifydetdep').html($("#txtdeparture").val())
        $('#spnmodifydetadt').html(adultcount);
        $('#spnmodifydetchd').html(childcount);
        $('#spnmodifydetinf').html(infantcout);
        $('#dvmodifydetcls').html($("input[name='flight-class']:checked")["0"].dataset.value);

        if (triptype == "R") {
            $('#spnmodifydetRtn').html($("#txtarrivaldate").val());
            $('#spnmodifydettriptyp').html('Round Trip');
        }
        $("#hdtxt_trip").val(triptype);
        var Airporttype = "";
        var pType = "";
        var agentId = "";
        var terminal = "";
        var Branch = "";
        var Agencyname = "";
        var time = 300000;
        ClientID = sessionStorage.getItem('clientid') != null ? sessionStorage.getItem('clientid').trim() : "";
        BranchID = sessionStorage.getItem('branchid') != null ? sessionStorage.getItem('branchid').trim() : "";
        GroupID = sessionStorage.getItem('Groupid') != null ? sessionStorage.getItem('Groupid').trim() : "";
        $.blockUI({
            message: '<center><div class="loaddiv"><p style="display:block; color:#333; font-size:12px;"> Searching availability </p><p>Please Wait...</p><div class="loader"></div></div></center>',
            css: { backgroundColor: '#fff', padding: '15px', 'border-radius': '5%' }, fadeIn: 0
        });
        var gridcount = triptype == "O" ? "1" : "2";
        AvailParam = {
            strfromCity: origincity, strtoCity: destinationcity, strDepartureDate: departuredate, strRetDate: returndate, strAdults: adultcount,
            strChildrens: childcount, strInfants: infantcout, TripType: triptype, Airline: flightname/* == "" ? "ALL" : flightname*/, FCategory: cate, Class: Class,
            availagent: agentId, availterminal: terminal, Agencyname: Agencyname, ClientID: ClientID, BranchID: BranchID, GroupID: GroupID, segmenttype: segmenttype, UID: "", reqker: reqsession
        }
        reqcount++;

        $.ajax({
            type: "POST", 		//GET or POST or PUT or DELETE verb
            url: FlightsearchUrl,
            data: JSON.stringify(AvailParam),
            contentType: "application/json; charset=utf-8",
            async: true,
            dataType: "json",
            timeout: time,
            success: function (data) {

                var adhitcount = "";
                var adavailrs = "";
                reqsession = "1";
                var avail = data;
                if (avail.Status == "1") {
                    $.unblockUI();
                    $("#dvAvailView").show();
                    //$("#searc9cls").hide();
                    $("#dvSearchArea").hide();
                    var hitCnt = "";
                    var grp = [];
                    rescount++;
                    var availres = JSON.parse(data.Result[4]);

                    if (availres[0].length > 0) {
                        hitCnt = availres[0][0].FareSegRef;
                    }
                    adhitcount = hitCnt;
                    if (triptype == "O") {
                        $('#spnTotalFAvailCntParent').show();
                        $("#spnActlFAvailCnt").html(availres.length);
                    }
                    else {
                        $('#spnTotalFRoundAvailCntParent').hide();
                        $('#spnTotalFAvailCntParent').hide();
                    }
                    if (availres.length > 0) {

                        if (rescount == 1) {
                        }
                        var buildAvail = "";
                        var dta = new Date();
                        bindingavail_GDS(availres, "", AvailParam.TripType, gridcount, Airporttype, "", hitCnt, rescount, "");
                    }
                    if (reqcount == rescount) {
                        afterAllResponce_GDS(rescount, AvailParam, "0", adavailrs, gridcount, adhitcount);
                    }
                }
                else if (avail.Status == "0") {
                    $.unblockUI();
                    avail.Message = avail.Message != null && avail.Message != "" ? avail.Message : "Unable to fetch availability. Please try again later."
                    showerralert(avail.Message, "", "");
                }
                else {
                    $.unblockUI();
                    avail.Message = avail.Message != null && avail.Message != "" ? avail.Message : "Unable to fetch availability. Please try again later."
                    showerralert(avail.Message, "", "");
                }

            },
            error: function (e) {
                $.unblockUI();
                showerralert("unable to process your request. please contact support team.", "", "");
            }
        });
    }
    var checkmobile = '@Request.Browser.IsMobileDevice';

    function checkconnection() {
        try {
            if (checkmobile.toUpperCase() == "TRUE") {
                return true; //For Mobile need to develop.... now temporarly return true.... by saranraj...
            }
            else {
                var status = navigator.onLine;
                if (status) {
                    return true;
                } else {
                    return false;
                }
            }
        }
        catch (e) {
            return true; //For Browser capability Safty purpose ...
        }
    }
    //var aryglobalallAvail = [];
    //var availhitcnt = 0;
    //var aryglobalallAvail_GDS = [];
    //var airnamearray = []
    //var UIDCORP = "";
    //var aryAvailParam = [];
    //var aryPrevSearch = [];
    function bindingavail_GDS(availres, RS, Triptype, T, Airporttype, Corporateflag, hitCnt, rescnt, flag) {

        if (clearflag == 0) {
            $(".prog_class").show();
            $('#dvinnerAvail_SingleResponse').html("");
            $('#dvinnerAvail_LeftResponse').html("");
            $('#dvinnerAvail_RightResponse').html("");

            clearflag++;
        }

        $('.sorthdr').hide(); //Common all header hide...
        if (T == "1") {
            $('#Sort_filter_GDS').show(); // GDS oneway header show...
        }
        else {
            if (Triptype == "R") {
                $('#dvrTriphdr1_GDS, #dvrTriphdr2_GDS').show(); // GDS roundtrip header show...
            }
            else {
                $('#Sort_filter_Mul_GDS').show(); // GDS Multicity header show...
            }
        }
        for (var iAvail = 0; iAvail < availres.length; iAvail++) {
            var uniqkey = "key" + availres[iAvail][0].PlatingCarrier + availres[iAvail][0].Airlinecategory + availres[iAvail][0].FareSegRef + iAvail;

            aryglobalallAvail_GDS.push({ keyid: uniqkey, valueid: availres[iAvail] });
            buildAvail = FormAvail_GDS(availres[iAvail], RS, Triptype, T, iAvail, Airporttype, Corporateflag, flag, hitCnt, uniqkey);
            if (T == "1") {
                $('#dvinnerAvail_SingleResponse').append(buildAvail);
            }
            else {
                if (Triptype == "R") {
                    if (availres[iAvail][0].SegRef == "0") {
                        $('#dvinnerAvail_LeftResponse').append(buildAvail);
                    }
                    else {
                        $('#dvinnerAvail_RightResponse').append(buildAvail);
                    }
                }
                else {
                    $('#dvmultipleAvail00' + availres[iAvail][0].FareSegRef).append(buildAvail);
                }
            }
        }
    }

    function afterAllResponce_GDS(resavailnos, AvailParam, flgFrmSearchorAvail, rs, t, rat_newCurncy, hitCnt) {
        var farearray = [];
        var namedepttimeary = [];

        try {
            $(".filteroverlay").hide();
            $(".disableclass").prop("disabled", false)
            $("#btnprevavail").removeClass("disableclass");
            $("#btnnextavail").removeClass("disableclass");
            if (resavailnos > 0) { //Minimum one Avail came...
                var segCnt = AvailParam.TripType == "O" ? 1 : (AvailParam.TripType == "R" || (AvailParam.TripType == "Y" && AvailParam.Corporateflag == "LCC")) ? 2 : AvailParam.TripType == "M" ? aryOrgMul.length : 1;
                var segmentcnt = 0;
                var SegmentType = sessionStorage.getItem("segtype");

                if (flgFrmSearchorAvail == "0" && segCnt == 2 && SegmentType == 'D') {
                    $("#spnflights").css("display", "none");
                    $(".cur_Flightscnt").css("display", "none");
                    var cltcur = $(".cur_typeflag").html();
                    $("#lblcntandcurrency").html("<span><i class='fa fa-envelope' style='border-radius: 50%; color: #126a9c; width: 30px; cursor: pointer; font-size: 15px; border: 2px solid #126a9c; padding: 2px 6px 4px 2px; display: none;'></i></span>All Fare(s) in : <span class='cur_type'>" + cltcur + "</span>");
                } else {

                }
            }
            else {
                $('#LoadMoreResults').hide();
                $('#LoadMoreResultsModifySearch').hide();
                $("#SearchPG").show();
                $("#dvBacktoAvail").hide();
                $("#Avail_Response").hide();
                showerralert("No flight(s) available. Please contact support team (#03).", "", "");
                return false;
            }

            $('#LoadMoreResults').hide();
            $('#LoadMoreResultsModifySearch').hide();
            if (flgFrmSearchorAvail == "0") {
                $('#dvFiltertabHeader .nav-tab-item').not(':first').remove();//by default clear everything exclude first set (like oneway)...
                $('#dvFiltertabBody .tab-info').not(':first').remove();//by default clear everything exclude first set (like oneway)...
                $('#dvFiltertabBody .tab-info').first().show();//by default show first set Filteration...
                $('#dvFiltertabHeader .nav-tab-item').first().addClass('active');
            }

            var flgfiltrsts = true;
            $('#dv_parent .clssearchfltr').each(function () {
                var idd = this.id;
                if (document.getElementById(idd).checked == false)
                    flgfiltrsts = false;
            });

            if ((AvailParam.TripType == "O") || ((AvailParam.TripType == "Y") && (AvailParam.Corporateflag != "LCC"))) {
                if (flgFrmSearchorAvail == "0") {
                    $('#dvFiltertabHeadersub1').html(AvailParam.OriginCode + " - " + AvailParam.DestinationCode + "<span id='spn1block'>(" + $(".BaindAvailSingle").length + ")</span>");
                    $("#dvFiltertabHeader").show();
                }

                var minval = 0;
                if (resavailnos > 0) { //Minimum one Avail came...

                    if (flgFrmSearchorAvail == "0" && $("#Chb_Persbooking").length > 0 && $("#Chb_Persbooking").prop("checked") == true) {
                        $(".showaddtocart").css("display", "none")
                    }


                    console.log("(4) after Arrange: " + new Date());

                    var ms_ie = false;
                    var ua = window.navigator.userAgent;
                    var old_ie = ua.indexOf('MSIE '); //Upto IE 10
                    var new_ie = ua.indexOf('Trident/');//IE 11
                    var latest_id = ua.indexOf('Edge/'); // >IE 11
                    if ((old_ie > -1) || (new_ie > -1) || (latest_id > -1)) {
                        ms_ie = true;
                    }
                    if (!ms_ie) {//to Check Not IE...
                        //OpenCloseSort();
                    }

                    var flightno = $('#dvinnerAvail_Response .clsAvailSet001 .list-item-entry').first().data('flightno');
                    var departure = $('#dvinnerAvail_Response .clsAvailSet001 .list-item-entry').first().data('departmix1');

                    sessionStorage.setItem("suggestedflightno", flightno);
                    sessionStorage.setItem("suggestedDeparture", departure);

                    $("#hdfsuggestedflightno").val(flightno);
                    $("#hdfsuggestedDeparture").val(departure);

                    $("body").data("suggestedminfare", minval);
                    $("#hdfsuggestedminfare").val(minval);
                    sessionStorage.setItem("suggestedminfare", minval);

                    $(".clsMulTimefilter").css("display", "block");
                    //Fare Filteration Ends...
                }
                //End...

            }

            else if (((AvailParam.TripType == "R") && SegmentType == 'D') || ((AvailParam.TripType == "Y") && (AvailParam.Corporateflag == "LCC")) || (SegmentType == 'I')) {

                if (resavailnos > 0) { //Minimum one Avail came...

                    if (flgFrmSearchorAvail == "0" && $("#Chb_Persbooking").length > 0 && $("#Chb_Persbooking").prop("checked") == true) {
                        $(".showaddtocart").css("display", "none")
                    }

                    var ms_ie = false;
                    var ua = window.navigator.userAgent;
                    var old_ie = ua.indexOf('MSIE ');
                    var new_ie = ua.indexOf('Trident/');
                    var latest_id = ua.indexOf('Edge/');
                    if ((old_ie > -1) || (new_ie > -1) || (latest_id > -1)) {
                        ms_ie = true;
                    }

                    //Default sorting
                    for (var i = 1; i <= 2; i++) {
                        var flightno = $('#dvinnerAvail_Response .clsAvailSet00' + i + ' .list-item-entry').first().data('flightno');
                        var departure = $('#dvinnerAvail_Response .clsAvailSet00' + i + ' .list-item-entry').first().data('departmix1');

                        sessionStorage.setItem("suggestedminfare", minval);
                        sessionStorage.setItem("suggestedflightno", flightno);
                        sessionStorage.setItem("suggestedDeparture", departure);
                    }

                    flgfiltrsts = false;
                    $(".clsMulTimefilter").css("display", "block");
                }
            }
            else if (AvailParam.TripType == "M") {
                var subcntnt = $('#dvaccBody1').html();
                for (var i = 0; i < aryOrgMul.length; i++) {
                    if (i == 0)
                        $('#dvFiltertabHeadersub1').html("<b data-toggle='tooltip' data-placement='top' title='" + aryOrgMul[i] + " - " + aryDstMul[i] + "'>1</b>");
                    else {
                        $('#dvFiltertabHeader').append('<div class="nav-tab-item"><b  data-toggle="tooltip" data-placement="top" title="' + aryOrgMul[i] + " - " + aryDstMul[i] + '">' + (i + 1) + '</b></div>');
                        $("#dvFiltertabHeader").show();

                        for (var a = 1; a <= 11; a++) {
                            subcntnt = subcntnt.replace(new RegExp("text-" + a, "g"), "text-" + a + i);
                        }
                        $('#dvFiltertabBody').append('<div class="tab-info" style="display: none;"> <div class="acc-body" id="dvaccBody' + (i + 1) + '">' + subcntnt.replace("slider-range1", "slider-range" + (i + 1) + "").replace("amount1", "amount" + (i + 1) + "").replace("slider-range-departure1", "slider-range-departure" + (i + 1) + "").replace("Departuretime1", "Departuretime" + (i + 1) + "") + '</div></div>');

                    }

                    if (resavailnos > 0) { //Minimum one Avail came...
                        //Fare Filteration Starts...
                        //////var arrfares = $.map($('.clsAvailSet00' + (i + 1) + ' .list-item-entry'), function (item, index) {
                        //////    return parseInt($(item).data('pricemix1'));//To get all Fares in Array to get min and Max values...
                        //////});
                        //////arrfares = arrfares.sort(function (a, b) { return a - b });

                        //////var minval = arrfares.length > 0 ? arrfares[0] : 0;
                        //////var maxval = arrfares.length > 0 ? arrfares[arrfares.length - 1] : 0;
                        //////$("#amount" + (i + 1) + "").data('min', minval);
                        //////$("#amount" + (i + 1) + "").data('max', maxval);
                        //Fare Filteration Ends...
                    }
                }
            }

            for (var sc = 1; sc <= segCnt; sc++) {
                var aryfltr = $.grep(airnamearray, function (n, i) {
                    return n.SC == sc.toString()
                });
                var airlinestringbuilder = "";
                for (var lp = 0; lp < aryfltr.length; lp++) {
                    airlinestringbuilder += '  <div class="input-entry color-7 airlinenamecount" id="mainspn_' + aryfltr[lp].PC + '">'
                    airlinestringbuilder += '  <input class="checkbox-form filter chkfilter chkfilterplane"  id="chkairfltr_' + sc + "_" + lp + '" type="checkbox" name="checkbox" data-filterflag="true"  data-filter=".' + aryfltr[lp].CL + '">';
                    airlinestringbuilder += '  <label class="clearfix" for="chkairfltr_' + sc + "_" + lp + '">'
                    airlinestringbuilder += '  <span class="sp-check"><i class="fa fa-check"></i></span>'
                    var len = $(".clsAvailSet00" + sc + " .Airname_" + aryfltr[lp].PC).length;
                    airlinestringbuilder += '  <span class="checkbox-text" > ' + aryfltr[lp].AN + '&nbsp;(' + aryfltr[lp].PC + ') <span class="airavailcnt">(' + len + ')</span></span>'
                    airlinestringbuilder += '  </label>'
                    airlinestringbuilder += '  </div>'
                }
                $("#dvFiltertabBody #dvaccBody" + sc + " .sidebar-rating").append(airlinestringbuilder);
            }

            $("#LoadMoreResultsModifySearch").hide();
            $('#dvMainFilteration').css('visibility', 'visible');
            $(".clsfarefltr,.clsfrtypfltr").hide();
            $('#h4gdsStops').html("Stops");
            $('.clsMulsortsegActive').html("1");
            gdsmulsltkeystemp = [];

            SetCount = AvailParam.TripType == "M" ? aryOrgMul.length : (AvailParam.TripType == "R" || (AvailParam.TripType == "Y" && AvailParam.Corporateflag == "LCC")) ? 2 : 1;

            console.log("Request End to Client: " + new Date());

            if (flgFrmSearchorAvail == "0") {
                setTimeout(function () {
                    if (AvailParam.TripType == "M") {
                        for (var i = 1; i <= mulcnt; i++) {
                            if ($('.clsRound_' + i + '').length)
                                $(".clsRound_" + i + ":eq( 0 )").show();
                        }
                    }
                    else {
                        if ($('.clsRound_1').length) {
                            $(".clsRound_1:eq( 0 )").show();
                            var cpy = $(".clsRound_1:eq( 0 )");
                            $(".clsRound_1:eq( 0 )").remove();
                            $('#dvrTriphdr1').append(cpy);
                        }
                        if ($('.clsRound_2').length) {
                            $(".clsRound_2:eq( 0 )").show();
                            var cpy = $(".clsRound_2:eq( 0 )");
                            $(".clsRound_2:eq( 0 )").remove();
                            $('#dvrTriphdr2').append(cpy);
                        }
                    }
                }, 1000);
            }

            if (flgFrmSearchorAvail == "0" && aryAvailParam.length > 0) {

                aryPrevSearch.push(aryAvailParam);
                localStorage.removeItem('sPrevSearch' + sessionstrg);
                localStorage.setItem('sPrevSearch' + sessionstrg, JSON.stringify(aryPrevSearch));
            }

            if (flgFrmSearchorAvail == "0") {
                $('[data-toggle="tooltip"]').tooltip();

                //InitPopover();

                $(".clsSelectChkbox").click(function (e) {

                    if ($(".clsSelectChkbox").is(":not(:checked)")) {
                        $("#liAllAvailchechbox").prop("checked", false);
                    }
                    else {
                        $("#liAllAvailchechbox").prop("checked", true);
                    }
                });

                $(".clsSelectChkboxReturn").click(function () {
                    if ($("body").data("RoundtripsFlag") == "R") {
                        if ($(".clsSelectChkboxReturn").is(":not(:checked)")) {

                            $("#liAllAvailchechbox").prop("checked", false);
                        }
                        else {
                            $("#liAllAvailchechbox").prop("checked", true);
                        }
                    }
                });
            }
        } catch (e) {
            msg = 'Unable to sort availability. (#03).';
            showError1(msg);
            console.log(e.message);
        }
    }

    function FormAvail_GDS(Avail, hitcntRspl, TripType, AvailSide, ii, SegTyp, RTStype, flag, hitCnt, uniqkey) {

        s = '';
        str_Dyc = "";
        try {
            var i = ii;
            p = Avail;
            if (p.length > 0) {
                Fare_description = [];

                if (TripType == "R")
                    hitCnt = p[0].SegRef;
                bascls = "";
                chkMailcls = "";
                Codetype = "";
                ItenaryRef = p[0].ItinRef;
                AirlineName = p[0].AirlineName;
                bascls = AvailSide == "1" ? "BaindAvailSingle" : hitCnt == "0" ? "BaindAvailAvailLeft" : "BaindAvailAvailRight";
                chkMailcls = AvailSide == "1" ? "clsSelectChkbox" : hitCnt == "0" ? "clsSelectChkbox" : "clsSelectChkboxReturn";
                marbtmcls = "";
                onwrdplane = AvailSide == "1" ? "TakeOffPlane" : "TakeOffRPlane";
                retplane = AvailSide == "1" ? "ArrivalPlane" : "ArrivalRPlane";
                cls10 = AvailSide == "1" ? "" : "col10";
                row10 = AvailSide == "1" ? "" : "row10";
                marbot20 = AvailSide == "1" ? "" : "marginbotm4mob20";
                ConnDate = AvailSide == "1" ? "clsconndate" : "clsconndate2";
                ConnTime = AvailSide == "1" ? "clsconncitytime" : "clsconncitytime2";
                Connouter = AvailSide == "1" ? "clsOnwardConnouter" : "clsOnwardConnouter2";
                ConnLayover = AvailSide == "1" ? "clsAvailLayover" : "clsAvailLayover2";
                imglogo = AvailSide == "1" ? "newlogo" : "";

                var basclsgds = AvailSide == "1" ? "gdssingle" : hitCnt == "0" ? "gdsround gdsleft" : "gdsround gdsright";
                var hideOrShowtag = AvailSide == "1" ? "" : "hidecls";
                var sm6or9 = AvailSide == "1" ? "col-sm-6" : TripType == "M" ? "col-sm-7" : "col-sm-6";
                var sm9or12 = AvailSide == "1" ? "col-sm-9" : "col-sm-12";
                var sm3or12 = AvailSide == "1" ? "col-sm-3" : "col-sm-12"; //dgsstrip
                var pr15 = AvailSide == "1" ? "pr15" : "";
                var pl15 = AvailSide == "1" ? "pl15" : "";
                var li10 = AvailSide == "1" ? "" : "li10";
                var Rfr = AvailSide == "1" ? "" : "Rfr";
                var nowrap = AvailSide == "1" ? "nowrap" : "";
                var trpflag = AvailSide == "1" ? "O" : TripType == "M" ? "M" : "R";

                var sm2or3 = TripType == "M" ? "col-sm-2" : "col-sm-3";

                dtFiltr = p[0].DepartureTime.replace(":", "");
                atFiltr = p[p.length - 1].ArrivalTime.replace(":", "");

                stopscalculate = ((TripType == "Y" && RTStype == "FSC") || (SegTyp == "I" && TripType == "R")) ? p.length - 2 : p.length - 1; //p[0].Stops //Added by saranraj for Stops calculation...

                clsdept = Number(dtFiltr) < 0601 ? "dept1" : Number(dtFiltr) < 1201 ? "dept2" : Number(dtFiltr) < 1801 ? "dept3" : "dept4";
                clsarriv = Number(atFiltr) < 0601 ? "arri1" : Number(atFiltr) < 1201 ? "arri2" : Number(atFiltr) < 1801 ? "arri3" : "arri4";
                clsstop = Number(stopscalculate) == 0 ? "stop0" : Number(stopscalculate) == 1 ? "stop1" : Number(stopscalculate) == 2 ? "stop2" : "stop3";
                clsair = "air" + p[0].PlatingCarrier;
                clsrefun = p[0].Refund.toUpperCase() == "TRUE" ? "refun" : p[0].Refund.toUpperCase() == "FALSE" ? "nonrefun" : "a";
                Fare_description = p[0].Faredescription;

                //Airline Name for Filtration region

                s += '<div class="mix groupAvailroot list-item-entry availtrptyp gdsrchAvil ' + TripType + ' gdsavail ' + bascls + " " + clsrefun + " " + basclsgds + ' Airname_' + p[0].PlatingCarrier + '"  id="flightavail_' + uniqkey + '" data-refundmix1="' + clsrefun + '" data-durmix1="' + p[0].JourneyTime + '" data-pricemix1="' + p[0].GrossAmount + '" data-departmix1="' + dtFiltr + '"';
                s += 'data-arrivmix1="' + atFiltr + '" data-stopsmix1="' + stopscalculate + '" data-airlinemix1="' + p[0].PlatingCarrier + '" data-drtionmix1="' + p[0].FlyingTime + '" data-mulavailcntid="' + hitCnt + '" data-flightno="' + p[0].FlightNumber + '" data-conlen="' + p.length + '"  data-availlength= "1"   style="width:100%;">'; //Start :01#
                s += '<div class="hotel-item bg-white containerpop" id="container_' + uniqkey + '">';//Start :02#
                s += '<div class="row row10">';
                s += '<div class="' + sm9or12 + ' col-xs-12 clsgdsFltroot">';
                for (var j = 0; j < p.length; j++) {
                    s += '<div class="row gdsFltdet">';
                    s += '<div class="' + sm2or3 + ' col-xs-3 col10">';
                    s += '<div class="radius-top cell-view ' + li10 + '">';
                    strLogoPng = p[j].CarrierCode;
                    AirLogo = AirLogo_URL + strLogoPng + ".png";
                    if (checkmobile.toUpperCase() == "TRUE") {
                        s += '<center><img  class="show-MulpopFare imglogo ' + imglogo + '" data-animation="pop"  data-placement="vertical"  id="imgflight_' + uniqkey + j + '"  data-target="BagagePop_' + uniqkey + j + '" src="' + AirLogo + '" alt=""> <label id="lblairlinetype_' + uniqkey + j + '" style="white-space:nowrap;font-size:11px;">' + p[j].FlightNumber + '</label></center>';
                    }
                    else {
                        if (TripType == "M")
                            s += '<center><img  class="show-MulpopFare imglogo ' + imglogo + '" data-animation="pop"  data-placement="auto-bottom" id="imgflight_' + uniqkey + j + '"  data-target="BagagePop_' + uniqkey + j + '" src="' + AirLogo + '" alt=""> <label id="lblairlinetype_' + uniqkey + j + '" style="font-size:11px;">' + p[j].FlightNumber + '</label></center>';
                        else
                            s += '<center><img  class="show-MulpopFare imglogo ' + imglogo + '" data-animation="pop"  data-placement="auto-bottom" id="imgflight_' + uniqkey + j + '"  data-target="BagagePop_' + uniqkey + j + '" src="' + AirLogo + '" alt=""> <label id="lblairlinetype_' + uniqkey + j + '" style="white-space:nowrap;font-size:11px;">' + p[j].FlightNumber + '</label></center>';
                    }
                    s += '</div>';
                    //#region Airline Mousehover Popup
                    CarrierCode = p[j].CarrierCode != null && p[j].CarrierCode != "" ? p[j].CarrierCode : "N/A";
                    MulticlassAvail = (p[j].MulticlassAvail == "3" || p[j].MulticlassAvail == "2") ? "Y" : "N";
                    Stock = p[j].STK != null && p[j].STK != "" ? p[j].STK : "N/A";
                    Airlinecategory = p[j].Airlinecategory != null && p[j].Airlinecategory != "" ? p[j].Airlinecategory : "N/A";
                    finalhours = Math.floor((Number(p[j].FlyingTime) / 60));
                    finalminutes = Number(p[j].FlyingTime) % 60;
                    Jfinalhours = Math.floor(Number(p[j].JourneyTime) / 60);
                    Jfinalminutes = Number(p[j].JourneyTime) % 60;
                    StartTerminal = p[j].StartTerminal;
                    EndTerminal = p[j].EndTerminal;
                    s += '<div class="popover bottom MulpopFare webui-popover-content" id="dvimgflight_' + uniqkey + j + '" style="border:1px solid #ff6600; display: none;">';
                    s += '<div class="arrow"></div>';
                    s += '<div class="popover-inner">'; //Start:05#
                    s += '<div>';

                    s += '<table class="clstblFarePopup">';
                    s += '<tr> <td class="clstblBorderright clsBoldlft">Departure Airport</td> <td class="colclass">:</td> <td class="clsamt classRight">' + p[j].OriginName + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsBoldlft">Arrival Airport</td> <td class="colclass">:</td> <td class="clsamt classRight">' + p[j].DestinationName + '</td> </tr>';

                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Arrival On</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + p[j].ArrivalDate + " " + p[j].ArrivalTime + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Oprated By</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + CarrierCode + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Airline Name</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + AirlineName + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Dept. Terminal</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + StartTerminal + '</td> </tr>';

                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Arr. Terminal</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + EndTerminal + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Journey Time</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + calculatedurationnew(p[j].FlyingTime) + " " + '</td> </tr>';// Jfinalhours + " (Hrs) " + Jfinalminutes
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Flying Time</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + calculatedurationnew(p[j].FlyingTime) + "  " + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Multiclass Avail</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + MulticlassAvail + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Stock Type</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + Stock + '</td> </tr>';
                    s += '<tr> <td class="clstblBorderright clsGrossAmt clsBoldlft">Airlinecategory</td> <td class="colclass">:</td> <td class="clsGrossAmt clsamt classRight">' + Airlinecategory + '</td> </tr>';
                    s += '</table>';
                    s += '</div> </div>';
                    s += '</div>';
                    //#endregion

                    s += '</div>';
                    //#endregion

                    //#region Formation1A2 (colsm6 colxs9 - Departure and arrival details)
                    s += '<div class="' + sm6or9 + ' col-xs-9 col10">';
                    s += '<div class="fi_block grid-hidden row clsrow">';//Start:6A#
                    //#region Onward details
                    s += '<div class="flight-icon col-xs-6 col10 clsTakeOffBorder ' + pr15 + '">';//Start:07#
                    s += '<img class="fi_icon ' + onwrdplane + " " + hideOrShowtag + '" src="../Img/flight_icon_2.png?v1.1" alt="">';
                    s += '<div class="fi_content" style="text-align: right;">';
                    //if (AvailSide == "1") {
                    s += '<div class="fi_title color-dark-2 avalCityCode">';
                    s += '<label data-toggle="tooltip" data-placement="bottom" title="' + p[j].OriginName + '" id="lblOrgion_' + p[j].PlatingCarrier + uniqkey + j + '">' + p[j].OriginName.split('-')[0] + '</label>';
                    s += '</div>';
                    s += '<div class="fi_text color-grey ' + nowrap + '">';
                    var depdate = TripType == "M" ? p[j].DepartureDate.split(' ')[0] + " " + p[j].DepartureDate.split(' ')[1] : p[j].DepartureDate;
                    s += '<label id="lbldeparturetime_' + p[j].PlatingCarrier + uniqkey + j + '">' + depdate + '</label> <span class="spanTime">' + p[j].DepartureTime + '</span>';
                    s += '</div>';
                    s += '</div> </div>';
                    //#region Return details
                    s += '<div class="flight-icon col-xs-6 col-sm-5 col10 ' + pl15 + '">';//Start:08#
                    s += '<img class="fi_icon ' + retplane + " " + hideOrShowtag + '" src="../Img/flight_icon_1.png?v1.1" alt="">';
                    s += '<div class="fi_content fi_float">';

                    s += '<div class="fi_title color-dark-2 avalCityCode">';
                    s += '<label data-toggle="tooltip" data-placement="bottom" title="' + p[j].DestinationName + '" id="lblDestination_' + p[j].PlatingCarrier + uniqkey + j + '">' + p[j].DestinationName.split('-')[0] + '</label>';
                    s += '</div>';
                    s += '<div class="fi_text color-grey ' + nowrap + '">';

                    var arrdate = TripType == "M" ? p[j].ArrivalDate.split(' ')[0] + " " + p[j].ArrivalDate.split(' ')[1] : p[j].ArrivalDate;
                    s += '<label id="lblarivaltime_' + p[j].PlatingCarrier + uniqkey + j + '">' + arrdate + '</label> <span class="spanTime">' + p[j].ArrivalTime + '</span>';

                    s += '</div>';
                    s += '</div> </div>';
                    s += '</div>';
                    s += '</div>';
                    s += '<div class="col-sm-3 col-xs-12 col10" style="text-align:center;">';

                    s += GDSDurationFaretypeAndBagg(p, j, uniqkey, AvailSide);
                    if (Number(stopscalculate) > 0 && j == 0) {
                        s += '<button type="button" style="float:left !important;background-color:#0074e8; cursor:default;" class="clsRefundable fr" data-toggle="tooltip" data-placement="bottom" title="' + stopscalculate + " stop(s)" + '">' + stopscalculate + '</button>';
                    }
                    s += '</div>';
                    s += '<div class="col-xs-12 col10">';
                    var cabinlst = p[j].Cabin.split(',');
                    var seatlst = p[j].Seat.split(',');
                    s += '<ul class="cls_gdsClass gdsrnd_' + hitCnt + '">';
                    for (var cbl = 0; cbl < cabinlst.length; cbl++) {
                        var seatleftcnt = "N/A";
                        var seatlft = $.grep(seatlst, function (n, i) {
                            return n.split('-')[0].trim() == cabinlst[cbl].trim()
                        });
                        if (seatlft.length > 0)
                            seatleftcnt = seatlft[0].split('-')[1].trim();
                        s += '<li class="li_gdsClass" id="licls_' + uniqkey + j + cbl + '"  data-toggle="tooltip" data-placement="top" title="Seat Left: ' + seatleftcnt + ' " data-cls=' + cabinlst[cbl] + ' data-keys=' + uniqkey + ' onclick=' + '"' + "javascript:SelectCls2GetFare('" + uniqkey + "','" + j + cbl + "','" + trpflag + "','" + hitCnt + "')" + '"' + '><span>' + cabinlst[cbl] + "   " + '  <span class="seatleftclsgds">' + seatleftcnt + '</span> </span></li>';
                        s += '';
                    }
                    s += '</ul>';
                    if (AvailSide != "1") {
                        var cnt = TripType == "R" ? hitCnt : (hitCnt - 1);
                        s += '<label style="display:none;" id="lblMulfrRul_' + uniqkey + j + '" class="clsAvailFareRule MulGDSfrRl" id="" onclick=' + '"' + "javascript:return ShowFSCFareRule('btnbookingselect_" + uniqkey + "','GDS_MUL','" + cnt + "')" + '"' + '>Fare Rule</label>';
                    }
                    s += '</div>';
                    s += '</div>';
                    if (j != p.length - 1) {
                        s += '<div class="row row0"><div class="bdr-dash" style="position:relative"><span class="conn_flight" style="font-weight:600; cursor:default; " data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Layover">Layover time ' + calculateduration(p[j + 1].DepartureTime, p[j].ArrivalTime) + ' </span></div></div>';
                    }
                }

                s += '</div>';
                s += '<div class="' + sm3or12 + ' col-xs-12">';
                if (AvailSide == "1") {
                    s += '<div class="color-grey-3 hv-o cat-drop" id="dvfare_' + uniqkey + '" align="center" style="visibility:hidden;position:relative;top:5px;">';
                    s += '<label id="lblfare_' + uniqkey + '" class="show-MulpopFaredesc ' + Rfr + '" data-animation="pop"  data-placement="vertical" style="font-size:1.6em; color:#000;" > <em class="emgdscorpfare" style="display:none" id="gdscorporatefare_' + uniqkey + '"> C </em> <em style="background:#3cafe4" class="emgdscorpfare" style="display:none" id="gdsretailfare_' + uniqkey + '"> R </em> <i class="fa fa-inr"></i> <span>0</span> </label>';
                    s += '<label class="clsAvailFareRule" onclick=' + '"' + "javascript:return ShowFSCFareRule('btnbookingselect_" + uniqkey + "','GDS')" + '"' + '>Fare Rule</label>';
                    s += '</div>';
                    s += '<div class="clsGDSbtn"><div class="norcoraltbtn"> </div>   </span><div class="corfarnormalfareclss animated flipInX" id="wholecorfare_' + uniqkey + '" style="padding:2px 0;"><span style="left:-3px;"  id="normalfarehit_' + uniqkey + '" class="farebtnclass" onclick=' + '"' + "javascript:return GDSgetFareORselect(this.id," + p.length + ")" + '"' + '>Normal </a></span> <span style="display:none" id="corporatefarehit_' + uniqkey + '" class="farebtnclass"onclick=' + '"' + "javascript:return Corporatefarehit(this.id," + p.length + ")" + '"' + '>Corporate</a></span>  <span style="display:none" id="Retailfarehit_' + uniqkey + '" class="farebtnclass"onclick=' + '"' + "javascript:return Retailfarehit(this.id," + p.length + ")" + '"' + '>Retail</a></span>  </div><a href="javascript:void(0);" style="width:100%; font-size: 11px !important;" class="c-button b-30 color-red-3 hv-red-3-o showselectaddtocart cmn-brdr-clr" id="btnGetfareorselect_' + uniqkey + '"  data-contentkey=' + "'" + uniqkey + "'" + ' data-fareselect="" data-slectflg="0"  data-fareid="' + p[0].FareId + '" onclick=' + '"' + "javascript:return selectnorcorfare(this.id," + p.length + ")" + '"' + '>Get Fare</a></div>';

                }
                else {

                }
                s += '</div>';
                s += '</div>';
                s += '</div>';
                s += ' </div>';
            }

        } catch (e) {

            s = '';
            console.log("error while form availability: " + e.message + " (#03).");
        }
        return s;
    }
    function OpenCloseSort() {
        $('.drop').on("click", function () {

            if ($(this).find('.drop-list').hasClass('act')) {
                $(this).parent().removeClass("drop-wrap-rect");
                $(this).find('.drop-list').removeClass('act');
                $(this).find('span').slideUp(300);
            } else {
                $(this).parent().addClass("drop-wrap-rect");
                $('.drop span').slideUp(300);
                $('.drop .act').removeClass('act');
                $(this).find('.drop-list').addClass('act');
                $(this).find('span').slideDown(300);
            }
            return false;
        });
        $('.drop span a').on("click", function () {
            $(this).parent().parent().find('b').text($(this).text());
            $('.drop').find('span').slideUp(300);
        });
    }

    function InitPopover() {
        var settings = {
            trigger: 'hover',
            title: 'FLIGHT DETAILS',
            content: '',
            width: 300,
            multi: true,
            closeable: false,
            style: 'box-shadow:0 0px 25px rgb(16, 128, 204)',
            delay: 300,
            padding: true,
            backdrop: false,
            placement: "right-bottom",

        };
        $('.show-MulpopFare').each(function () {

            var crntId = this.id;
            var tableContent = $("#dv" + crntId + "").html(),
                           tableSettings = {
                               content: tableContent,
                           };
            $("#" + crntId).webuiPopover('destroy').webuiPopover($.extend({}, settings, tableSettings));
        });

        var settingsnew = {
            trigger: 'hover',
            title: 'FARE DETAILS',
            content: '',
            multi: true,
            closeable: false,
            style: 'box-shadow:0 0px 25px rgb(16, 128, 204)',
            delay: 300,
            padding: true,
            backdrop: false,
            placement: "right-bottom",

        };
        $('.show-MulpopFaredesc').each(function () {

            var crntId = this.id;
            var tableContent = $("#dv" + crntId + "").html(),
                           tableSettings = {
                               content: tableContent,
                           };
            $("#" + crntId).webuiPopover('destroy').webuiPopover($.extend({}, settingsnew, tableSettings));

        });

        var baggdet = {
            trigger: 'hover',
            title: 'BAGGAGE DETAILS',
            content: '',
            multi: true,
            closeable: false,
            style: 'box-shadow:0 0px 25px rgb(16, 128, 204)',
            delay: 300,
            padding: true,
            backdrop: false,
            placement: "bottom",

        };
        $('.show-baggage').each(function () {

            var crntId = this.id;
            var tableContent = $("#dv" + crntId + "").html(),
                           tableSettings = {
                               content: tableContent,
                           };
            $("#" + crntId).webuiPopover('destroy').webuiPopover($.extend({}, baggdet, tableSettings));

        });
    }
    function calculatedurationnew(FlyingTime) {
        try {
            FlyingTime = Math.abs(FlyingTime)
            var flyingtimehrs = Math.floor(FlyingTime / 60);
            var flyingtimemins = FlyingTime % 60;
            return flyingtimehrs + " H " + flyingtimemins + " M ";
        }
        catch (e) {
            return "0 H 0 M";
        }
    }

    function GDSDurationFaretypeAndBagg(p, j, uniqkey, AvailSide) {
        var s = '';
        var hrsFlyingTimeO = Math.floor(Number(p[j].FlyingTime) / 60);
        var FlyingTimeminsO = (Number(p[j].FlyingTime) % 60);
        if (p.length > 1) {
            var connect_duration = calculateduration(p[j].ArrivalTime, p[j].DepartureTime);
            s += '<span class="clsAvailDruation" data-toggle="tooltip" data-placement="top" title="Duration"><i class="fa fa-clock-o"></i> ' + connect_duration + '</span>';

        }
        else {
            s += '<span class="clsAvailDruation" data-toggle="tooltip" data-placement="top" title="Duration"><i class="fa fa-clock-o"></i> ' + calculatedurationnew(p[j].FlyingTime) + '</span>'; //hrsFlyingTimeO + " h " + FlyingTimeminsO + " m "
        }
        s += '<div class="cls_gdsrefun" id="btnRefund_' + uniqkey + j + '">';
        s += '</div>';
        s += '<div class="cls_gdsBag" id="dvBaggagedet_' + uniqkey + j + '">';
        s += '</div>';
        return s;
    }

    function calculateduration(arrtime, deptime) {
        try {
            var departure_time = (deptime.split(":")[0] * 60) + Number(deptime.split(":")[1]);
            var arrival_time = (arrtime.split(":")[0] * 60) + Number(arrtime.split(":")[1]);

            if (departure_time > arrival_time) {
                arrival_time = arrival_time + 1440;
            }
            var total_time = arrival_time - departure_time;
            return Math.floor(total_time / 60) + " H " + (total_time % 60) + " M ";
        }
        catch (e) {
            return "0 H 0 M"
        }

    }
    function SelectCls2GetFare(keys, arg, trp, htcnt) {

        $("#btnGDSroundGetfrORselect").addClass("fltblurclss");
        // $(".fltblurclss").prop("disabled", true);
        $("#btnGDSroundGetfrORselect").removeClass("changegdssltcls");
        $("#sltflrebtnid").find(".norcoraltbtnrndtrp").hide();
        $("#btnGetfareorselect_" + keys).parent(".clsGDSbtn").removeClass("changegdssltcls");
        $("#btnGetfareorselect_" + keys).parent(".clsGDSbtn").find(".norcoraltbtn").hide();

        if (trp == "O") {
            $('#licls_' + keys + arg).siblings('li').removeClass('active');
            $('#licls_' + keys + arg).addClass('active');

            $('#flightavail_' + keys + ' .cls_gdsrefun').html('');
            $('#flightavail_' + keys + ' .cls_gdsBag').html('');

            $('#lblfare_' + keys).find('span').html('0');
            $('#dvfare_' + keys).find('webui-popover-content').remove();
            $('#dvfare_' + keys).css('visibility', 'hidden');
            $('#btnGetfareorselect_' + keys).removeClass('sel-btn').data('slectflg', '0').html("Get Fare");
        }
        else {
            $('.gdsrnd_' + htcnt + ' li').not($('#licls_' + keys + arg).parents('.gdsFltdet').siblings('.gdsFltdet').find('.cls_gdsClass li')).removeClass('active');
            $('#licls_' + keys + arg).addClass('active');
            $('#flightavail_' + keys + ' .cls_gdsrefun').html('');
            $('#flightavail_' + keys + ' .cls_gdsBag').html('');

            $("#dvGDSStickbottom").show();
            var selectary = $.grep(aryglobalallAvail_GDS, function (n, i) {
                return n.keyid == keys
            });
            if (selectary.length == 0) {
                showerralert("internal problem occured.", "", "");
                return false;
            }
            var clss = [];
            $('#licls_' + keys + arg).parents('.clsgdsFltroot').find('.gdsFltdet .cls_gdsClass .li_gdsClass').each(function () {
                if ($(this).hasClass('active')) {
                    clss.push($(this).data('cls'));
                }
            });
            BindFltDetinStickybtm(selectary[0].valueid, clss, trp, keys, arg);
        }
    }

    function BindFltDetinStickybtm(results, clss, trp, keys, arg) {

        $(".cmsnorcorcls").hide();
        var clsses = results.length != clss.length ? "fltblurclss" : "";
        var strloadsletflts = "";
        var cnt = "";
        var orignNm = "", destiNm = "";
        if (trp == "R") {
            cnt = Number(results[0].SegRef) + 1;
        }
        else {
            cnt = $('#licls_' + keys + arg).parents('.groupAvailroot').data('mulavailcntid');
        }
        $("body").data("Segwisegds_" + cnt, results[0].CarrierCode);
        if (trp == "M" && Number($("body").data("Multicitylength")) > 2) {
            orignNm = results[0].Origin;
            destiNm = results[results.length - 1].Destination;
        }
        else {
            orignNm = results[0].OriginName.split('-')[0];
            destiNm = results[results.length - 1].DestinationName.split('-')[0];
        }
        var AirLogo_URL = "";
        var AirLogo = AirLogo_URL + results[0].CarrierCode + ".png";
        $("#divselectedFlightsGDS_" + cnt).html("");
        var cntdsn = sessionStorage.getItem("Triptype") == "R" ? "2" : sessionStorage.getItem("mulcnt");
        var col2cls = cntdsn == 2 ? "col-sm-2 col-xs-12" : "col-xs-12";
        var col4cls = cntdsn == 2 ? "col-sm-4 col-xs-12" : "col-xs-12";
        var col6cls = cntdsn == 2 ? "col-sm-6 col-xs-12" : "col-xs-12";
        strloadsletflts += "<div style='padding: 10px 10px;' class='col-sm-2 col-xs-2 col10'><img style='max-width:35px;' id='imgRflight_0' src='" + AirLogo + "' alt='' /><h6>" + results[0].FlightNumber + "</h6></div>"  //" / " + results[0].CNX +
        strloadsletflts += "<div style='padding:10px' class='col-sm-4 col-xs-4 col10 '><h6><img class='fi_icon TakeOffRPlane' src='../Img/flight_icon_2.png' alt=''>" + orignNm + " - " + destiNm + "</h6>";
        var minutestohour = (Number(results[0].FlyingTime) / 60);
        var finalminutes = (Number(results[0].FlyingTime) % 60);
        var finalhours = minutestohour.toString().split('.')[0];
        strloadsletflts += "<h6 style='white-space: nowrap;'>" + results[0].DepartureTime + " - " + results[results.length - 1].ArrivalTime + "</h6>";
        strloadsletflts += "</div>";
        strloadsletflts += "<div class='col-sm-6 col-xs-6' style='position:relative;'>";
        strloadsletflts += "<div class='row row0'>";
        strloadsletflts += "<div class='col-sm-6 col-xs-12 col10 clsxs' style='padding:10px'>";
        strloadsletflts += "<h6 class='hidden-xs'> <span style='font-size: 11px;'>(" + calculatedurationnew(results[0].FlyingTime) + " )</span></h6>"; //finalhours + "HRS " + finalminutes

        for (var cl = 0; cl < clss.length; cl++) {
            strloadsletflts += "<span class='btmsltGDScls'>" + clss[cl] + "</span>";
        }
        strloadsletflts += "</div>";
        strloadsletflts += "<div class='col-sm-6 col0'>";
        strloadsletflts += "<a href='#' style='width: 100%;background:#5f5f5f;color:#fff' class='" + clsses + " c-button b-40 mygraybtn roundgetfarebtn newclsroundgetfarebtn' id='btnGetfareorselect_" + keys + "' data-slectflg='0' onclick='javascript:selectnorcorfare(this.id," + results.length + "); return false;'>Get Fare</a>";
        strloadsletflts += '<label style="display:none;font-size:1.5em;padding:0 0px 10px;" class="labelcmnfareclss" id="Labelfare_' + keys + '" > <em style ="float:left;top:6px;padding:1px 5px;"> </em> <span> 0 </span> <div class="fscmulfarerulgds"  onclick=' + '"' + "javascript:return ShowFSCFareRule('btnbookingselect_" + keys + "','GDS')" + '"' + '> Fare Rule </div>   <div id="otherfarediv_' + keys + '" class="otherfarediv"  onclick=' + '"' + "javascript:return otherfaresfun('" + keys + "')" + '"' + '> Other Fares </div> </label>';
        strloadsletflts += "</div>";
        strloadsletflts += "</div>";
        strloadsletflts += "<div id='Threefarediv_" + keys + "' class='roundmorefarebtns animated flipInX'>";
        strloadsletflts += "</div>";
        strloadsletflts += "</div>";

        $("#divselectedFlightsGDS_" + cnt).append(strloadsletflts);
        $('#lblfare_spnGDSrndFr').html("");
        $('#lblfare_spnGDSrndFr').parent('p').css('visibility', 'hidden');
        $('#lblMulfrRul_' + keys + arg).hide('slow');
    }
    function GDSgetFareORselect(argid, fltcnt, flag) {


        var flg = $('#btnGetfareorselect_' + argid.split("_")[1]).data('slectflg');
        var keyID = argid.split('_')[1];
        if (flg == "0") {
            GDSgetFare4Cls(keyID, fltcnt, flag);
        }
        else {
            GDSselect4Cls(keyID, fltcnt);
        }
    }
    function selectnorcorfare(argid, fltcnt) {

        var flg = $('#btnGetfareorselect_' + argid.split("_")[1]).data('slectflg');
        var keyIDfare = argid.split('_')[1];
        if (flg == 1) {
            GDSselect4Cls(keyIDfare, fltcnt);
            return false;
        }
        GDSgetFareORselect(argid, fltcnt);
    }
    function GDSgetFare4Cls(keyID, fltcnt, flag) {

        var aryclass = [];
        $("#gdscorporatefare_" + keyID).hide();
        $("#gdsretailfare_" + keyID).hide();

        $('#flightavail_' + keyID + ' ul.cls_gdsClass li').each(function () {
            if ($(this).hasClass('active'))
                aryclass.push($(this).data('cls'));
        });

        if (aryclass.length != fltcnt) {
            $.unblockUI();
            $("#sltflrebtnid").find(".norcoraltbtnrndtrp").hide();
            if (fltcnt == 1) {
                showerralert("Please select any Class to Get Fare.", "", "");
                return false;
            }
            else {
                showerralert("Please select Class for all segments to Get Fare.", "", "");
                return false;
            }

        }

        $(".corfarnormalfareclss").hide();
        var selectary_temp = $.grep(aryglobalallAvail_GDS, function (n, i) {
            return n.keyid == keyID
        });
        var selectary = [];
        for (var obj in selectary_temp) {
            selectary.push(selectary_temp[obj].valueid);
        }
        if (selectary.length == 0) {
            showerralert("internal problem occured.", "", "");
        }

        var clientid = "";
        var branchid = "";
        var ariporttyp = "";
        var searchDet = $("body").data('fltsearchdet');
        if ($("#ddlclient").length > 0) {
            clientid = sessionStorage.getItem('clientid').trim();
            branchid = sessionStorage.getItem('branchid').trim();
        }
        else {
            clientid = "";
            branchid = BranchID;
        }

        if (sessionStorage.getItem("segtype") != null && sessionStorage.getItem("segtype") != "") {
            ariporttyp = sessionStorage.getItem("segtype");
        }
        else {
            ariporttyp = "I";
        }

        var params = {
            selectflight: JSON.stringify(selectary),
            Classid: aryclass,
            ClientID: clientid,
            BranchID: branchid,
            Airporttype: ariporttyp,
            SearchDet: searchDet
        }

        $.blockUI({
            message: '<center><div class="loaddiv"><p style="display:block; color:#333; font-size:12px;"> Searching availability </p><p>Please Wait...</p><div class="loader"></div></div></center>',
            css: { backgroundColor: '#fff', padding: '15px', 'border-radius': '5%' }, fadeIn: 0
        });

        $.ajax({
            url: Flightgetfare,
            type: "POST",
            data: JSON.stringify(params),
            timeout: 180000,
            contentType: "application/json, charset=utf-8",
            dataType: "json",
            success: function (jdata) {
                $.unblockUI();
                if (jdata.status == "-1") {
                    window.location.href = sessionpath;
                }
                else if (jdata.status == "01") {
                    if (sessionStorage.getItem("Triptype") == "R" || sessionStorage.getItem("Triptype") == "M") {
                        btnfareroundmulfun(jdata.Result, keyID, flag);
                        return false;
                    }
                    $('#btnGetfareorselect_' + keyID).addClass('sel-btn').data('slectflg', '1').html("Select");
                    flag == "Y" ? $("#gdscorporatefare_" + keyID).show() : flag == "R" ? $("#gdsretailfare_" + keyID).show() : "";

                    var arychange = [];
                    var p = JSON.parse(jdata.Result);

                    aryglobalallAvail_GDS = $.map(aryglobalallAvail_GDS, function (n, i) {
                        if (n.keyid == keyID) {
                            n.valueid = [];
                            for (var len = 0; len < p.length; len++) {
                                n.valueid.push(p[len][0]);
                            }
                        }
                        return n
                    });

                    var res = p[0];
                    for (var i = 0; i < res.length; i++) {
                        var refun = res[i].Refund.toUpperCase() == "REFUNDABLE" ? "R" : "N-R";
                        $('#btnRefund_' + keyID + i).html("<span data-toggle='tooltip' data-placement='top' title='" + res[i].Refund + "' class='re'>" + refun + "</span>").find('span').tooltip();
                        $('#dvBaggagedet_' + keyID + i).html("<span data-toggle='tooltip' data-placement='top' title='Baggage' ><i class='fa fa-suitcase'></i> " + res[i].BaggageInfo.split(':')[5] + "</span>").find('span').tooltip();
                    }

                    $('#lblfare_' + keyID).find('span').html(res[0].GrossAmount);
                    if ($("#wholecorfare_" + keyID).data("showcorpnorflag") == "Y" || $("#wholecorfare_" + keyID).data("showRetailfare") == "Y") {
                        $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").find(".norcoraltbtn").remove();
                        $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").addClass("changegdssltcls");
                        if (flag == "Y") {

                            $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span style='left:1%' class='norcoraltbtn'> <em id='normalfarehit_" + keyID + "' onclick= 'Anothernormalfare(this.id, " + res.length + ")'> Normal  </em> </span>");
                            $("#wholecorfare_" + keyID).data("showRetailfare") == "Y" ? $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span style='left:30%'  class='norcoraltbtn'> <em id='Retailfarehit_" + keyID + "' onclick= 'Anotherretailfare(this.id, " + res.length + ")'> Retail </em></span>") : $('.norcoraltbtn').addClass("left1percent");

                        }
                        else if (flag == "R") {
                            $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span style='left:1%;padding:8px 2px' class='norcoraltbtn'> <em id='normalfarehit_" + keyID + "' onclick= 'Anothernormalfare(this.id, " + res.length + ")'> Normal  </em> </span>");
                            $("#wholecorfare_" + keyID).data("showcorpnorflag") == "Y" ? $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span  style='left:24%;padding:8px 2px' class='norcoraltbtn'> <em id='corporatefarehit_" + keyID + "' onclick= 'Anothercorporatefare(this.id," + res.length + ")'> Corporate </span>") : $('.norcoraltbtn').addClass("left1percent");
                        }
                        else {
                            $("#wholecorfare_" + keyID).data("showRetailfare") == "Y" ? $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span style='padding:8px;left:1%' class='norcoraltbtn'> <em id='Retailfarehit_" + keyID + "' onclick= 'Anotherretailfare(this.id, " + res.length + ")'> Retail </em> </span>") : "";
                            $("#wholecorfare_" + keyID).data("showcorpnorflag") == "Y" ? $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").append("<span style='padding:8px 2px;left:24%' class='norcoraltbtn'> <em id='corporatefarehit_" + keyID + "' onclick= 'Anothercorporatefare(this.id," + res.length + ")'> Corporate </em></span>") : "";
                            $("#wholecorfare_" + keyID).data("showcorpnorflag") != "Y" || $("#wholecorfare_" + keyID).data("showRetailfare") != "Y" ? $('.norcoraltbtn').addClass("left1percent") : ""; // For design changes

                        }
                        $("#btnGetfareorselect_" + keyID).parent(".clsGDSbtn").find(".norcoraltbtn").show();

                    }

                    //#region Fare Mousehover Popup
                    var s = BindFarePopover_GDS(res, keyID);

                    $('#dvfare_' + keyID + " .MulpopFare").remove();
                    $('#dvfare_' + keyID).append(s);
                    $('#dvfare_' + keyID).css('visibility', 'visible');

                    // InitPopover();
                }
                else {
                    showerralert(jdata.Errormsg, "", "");
                }
            },
            error: function (edata) {
                showerralert(edata.statusText, "", "");
            }
        });

    }
    function GDSselect4Cls(keyID, fltcnt) {

        var selectary_temp = $.grep(aryglobalallAvail_GDS, function (n, i) {
            return n.keyid == keyID
        });
        var selectary = [];
        var aryunselectcontent = [];

        for (var obj in selectary_temp) {
            selectary.push(selectary_temp[obj].valueid);
        }

        if ($("#gdscorporatefare_" + keyID).length > 0 && $("#gdscorporatefare_" + keyID).css("display") == "inline") {
            $.map(selectary[0], function (n, i) {
                n.FareType = "C"
            });

        }

        CheckOutSelectedavailTDK(selectary, aryunselectcontent, "", "GDS");

    }
    function showError1(msg) {
        showerralert(msg, "", "");
    }
    function BindFarePopover_GDS(res, keyID) {

        var s = '';
        s += '<div class="popover bottom MulpopFare webui-popover-content" id="dvlblfare_' + keyID + '" style="border:1px solid #ff6600;display: none;">';
        s += '<div class="arrow"></div>';
        s += '<div class="popover-inner">';
        s += '<div>';
        s += '<table class="clstblFarePopup">';
        var Fare_description = res[0].Faredescription;
        if (Fare_description[0].TAX.length > 0) {
            $.each(Fare_description[0].TAX, function (cnt, Fare) {
                Codetype = Fare.TAC;
                if (Codetype == "BF") {
                    Codetype = "BF(Basic Fare)";
                }
                else if (Codetype == "YQ") {
                    Codetype = "YQ(Fuel Surcharge)";
                }
                else if (Codetype == "WO") {
                    Codetype = "WO(Passenger Service Fee)";
                }
                else if (Codetype == "IN") {
                    Codetype = "IN(User Development Fee)";
                }
                else if (Codetype == "JN") {
                    Codetype = "JN(Service Tax)";
                }
                else if (Codetype == "YM") {
                    Codetype = "YM(Development Fee)";
                }
                else if (Codetype == "F2") {
                    Codetype = "F2(Swachh Bharat Cess)";
                }
                else if (Codetype == "G1") {
                    Codetype = "G1(Krishi Kalyan Cess)";
                }
                else if (Codetype == "YR") {
                    Codetype = "YR(Insurance Surcharge)";
                }
                s += '<tr>';
                s += '<td class="clstblBorderright clsBoldlft">' + Codetype + '</td>';
                s += '<td class="colclass">:</td>';
                s += '<td class="clsamt classRight ClsRight">' + Discountfare(Fare.TAM.toString()) + '</td>';
                s += '</tr>';
            });

            s += '<tr>';
            s += '<td colspan="3" id="tdborderup_' + res[0].PlatingCarrier + res[0].Airlinecategory + res[0].FareType + res[0].Origin + res[0].Destination + res[0].FareId + res[0].Stock + '">';
            //Content will come on run time... on Commission check box clicked...
            s += '</td>';

            s += '</tr>';
            s += '<tr id="trCommission_' + res[0].PlatingCarrier + res[0].Airlinecategory + res[0].FareType + res[0].Origin + res[0].Destination + res[0].FareId + res[0].Stock + '">';
            //Content will come on run time... on Commission check box clicked...
            s += '</tr>';
            if (res[0].Commission != null && res[0].Commission.toString() != "0") {
                s + '<tr>';

                s += '<td class="clstblBorderright clsBoldlft">Discount</td>';
                s += '<td class="colclass">:</td>';
                s += '<td class="clsamt classRight ClsRight">' + (res[0].Commission.toString()) + '</td>';
                s += '</tr>';
            }
            if (Fare_description[0]["CMKP"] != null && Fare_description[0]["CMKP"] != "" && Fare_description[0]["CMKP"] != "0") {

                s += '<tr>';
                s += '<td class="clstblBorderright clsBoldlft">Management Fee</td>';
                s += '<td class="colclass">:</td>';
                s += '<td class="clsamt classRight ClsRight">' + Fare_description[0]["CMKP"].toString() + '</td>';
                s += '</tr>';
            }
            s += '<tr> <td colspan="3"> <hr class="hrnew" /> </td> </tr>';
            s += '<tr>';

            s += '<td class="clstblBorderright clsBoldlft">Total Amount</td>';
            s += '<td class="colclass">:</td>';
            s += '<td class="clsamt classRight ClsRight">' + Discountfare(res[0].GrossAmount.toString()) + '</td>';
            s += '</tr>';
        }
        s += '</table>';
        s += '</div> </div>';
        s += '</div>';

        return s;
    }
    function Discountfare(Amount) {
        var SelectGrossAmount = Number(Amount);
        var Discountpercentage = 1;
        SelectGrossAmount = SelectGrossAmount - ((SelectGrossAmount * Discountpercentage) / 100);
        SelectGrossAmount = Math.ceil(SelectGrossAmount);

        return SelectGrossAmount;
    }
    function CheckOutSelectedavailTDK(arg, aryOthercontent, orginandDestination, OFBFlag, SpecialFareFlag) {

        var selectedDetails = $('body').data('fltsearchdet');
        var allowspecialfarehit = "";
        if ((SpecialFareFlag == undefined || SpecialFareFlag == "") && (((selectedDetails.split('~')[3] == "R" || selectedDetails.split('~')[3] == "M") && selectedDetails.split('~')[4] == "D") || sessionStorage.getItem("starttwooneway") == "Y")) {
            $("body").data("Specilfareargformul", JSON.stringify(arg));
            $("body").data("Specilfarearyothercontformul", JSON.stringify(aryOthercontent));
            if (arg[0][0].STK == arg[1][0].STK) {
                allowspecialfarehit = "Y";
            }
        }

        if (SpecialFareFlag != "Y") {
            $.blockUI({
                message: '<center><div class="loaddiv"><p style="display:block; color:#333; font-size:12px;"> Searching availability </p><p>Please Wait...</p><div class="loader"></div></div></center>',
                css: { backgroundColor: '#fff', padding: '15px', 'border-radius': '5%' }, fadeIn: 0
            });
        }
        $('#Avail_Norecord').hide();
        var Addcartoption = "";
        var PersonalBookingoption = "";
        if ($("#hdfpersonalbooking").length > 0)
            PersonalBookingoption = $("#hdfpersonalbooking").val();
        else
            PersonalBookingoption = "N";

        if ($("body").data("cartflag") == "A") {
            Addcartoption = arg;
            $("body").data("CartRefNo", Addcartoption.trim('|'));
        }
        else {

            $("body").data("cartflag", "");
            var sleFare = arg[0][0].GrossAmount;
            var Selected_RBDclassO = "";
            var Selected_RBDclassR = "";//$("body").data("selected_CLSinCabin") != null && $("body").data("selected_CLSinCabin") != "" ? $("body").data("selected_CLSinCabin") : "";
            //var aryOthercontent = [];

            if ($("body").data("RoundtripsFlag") == "O" || $("body").data("RoundtripsFlag") == "Y") {

                Selected_RBDclassO = $("body").data("selected_CLSinCabin") != null && $("body").data("selected_CLSinCabin") != "" ? $("body").data("selected_CLSinCabin") : "";
            }

            Selected_RBDclassO = $("body").data("selected_CLSinCabin") != null && $("body").data("selected_CLSinCabin") != "" ? $("body").data("selected_CLSinCabin") : "";
            Selected_RBDclassR = $("body").data("selected_CLSinCabinR") != null && $("body").data("selected_CLSinCabinR") != "" ? $("body").data("selected_CLSinCabinR") : "";
        }
        if (SpecialFareFlag == "Y") {
            var dumselflg = "";
            selectedDetails = selectedDetails.split("~");
            for (var spflg = 0; spflg < selectedDetails.length; spflg++) {
                dumselflg += spflg == "3" ? "Y~" : spflg == selectedDetails.length - 1 ? selectedDetails[spflg] : selectedDetails[spflg] + "~";

            }
            selectedDetails = dumselflg;
        }
        var QuerystringTripid = "";
        var Id = $('body').data('fareid');
        var RtripComparFlg = "";
        TotalPaxCount = $('body').data('fltsearchdet').split("~")[0] + "~" + $('body').data('fltsearchdet').split("~")[1] + "~" + $('body').data('fltsearchdet').split("~")[2];
        var multicabin = $("body").data("Multicabin") != undefined && $("body").data("Multicabin") != "undefined" && $("body").data("Multicabin") != null ? $("body").data("Multicabin") : "";
        var Specialflagfare = SpecialFareFlag == "Y" ? SpecialFareFlag : "";
        var TwoOnewayflag = sessionStorage.getItem("starttwooneway") == "Y" ? "Y" : "N";
        var Totdetails = selectedDetails.split('~');
        var SelectedData = {
            selectflight: arg != "0" ? JSON.stringify(arg) : JSON.stringify(globalCartarr),
            strJsonOthertxt: JSON.stringify(aryOthercontent),
            searchDet: selectedDetails,
            Adult: Totdetails[0],
            Child: Totdetails[1],
            Infant: Totdetails[2],
            TripType: $('#chkFroundtrp').is(':checked') == true ? "R" : $('#chkMulticity').is(':checked') == true ? "M" : "O",
            TotalPaxCount: TotalPaxCount,
            Refundableoption: $("body").data("rst_1_rst1refund"),
            button_id: OFBFlag,
            CurrencyCode: "",
            ClientID: sessionStorage.getItem("clientid"),
            Personalbooking: PersonalBookingoption,
            Specialflagfare: Specialflagfare,
            AllowSpecialFare: allowspecialfarehit,
            TwoOnewayflag: TwoOnewayflag,
            Multicabin: multicabin,
            QuerystringTripid: QuerystringTripid
        };
        var selecfltdet = {
            FlightID: arg[0][0].FlightNumber,
            Cabin: arg[0][0].Class,

            Class: arg[0][0].ClassType,
            Amount: arg[0][0].CarrierCode
        }
        var datatype = SpecialFareFlag == "Y" ? "json" : "html";
        $.ajax({
            type: "POST",
            url: "@Url.Action("GdsSelectedFltDetails", "Search")",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(SelectedData),
            dataType: datatype,
            success: function (json) {

                $.unblockUI();
                var result = json;
                var earnings_calculate = 0;
                if (result != "") {
                    $("#dvGDSStickbottom").hide();
                    GrossTotM = 0;
                    grossbagg = 0;
                    $("#dvSelectView").html(json);
                    var aryids = 0;
                    var i = 0;
                    for (var lp = 0; lp < aryids.length; lp++) {
                        $('#li_Rows' + aryids[lp]).find('.loadfightinfo').each(function () {
                            var Flightinfo = $(this).attr('data-popup');
                            var selaval = $('#li_slct_Rows').find('img.FlightTipimg').length > i ? $('#li_slct_Rows').find('img.FlightTipimg')[i].id : "";
                            selaval = selaval.replace("/", "");
                            i++;
                            if (selaval != "")
                                $('#' + selaval).attr('data-popup', Flightinfo);
                        });
                    }
                    $('.FlightTip').tooltipster({
                        contentAsHTML: true,
                        theme: 'tooltipster-punk',
                        animation: 'grow',
                        position: 'right',
                    });

                    var strAlert = $("#diverrormsg").html();
                    var statuscode = $("#divstatuscode").html();
                    if (statuscode != null && (statuscode == "2" || statuscode == "02" || statuscode == "3" || statuscode == "03") && RtripComparFlg != "0") {  //RtripComparFlg- For Roundtrp Spl Select from Roundtrp Avail no need to show reverse pupup's...
                        var alert_message = $("#divstatuscode").data("returnmessage");
                        var alertmsg = $("#divstatuscode1").data("returnmessage");
                        var Displayalert = (alert_message != null && alert_message != "") ? alert_message : alertmsg;

                        $('#pfrConfirmMsg').html(alert_message);
                        $("#modal_fr_confirm").modal({
                            backdrop: 'static',
                            keyboard: false
                        });
                        return false;

                    }
                    else if (strAlert != "" && strAlert != null && statuscode == "00") {
                        showerralert(strAlert, "", "");
                        return false;
                    }


                    if (RtripComparFlg == "0") { //Comparable Popup...
                        var Depid = $('#selectclickbuttonRTrip').data('dep-id');
                        var Rtnid = $('#selectclickbuttonRTrip').data('ret-id');

                        var RtrpSplFlt = $('#hdnRtrpSplFltfrmRtrp').val();
                        var myarys = JSON.parse(RtrpSplFlt);
                        myarys = JSON.parse(myarys);

                        showComparisionPop(Depid, Rtnid, myarys);
                    }
                    else {
                        RedirectToSelect();
                    }

                }
                else if (result = "") {
                    showerralert("Unable to select. problem occured internally. Please Contact Customer Care. (#09).", "", "");
                }
            },
            error: function (result) {
                $("#bindSelectedflights").html(result);
                $.unblockUI();
            }

        });
    }

    function showComparisionPop(Depid, Rtnid, RtrpSplAry) {
        var aryids = [];
        aryids.push(Depid);
        aryids.push(Rtnid);

        var s = '';
        s += '<div class="row">';
        s += '<div class="col-md-8 col-xs-12">';
        s += '<div class="row cmpRoundtrpParnt p-t-15">';
        var totfr = 0;
        for (var i = 0; i < aryids.length; i++) {

            var idss = aryids[i];
            var selectedObj = $.grep(dataproperty_array, function (n, i) {
                return n.datakey == idss;
            });
            // ary_Inva.push($('.Travselect_' + arySelectedFltIds[i])[0].dataset.hdInva);
            var hdnvalus = selectedObj[0]["data-hdInva"];
            //$('.Travselect_' + aryids[i])[0].dataset.hdinva;  //$('#hdInva' + aryids[i]).val();
            var arysplitconn = hdnvalus.split('SpLITSaTIS');
            var aryvalus = arysplitconn[0].split('SpLitPResna');
            var arylstvalus = arysplitconn[arysplitconn.length - 1].split('SpLitPResna');

            //GrossAmt                                          //Service Charge                                                                                    //Incentive
            var gross = (aryvalus.length > 14 ? parseInt(aryvalus[14]) : 0) + ((aryvalus.length > 26 && aryvalus[26] != null && aryvalus[26] != "") ? parseInt(aryvalus[26]) : 0) - ((aryvalus.length > 27 && aryvalus[27] != null && aryvalus[27] != "") ? parseInt(aryvalus[27]) : 0);
            if ($('#chkNFare').is(':checked')) {
                //Markup
                gross += (aryvalus.length > 28 && aryvalus[28] != null && aryvalus[28] != "") ? parseInt(aryvalus[28]) : 0;
            }
            totfr += gross;

            s += '<div class="col-sm-6 col-xs-12">';

            s += '<div class="rt pricingTable">';
            s += '<span class="icon"><img class="FlightTip" alt="" style="width: 25px; height: 25px;" src="' + imgurl + (aryvalus.length > 9 ? aryvalus[9] : "") + ".png?" + imgver + '" /></span>';

            s += '<div class="pricingTable-header">';
            if (i == 0)
                s += '<h3 class="title">Onward</h3>';
            else
                s += '<h3 class="title">Return</h3>';

            s += '<span class="price-value"><span class="assincur">' + assignedcurrency + '</span>' + gross + '</span>';
            s += '</div>';

            s += '<ul class="pricing-content">';
            s += '<li>' + (aryvalus.length > 18 ? aryvalus[18] : "") + '</li>';
            s += '<li>' + (aryvalus.length > 5 ? aryvalus[5] : "") + " - " + (aryvalus.length > 17 ? aryvalus[17] : "") + '</li>';

            //Departure
            var aryOtime = aryvalus.length > 2 ? aryvalus[2].split(' ') : "";
            s += '<li>' + (aryvalus.length > 0 ? aryvalus[0] : "") + " - <span class='boldtxt'>" + (aryOtime.length > 3 ? aryOtime[3] : "") + '</span><span class="m-l-5"><img src="../img/flight_icon_2.png"/></span></li>';

            //Arrival
            var aryRtime = arylstvalus.length > 3 ? arylstvalus[3].split(' ') : "";
            s += '<li>' + (arylstvalus.length > 1 ? arylstvalus[1] : "") + " - <span class='boldtxt'>" + (aryRtime.length > 3 ? aryRtime[3] : "") + '</span><span class="m-l-5"><img class="rtnflt" src="../img/flight_icon_1.png"/></span></li>';

            var refund = $('#li_Rows' + aryids[i]).data('refund');
            s += '<li>' + (refund == "refun" ? "Refundable: <span class='re'>Yes</span>" : (refund == "nonrefun" ? "Refundable: <span class='non-re'>No</span>" : "Refundable: <span class='no-re'>N/A</span>")) + '</li>';

            s += '</ul>';
            s += '</div>';
            s += '</div>';
            if (i == 0)
                s += '<span class="fltComparePlus"> <i class="fa fa-plus"></i> </span>';
        }

        s += '<div class="col-xs-12">';
        s += '<center><p class="ptotfr"><span>Total Fare: </span><span class="fr">' + totfr + '</span></p><button class="button btn-small selebtn btncmpr" onclick="javascript:GoWithRoundTrpFare();">Go 2 Oneway Fare</button></center>';
        s += '</div>';
        s += '</div>';
        s += '</div>';
        var rspfare = parseInt(RtrpSplAry[0].GrossAmount) + (RtrpSplAry[0].ServiceTax != null && RtrpSplAry[0].ServiceTax != "" ? parseInt(RtrpSplAry[0].ServiceTax) : 0) - (RtrpSplAry[0].Incentive != null && RtrpSplAry[0].Incentive != "" ? parseInt(RtrpSplAry[0].Incentive) : 0);
        if ($('#chkNFare').is(':checked')) {
            //Markup
            rspfare += (RtrpSplAry[0].MarkUp != null && RtrpSplAry[0].MarkUp != "") ? parseInt(RtrpSplAry[0].MarkUp) : 0;
        }
        s += '<div class="col-md-4 col-md-offset-0 col-sm-offset-3 col-sm-6 col-xs-12">';
        s += '<div class="row p-t-15">';
        s += '<div class="col-xs-12">';
        s += '<div class="rts pricingTable">';
        s += '<span class="icon"><img class="FlightTip" alt="" style="width: 25px; height: 25px;" src="' + imgurl + RtrpSplAry[0].PlatingCarrier + ".png?" + imgver + '" /></span>';

        s += '<div class="pricingTable-header">';
        s += '<h3 class="title">Roundtrip Special</h3>';

        s += '<span class="price-value"><span class="assincur">' + assignedcurrency + '</span>' + rspfare + '</span>';
        s += '</div>';

        s += '<ul class="pricing-content">';

        s += '<li>' + RtrpSplAry[0].FlightNumber + '</li>';
        s += '<li>' + RtrpSplAry[0].Class + " - " + RtrpSplAry[0].FAREBASISCODE + '</li>';

        var aryOtime = RtrpSplAry[0].DepartureDate.split(' ');
        s += '<li>' + RtrpSplAry[0].Origin + " - <span class='boldtxt'>" + (aryOtime.length > 3 ? aryOtime[3] : "") + '</span><span class="m-l-5"><img src="../img/flight_icon_2.png"/></span></li> ';

        var aryRtime = RtrpSplAry[RtrpSplAry.length - 1].ArrivalDate.split(' ');
        s += '<li>' + RtrpSplAry[RtrpSplAry.length - 1].Destination + " - <span class='boldtxt'>" + (aryRtime.length > 3 ? aryRtime[3] : "") + '</span><span class="m-l-5"><img class="rtnflt" src="../img/flight_icon_1.png"/></span></li>';

        var refund = RtrpSplAry[0].refund;
        s += '<li>' + (refund == "refun" ? "Refundable: <span class='re'>Yes</span>" : (refund == "nonrefun" ? "Refundable: <span class='non-re'>No</span>" : "Refundable: <span class='no-re'>N/A</span>")) + '</li>';


        s += '</ul>';
        s += '</div>';
        s += '</div>';
        s += '</div>';
        s += '<div class="row">';
        s += '<div class="col-xs-12">';
        s += '<center><p class="ptotfr"><span>Total Fare: </span><span class="fr">' + rspfare + '</span></p><button class="button btn-small selebtn btncmpr" style="min-width:180px;" onclick="javascript:GoWithRoundTrpSplFare();">Go Roundtrip Fare</button></center>';
        s += '</div>';
        s += '</div>';
        s += '</div>';
        s += '</div>';
        s += '';
        var Ititle = "Flight Comparision";
        var Isubtitle = "Comparision between 2 Oneway fare vs Roundtrip fare.";
        var IContent = s;
        var Ifullopt = true;
        var Itemp1 = "";
        var Itemp2 = "";
        $('#modal-Fare').removeClass('addtop');
        $("#hdtxt_trip").val("R"); //Reset Trip flag from Roundtrop Spl to Roundtrip for work as Roundtrip if Close popup...
        showpopuplogin(Ititle, Isubtitle, IContent, Ifullopt, Itemp1, Itemp2);
    }

    function btnfareroundmulfun(ary, keyid, flag) {

        ary = JSON.parse(ary);
        $("#Threefarediv_" + keyid).hide();
        $("#Labelfare_" + keyid).find("span").html(ary[0][0].GrossAmount);
        if (flag == "Y") {
            $("#Labelfare_" + keyid).find("em").addClass("emgdscorpfare").removeClass("emgdsretailfare").html("C");
        }
        else if (flag == "R") {
            $("#Labelfare_" + keyid).find("em").addClass("emgdsretailfare").removeClass("emgdscorpfare").html("R");
        }
        else {
            $("#Labelfare_" + keyid).find("em").removeClass("emgdscorpfare").removeClass("emgdsretailfare").html("");
        }

        $("body").data("Roundmulcheckcorpflag_" + keyid) == "Y" ? $("#otherfarediv_" + keyid).show() : $("#otherfarediv_" + keyid).hide();
        $("#Labelfare_" + keyid).show();

        var dsnflag = 0;
        $("#btnGetfareorselect_" + keyid).hide();
        aryglobalallAvail_GDS = $.map(aryglobalallAvail_GDS, function (n, i) {
            if (n.keyid == keyid) {
                n.valueid = ary[0];
            }
            return n
        });
        $(".labelcmnfareclss").each(function () {
            if (Number($(this).find("span").html()) != 0) {
                dsnflag++
            }
        });
        var cnt = sessionStorage.getItem("Triptype") == "R" ? "2" : sessionStorage.getItem("mulcnt");
        dsnflag == cnt ? $("#btnGDSroundGetfrORselect").removeClass("fltblurclss") : "";

        //   $("#btnGDSroundGetfrORselect").css('disabled', false);

    }

    function RedirectToSelect() {
        $("html, body").animate({ scrollTop: 0 }, 600);
        $('#dvmodifydetails,.sort-by-section').hide();//177
        //$("#dvinnerAvail_Response").css("display", "none");

        $("#dvAvailView").css("display", "none");
        $("#dvSearchArea").css("display", "none");
        $("#dvSelectView").css("display", "block");
    }

    $('#btnContinueFrChang').click(function () {
        $("#modal_fr_confirm").modal("hide");
        RedirectToSelect();
    });
    $("#btnFmodifySearch").click(function () {
        $('body').data('BackFlag', '');
        $("#hdn_allowfarecal").val("1");
        $('#dvSearchArea').slideToggle();
        $("html, body").animate({ scrollTop: 0 }, 600);
        $("#imodifyclosebtn").css("display", "block");
    });

    $(".modifyclosebtn").click(function () {
        $('body').data('BackFlag', 'AVAIL');
        $('#dvSearchArea').slideUp();
        $("#imodifyclosebtn").css("display", "none");
        $('#dvsamplemain').css("display", "block");
    });

    function LoadClient() {
        $.ajax({
            type: "POST",
            url: "@Url.Action("GetClientdetails", "HOME")",
            contentType: "application/json; charset=utf-8",
            timeout: 180000,
            dataType: "json",
            success: function (data) {
                try {
                    var data = data["Data"];
                    if (data.Status == "01") {
                        var arr = JSON.parse(data.Result);

                        $('#ddlclient,#ddlMulClient').typeahead('destroy');
                        $('#ddlclient,#ddlMulClient').typeahead({
                            source: arr,
                            items: 5,
                            displayField: "CLTNAME",
                            valueField: "CLTCODE",
                            scrollBar: true,
                            onSelect: displayResults,
                        });

                        function displayResults(item) {
                            var selectedvalues = item.value;
                            var agenttext = item.text;
                            var agencyname = agenttext.split('~')[0].split('-')[0];
                            var clientcount = item.CLT_CNT;

                            $('#ddlTerminalId').empty();
                            for (var m = 1; m <= parseInt(clientcount) ; m++) {
                                if (m < 10) {
                                    $("#ddlTerminalId").append('<option value="' + selectedvalues + "0" + m + '">' + selectedvalues + "0" + m + '</option>');
                                }
                                else {
                                    $("#ddlTerminalId").append('<option value="' + selectedvalues + m + '">' + selectedvalues + m + '</option>');
                                }
                            }

                            $('.alert').show().html('You selected <strong>' + item.value + '</strong>: <strong>' + item.text + '</strong>');
                            sessionStorage.setItem("clientid", selectedvalues);
                            sessionStorage.setItem("clientname", agencyname);
                            sessionStorage.setItem("branchid", item.bid_s);
                            sessionStorage.setItem('Groupid', item.GROUPID_s);
                            //hideError1("", "");
                            hideoldavaildetails();
                            fetchpaymentmode(selectedvalues);
                        }
                    }
                    else {

                    }
                }
                catch (err) {
                    console.log(err.message);
                }
            },
            error: function (e) {
                //alert("error");
            }
        });
    }

    $('#ddlclient').on('input', function () {
        $('#ddlTerminalId').empty().append("<option value=''>Terminal ID</option>");
    });

    function fetchpaymentmode(AgentId) {
        $.ajax({
            type: "POST", 		//GET or POST or PUT or DELETE verb
            url: '@Url.Action("BalanceCheck", "Home")',// Location of the service
            data: '{AgentId:"' + AgentId + '"}',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (json) {//On Successful service call
                if (json.Result[2] != null && json.Result[2] != "") {
                    var jsonarray = JSON.parse(json.Result[2]);
                    var Thread = jsonarray[0]["Thread"];
                    var FscThread = jsonarray[0]["FscThread"];
                    var LccThread = jsonarray[0]["LccThread"];
                    var MultiThread = jsonarray[0]["MultiThread"];
                    var SFCThread = jsonarray[0]["SFC"];
                    var NewThread = jsonarray[0]["NewThread"];
                    if (Thread != null && Thread != "") {
                        $("#hdthread").val(Thread);
                    }
                    if (FscThread != null && FscThread != "") {
                        $("#fscthreadkey").val(FscThread);
                    }
                    if (LccThread != null && LccThread != "") {
                        $("#lccthreadkey").val(LccThread);
                    }
                    if (MultiThread != null && MultiThread != "") {
                        $("#hdnMultiThread").val(MultiThread);
                    }
                    if (NewThread != null && NewThread != "") {
                        $("#newthreadkey").val(NewThread);
                    }
                    if (SFCThread != null && SFCThread != "") {
                        $("#hdnsfcthread").val(SFCThread);;
                    }
                    //$("#hdn_doublethread").val('@ViewBag.doublethread');
                }
            },
            error: function (e) {//On Successful service call
                if (e.status == "500") {
                    window.location.href = "@Url.Action("SessionExp", "Redirect")"
                    return false;
                }
            }	// When Service call fails

        });
    }

    Travellersclass();

    function Checkroundgdsnormalfare(arg, trp, cnt) {

        var flg = $(arg).data('slectflg');
        if (flg == "1") {
            NewGDSselect4roundcls(arg, trp, cnt);
            return false;
        }
        btnGDSRoundGetfrORselect(arg, trp, cnt);
    }

    function NewGDSselect4roundcls(arg, trp, cnt) {

        var keid = "";
        var selectarynew = [];
        var aryunselectcontent = [];

        $("#dvGdsselectedFlights").find(".newclsroundgetfarebtn").each(function () {
            keid = this.id.split("_")[1];
            var tempslary = $.grep(aryglobalallAvail_GDS, function (n, i) {
                return n.keyid == keid
            });
            if (tempslary.length > 0) {
                selectarynew.push(tempslary[0].valueid);
            }
        });

        CheckOutSelectedavailTDK(selectarynew, aryunselectcontent, "", "GDS");

    }

    function btnGDSRoundGetfrORselect(arg, trp, cnt, flag) {

        if ($("body").data("roundtrpgdsnorflg") == "Y" || $("body").data("roundtrpgdsretailflg") == "Y") { // To show Corporate or Normal Fare button
            $("#sltflrebtnid").find(".norcoraltbtnrndtrp").remove();
            $("#btnGDSroundGetfrORselect").addClass("changegdssltcls");
            if (flag == "Y") {
                $("#sltflrebtnid").append("<span style='left:-10%;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick= 'Anotherroundnoramlfare(this)'> Normal</em> </span>");
                $("body").data("roundtrpgdsretailflg") == "Y" ? $("#sltflrebtnid").append("<span style='left:24%;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick= 'AnotherRetailfare(this)'> Retail </em> </span>") : $(".norcoraltbtnrndtrp").addClass("lftchangecls");
                $(".norcoraltbtnrndtrp").show();
            }
            else if (flag == "R") {
                $("#sltflrebtnid").append("<span style='left:27%;padding:10px 2px;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick= 'Anotherroundnoramlfare(this)'> Normal </em> </span>");
                $("body").data("roundtrpgdsnorflg") == "Y" ? $("#sltflrebtnid").append(" <span style='left:-13%;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick ='Anotherroundcorporate(this)'> Corporate </em> </span>") : $(".norcoraltbtnrndtrp").addClass("lftchangecls");
                $(".norcoraltbtnrndtrp").show();
            }
            else {
                $("body").data("roundtrpgdsretailflg") == "Y" ? $("#sltflrebtnid").append("<span style='left:-10%;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick= 'AnotherRetailfare(this)'> Retail </em> </span>") : "";
                $("body").data("roundtrpgdsnorflg") == "Y" ? $("#sltflrebtnid").append(" <span style='left:17%; padding:10px 2px;' class='norcoraltbtnrndtrp'> <em data-content = " + trp + ',' + cnt + ',' + flag + " onclick ='Anotherroundcorporate(this)'> Corporate </em> </span>") : $(".norcoraltbtnrndtrp").addClass("lftchangecls");
                $("body").data("roundtrpgdsretailflg") != "Y" || $("body").data("roundtrpgdsnorflg") == "Y" ? $(".norcoraltbtnrndtrp").addClass("lftchangecls") : ""; //Design purpose
                $(".norcoraltbtnrndtrp").show();
            }
        }

        if (sessionStorage.getItem("Triptype") == "M") {
            trp = "M";
            cnt = sessionStorage.getItem("mulcnt");
        }

        var flg = $(arg).data('slectflg');
        if (flg == "0") {
            GDSgetFare4RoundCls(trp, cnt, flag);
        }
        else {
            GDSselect4RoundCls(trp, cnt);
        }
    }

    var strflg = 0;
    function SortingAvailasc(Flag, flg1) {

        var splitFlag = flg1.split('_');
        var splitFlag = Flag.split('_');
        if (strflg == 0) {

            var splitFlag = flg1.split('_');
            var splitFlagnone = flg1.split('_')[0];
            var dataprop = splitFlag.length > 0 ? splitFlag[0] : "pricemix1";
            var ordr = splitFlag.length > 1 ? splitFlag[1] : "asc";

            if ((sessionStorage.getItem("Triptype") == "M" && srchTyp == "GDS")) {
                SetCount = $('.clsMulsortsegActive').html();
            }
            else {
                SetCount = splitFlag[2];
            }

            if ($("." + splitFlagnone + "_" + SetCount).hasClass('fa-angle-up')) {
                $("." + splitFlagnone + "_" + SetCount).removeClass('fa-angle-up');
                $("." + splitFlagnone + "_" + SetCount).addClass('fa-angle-down');
            }
            if (flg1 == "pricemix1_desc_" + SetCount) {
                $(".pricemix1_" + SetCount).css("display", "block");
                $(".arrivmix1_" + SetCount).css("display", "none");
                $(".departmix1_" + SetCount).css("display", "none");
            }
            else if (flg1 == "departmix1_desc_" + SetCount) {
                $(".departmix1_" + SetCount).css("display", "block");
                $(".arrivmix1_" + SetCount).css("display", "none");
                $(".pricemix1_" + SetCount).css("display", "none");
            }
            else if (flg1 == "arrivmix1_desc_" + SetCount) {
                $(".departmix1_" + SetCount).css("display", "none");
                $(".arrivmix1_" + SetCount).css("display", "block");
                $(".pricemix1_" + SetCount).css("display", "none");
            }
            //for (var i = 1; i <= SetCount; i++) {
            tinysort('.clsAvailSet00' + SetCount + ' .groupAvailroot',
                {
                    data: dataprop,
                    order: ordr
                });
            /// }
            strflg = 1;

        }
        else if (strflg == 1) {
            var splitFlag = Flag.split('_');
            var splitFlagnone = Flag.split('_')[0];
            var dataprop = splitFlag.length > 0 ? splitFlag[0] : "pricemix1";
            var ordr = splitFlag.length > 1 ? splitFlag[1] : "asc";

            if ((sessionStorage.getItem("Triptype") == "M" && srchTyp == "GDS")) {
                SetCount = $('.clsMulsortsegActive').html();
            }
            else {
                SetCount = splitFlag[2];
            }

            if ($("." + splitFlagnone + "_" + SetCount).hasClass('fa-angle-down')) {
                $("." + splitFlagnone + "_" + SetCount).removeClass('fa-angle-down');
                $("." + splitFlagnone + "_" + SetCount).addClass('fa-angle-up');
            }

            if (Flag == "pricemix1_asc_" + SetCount) {
                $(".pricemix1_" + SetCount).css("display", "block");
                $(".arrivmix1_" + SetCount).css("display", "none");
                $(".departmix_" + SetCount).css("display", "none");
            }
            else if (Flag == "departmix1_asc_" + SetCount) {
                $(".departmix1_" + SetCount).css("display", "block");
                $(".arrivmix1_" + SetCount).css("display", "none");
                $(".pricemix1_" + SetCount).css("display", "none");
            }
            else if (Flag == "arrivmix1_asc_" + SetCount) {
                $(".departmix1_" + SetCount).css("display", "none");
                $(".arrivmix1_" + SetCount).css("display", "block");
                $(".pricemix1_" + SetCount).css("display", "none");
            }

            tinysort('.clsAvailSet00' + SetCount + ' .groupAvailroot',
                {
                    data: dataprop,
                    order: ordr
                });
            strflg = 0;

        }
    }


    $("#btnNextgds").on('click', function (e) {

        var dep = "";
        if ($("#hdtxt_trip")[0].value != "M") {
            if (FLAG == "M") {
                dep = departuredate;
            }
            else {
                dep = $("#txtdeparture").val();
            }


            var currentDate = $("#hdtxt_depa_date")[0].value;
            var ArrivalCurrentDate = $("#hdtxt_Arrivedate")[0].value;
            var day = currentDate.split('/');
            var newdate = moment([day[2], day[1] - 1, day[0]]).add(1, 'days').format("DD/MM/YYYY");
            var ardate = $("#hdtxt_trip")[0].value == "R" || $("#hdtxt_trip")[0].value == "Y" ? ArrivalCurrentDate : "-";
            var arrivaldate = ArrivalCurrentDate.split('/');
            var newArrivaldate = moment([arrivaldate[2], arrivaldate[1] - 1, arrivaldate[0]]).add(1, 'days').format("DD/MM/YYYY");
            if (FLAG != "M") {
                $("#txtdeparture").val(newdate != "Invalid date" ? newdate : dep);
                $("#txtarrivaldate").val(newdate != "Invalid date" ? newArrivaldate : ArrivalCurrentDate);
                $("#btnFmodifySearch").click();
                dataproperty_array = [];
                extrahidem_dataproperty_array = [];
                groparr = [];
                groupmain_array = [];
                groupmain_ret = [];
                filterdarray = [];
                var obj1 = {
                    count: 0,
                    setcount: 0
                };
                Main_totalfilterdarray = [];
                Main_totalfilterdarray_ret = [];
                $(".airfilterallcheck").html("");
                $("#airline_matrixhtml").html("");
                allAIRLINECode = "";
                searchgds();
            }
            else {
                departuredate = newdate != "" ? newdate : dep;
                arrivaldate = newdate != "" ? newArrivaldate : ArrivalCurrentDate;
                search();
            }

        }
    });

    $("#btnPrevgds").on('click', function (e) {

        var dep = "";
        if ($("#hdtxt_trip")[0].value != "M") {

            if (FLAG == "M") {
                dep = departuredate;
            }
            else {
                dep = $("#txtdeparture").val();
            }
            var currentDate = $("#hdtxt_depa_date")[0].value;
            var ArrivalCurrentDate = $("#hdtxt_Arrivedate")[0].value;
            var day = currentDate.split('/');
            var newdate = moment([day[2], day[1] - 1, day[0]]).subtract(1, 'days').format("DD/MM/YYYY");
            var ardate = $("#hdtxt_trip")[0].value == "R" || $("#hdtxt_trip")[0].value == "Y" ? ArrivalCurrentDate : "-";
            var arrivaldate = ArrivalCurrentDate.split('/');
            var newArrivaldate = moment([arrivaldate[2], arrivaldate[1] - 1, arrivaldate[0]]).subtract(1, 'days').format("DD/MM/YYYY");
            if (FLAG != "M") {
                $("#txtdeparture").val(newdate != "Invalid date" ? newdate : dep);
                $("#txtarrivaldate").val(newdate != "Invalid date" ? newArrivaldate : ArrivalCurrentDate);
                $("#btnFmodifySearch").click();
                dataproperty_array = [];
                extrahidem_dataproperty_array = [];
                groparr = [];
                groupmain_array = [];
                groupmain_ret = [];
                filterdarray = [];
                var obj1 = {
                    count: 0,
                    setcount: 0
                };
                Main_totalfilterdarray = [];
                Main_totalfilterdarray_ret = [];
                $(".airfilterallcheck").html("");
                $("#airline_matrixhtml").html("");
                allAIRLINECode = "";
                searchgds();
            }
            else {
                departuredate = newdate != "" ? newdate : dep;
                arrivaldate = newdate != "" ? newArrivaldate : ArrivalCurrentDate;
                search();
            }


        }
    });


</script>
