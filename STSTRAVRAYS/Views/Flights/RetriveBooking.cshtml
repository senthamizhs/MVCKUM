@{
    ViewBag.Title = "RetrieveBooking";
    string TerminalType = Session["TERMINALTYPE"] != null && Session["TERMINALTYPE"].ToString() != "" ? Session["TERMINALTYPE"].ToString() : System.Configuration.ConfigurationManager.AppSettings["TerminalType"].ToString();
    string GST = System.Configuration.ConfigurationManager.AppSettings["GST"].ToString();
    string strProduct = System.Configuration.ConfigurationManager.AppSettings["Producttype"].ToString();
    string StrVersion = System.Configuration.ConfigurationManager.AppSettings["updateversion"] != null ? System.Configuration.ConfigurationManager.AppSettings["updateversion"].ToString() : "";
    string PNRFlag = System.Configuration.ConfigurationManager.AppSettings["PNRlbl"].ToString();
    string ClientID = Session["POS_ID"] != null ? Session["POS_ID"].ToString() : "";
    string BranchID = Session["branchid"] != null ? Session["branchid"].ToString() : "";
    string APP_Terminal = Session["TERMINALTYPE"] != null && Session["TERMINALTYPE"].ToString() != "" ? Session["TERMINALTYPE"].ToString() : System.Configuration.ConfigurationManager.AppSettings["TerminalType"].ToString();
    string strImageURL = System.Configuration.ConfigurationManager.AppSettings["LogoUrl"].ToString();
    string strLoaderURL = strImageURL + "/" + strProduct + "/" + "loader.gif?" + StrVersion;
}

<link href="~/Content/CSS/daterangepicker-bs3.css?@StrVersion" rel="stylesheet" />
@if (strProduct == "RBOA")
{
    <link href="~/Content/CSS/Riya_BOA/riya_boa.css?@StrVersion" rel="stylesheet" /> @*1127*@
}
<script src="~/js/daterangepicker.js?@StrVersion"></script>
<script src="~/js/CommonJS/bootstrap-typeahead.js?@StrVersion"></script>
<style>
    .table > tbody > tr > td, .table > tbody > tr > th,
    .table > tfoot > tr > td, .table > tfoot > tr > th,
    .table > thead > tr > td, .table > thead > tr > th {
        border-top: none !important;
        vertical-align: middle !important;
        padding: 5px;
    }

    .table > thead > tr > th {
        text-transform: none !important;
    }

    .table > thead > tr > th {
        color: white !important;
    }

    .udk-guest-ref-option:disabled {
        cursor: not-allowed;
    }

    .clsthmail {
        font-size: 12px;
        float: left;
    }
    /*.clstyphead p {font-size: 12px;}*/
    .clstyphead p {
        font-size: 12px;
        float: left;
        width: 100%;
    }

    .clsgrey {
        background-color: #f4f4f4 !important;
    }

    .clswite {
        background-color: white !important;
    }

    .clsthright {
        float: right;
        padding: 0px 5px;
        border: 1px solid #eee;
        border-radius: 2px;
        font-size: 12px;
        margin-right: 15px;
        font-weight: 600;
    }

    .dropdown-menu {
        width: auto !important;
    }

    .clsthright {
        padding: 0px;
        font-size: 12px;
    }

    .disabledclass {
        cursor: not-allowed;
    }

    .chosen-container-single .chosen-single {
        height: 35px;
    }

    .disvalue, .plbvalue, .markvalue {
        text-align: right;
        padding: 7px;
    }

    .color-red-udk {
        color: red;
    }

    .clsdiv2 {
        padding: 10px 10px 1px 30px;
        text-align: center;
        background-color: #fff;
    }

    .cltblfare {
        width: 100%;
        font-size: 13px;
    }

    .clstdleft {
        width: 45%;
        font-size: 12px;
        text-align: center;
    }

    .clstdrt {
        width: 10%;
        text-align: left;
    }

    table {
        font-size: 12px;
        border-collapse: collapse;
    }

    .clsSelected {
        background-color: lightgrey;
        color: #000;
    }

    .clsunSelected {
        background-color: #fff;
        color: #000;
    }

    label, input, button, select, textarea {
        font-size: 12px;
        font-weight: normal;
        line-height: 20px;
    }

    label {
        display: block;
        margin-bottom: 5px;
    }

    .clsdvfirst {
        position: absolute;
        top: 0px;
        bottom: 0px;
        width: 2px;
        background: rgb(234, 34, 47);
        right: -2px;
    }

    #popup_fare {
        display: none;
        background: none repeat scroll 0 0 #FFFFFF;
        border: 1px solid #CCCCCC;
        border-radius: 3px;
        color: #333333;
        font-size: 12px;
        left: 20%;
        position: fixed;
        top: 5%;
        z-index: 1001;
        background-color: #fff;
        border-bottom: 3px solid #e42626;
        border-radius: 0 0 5px 5px;
        box-shadow: 0 2px 5px #000;
        padding: 10px !important;
        outline: none;
        box-sizing: border-box;
        text-align: center;
        color: #242424;
        list-style-image: none;
        list-style-type: disc;
        list-style: none;
        visibility: visible !important;
        font-size: 13px;
        line-height: 18px;
        content: " ";
        clear: both;
    }

    #modal-FarePopup, #modal-TicketingPopup {
        border-bottom: 3px solid #27a5f5;
    }

    .Queue-ticketing-header-udk {
        letter-spacing: 0.5px;
        font-weight: 600;
        margin: 0px;
        color: #333;
        padding: 15px 15px 0px;
        font-size: 15px;
        line-height: 33px;
    }

    .RadioSelected {
        width: 20px;
        background-color: #59c55a;
        border: 3px #666 solid;
        height: 20px;
        box-shadow: 0px 0px 0px 3px white inset;
    }

    .RadioDeselected {
        width: 16px;
        border: 3px #666 solid;
        height: 16px;
        cursor: pointer;
        background-color: #fff;
    }

    #table1 th, #table1 td,
    #table2 th, #table2 td,
    #table3 th, #table3 td,
    #table5 th, #table5 td, #table6 th, #table6 td {
        text-align: center;
        padding: 5px;
        width: 10%;
        font-size: 12px;
        border-right: 1px solid #eee;
    }

    #table4 th, #table4 td {
        white-space: nowrap;
        border-right: 1px solid #e2e2e2;
        text-align: center;
    }

    #table1 {
        border: 1px solid #ccc;
    }

    .ticked-pnr {
        color: #ff6600;
        padding: 3px;
        border-radius: 3px;
        border: 1px dashed #ff6600;
    }

        .ticked-pnr:hover {
            color: #fff;
            background: #ff6600;
            padding: 5px;
            border-radius: 3px;
            border: 1px dashed #fff;
        }

    .udk-clsretriv-details {
        margin-top: 3%;
        margin-bottom: 1%;
    }

    .typeahead {
        width: auto !important;
    }

    .txt-anim {
        padding: 4px !important;
    }

    .tabheaderflg {
        background: #fff !important;
        color: #333 !important;
        text-align: left !important;
        border-bottom: 2px solid #666;
    }

    label input[type="radio"] ~ i.fa.fa-square-o {
        color: #c8c8c8;
        di splay: inline;
    }

    label input[type="radio"] ~ i.fa.fa-check-square-o {
        display: none;
    }

    label input[type="radio"]:checked ~ i.fa.fa-square-o {
        display: none;
    }

    label input[type="radio"]:checked ~ i.fa.fa-check-square-o {
        color: #8d0523;
        display: inline;
    }

    label:hover input[type="radio"] ~ i.fa {
        color: #7AA3CC;
    }

    div[data-toggle="buttons"] label.active {
        color: #7AA3CC;
    }

    div[data-toggle="buttons"] label {
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 12px;
        font-weight: normal;
        line-height: 2em;
        text-align: left;
        white-space: nowrap;
        vertical-align: top;
        cursor: pointer;
        background-color: none;
        border: 0px solid #c8c8c8;
        border-radius: 3px;
        color: #c8c8c8;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        -o-user-select: none;
        user-select: none;
    }

        div[data-toggle="buttons"] label:hover {
            color: #7AA3CC;
        }

        div[data-toggle="buttons"] label:active,
        div[data-toggle="buttons"] label.active {
            -webkit-box-shadow: none;
            box-shadow: none;
        }

    label.focus {
        outline: none !important;
    }

    .modal-header .close {
        margin-top: 8px;
        color: #030303;
        opacity: 0.5;
        background: #fff;
        border-radius: 50%;
        padding: 9px 6px 14px 6px;
        line-height: 0px;
        margin-right: 10px;
        transition: all 0.35s ease-in-out;
    }

    .modal-header {
        padding: 0px;
    }

    .farecomp-tit {
        background: #27a5f5;
        color: #fff;
        text-transform: capitalize;
        letter-spacing: 0px;
        font-size: 18px;
        padding: 8px 15px;
        border-radius: 5px 5px 0 0px;
    }

    .c-button.bg-aqua {
        border: 2px solid #27a5f5;
        color: #fff;
        cursor: pointer;
    }

    .bg-aqua {
        background: #27a5f5;
    }

    a, .c-button, .investor-logo img, .filter-nav a:before,
    .photo-next, .photo-prev, .contry-item h5,
    .slider-wth-thumbs.style-1 .thumbnails img {
        -webkit-transition: all 0.35s ease-in-out;
        -moz-transition: all 0.35s ease-in-out;
        -o-transition: all 0.35s ease-in-out;
        transition: all 0.35s ease-in-out;
    }

    .c-button {
        width: 100%;
        position: relative;
        display: inline-block;
        -moz-border-radius: 8px;
        border-radius: 4px;
        text-align: center;
        font-size: 12px;
        text-transform: uppercase;
        line-height: 28px;
        font-weight: 500;
    }

        .c-button.bg-aqua:hover {
            color: #27a5f5;
        }

        .c-button.hv-transparent:hover {
            background: #fff;
            text-decoration: none;
        }

    .bStyle {
        margin: 10px 0 0 0;
        letter-spacing: 1px;
        font-weight: normal;
        color: #1b5075;
        font-family: Calibri,Nina,Arial !important;
        background-color: #eee;
        padding: 8px 15px;
        font-size: 17px;
    }

    .container-fluid {
        padding: 15px 80px 48px;
        position: relative;
        margin-left: 20px;
    }

    .clsFareruleSelect {
        font-size: 15px;
        cursor: pointer;
        font-weight: bold;
        border: 1px solid #a9a9a9;
        padding: 5px 10px;
        background: #d3d3d3;
        color: #000;
        float: left;
        background-color: #d3d3d3;
        color: #000000;
        border-color: #a9a9a9;
    }

    .clsSgFareRule {
        width: 100%;
        float: left;
        padding-top: 10px;
        border: 1px dashed #a9a9a9;
        padding-left: 5px;
        color: #000 !important;
        background: #d3d3d3;
        padding-right: 5px;
    }

    .clsRuleHead {
        width: 100%;
        font-size: 12px;
        font-weight: bold;
        padding: 10px 0px;
        color: #000;
        cursor: pointer;
    }

    .clsFaretextArea:read-only {
        width: 100%;
        border: #fff;
        color: black;
        background: #efefef;
        display: none;
    }

    .clsFaretextArea {
        width: 100%;
        border: #fff;
        color: black;
        background: #efefef;
        display: none;
    }

    pre {
        display: block;
        padding: 9.5px;
        margin: 0 0 10px;
        font-size: 13px;
        line-height: 1.42857143;
        color: #333;
        word-break: break-all;
        word-wrap: break-word;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .clsSpanText {
        width: 100%;
        float: left;
        color: black;
        padding: 10px;
        font-size: 14px;
        font-family: serif;
        border: 1px dashed #b5b4b4;
        margin-top: 21px;
        word-wrap: break-word;
        white-space: pre-wrap;
        background: #fff;
        word-break: keep-all;
    }

    .clscenter {
        text-align: center;
    }

    .scroll-fix {
        margin: 0px !important;
        overflow-x: auto !important;
    }

    .clsnone {
        display: none;
    }

    .clsblock {
        display: block;
    }

    .ui-datepicker {
        z-index: 100001 !important;
    }

        .ui-datepicker .ui-datepicker-buttonpane {
            display: none;
        }

    @@media (max-width:768px) {
        .udk-clsretriv-details {
            margin-top: 8%;
            margin-bottom: 1%;
        }
    }

    @@media only screen and (max-width: 767px) {
        .dv-anim.input-effect.animationdive {
            float: left;
            width: 100%;
            margin-bottom: 25px !important;
        }
    }

    .clsfarecode {
        font-size: 12px;
        color: #16324a;
        font-weight: 600;
        padding: 1px 10px;
        border: 1px dashed #16324a;
        border-radius: 3px;
    }

    #_M_riyaboa {
        background-color: #f2f2f2 !important;
    }

    .AgentLabel, #Agentamount {
        float: left;
        width: 100%;
    }

    /*.slidedet {
        width: 25px;
        height: 25px;
        color: white;
        background: red;
        border-radius: 50%;
        font-size: 18px;
        cursor: pointer;
        text-align: center;
    }*/

    .slidedet {
        text-align: center;
        border-radius: 20px;
        background: #f83d3d;
        color: #fff;
        padding: 4px 0;
        cursor: pointer;
    }

        .slidedet i {
            font-size: 14px;
        }


    .table > thead > tr > th {
        background-color: #b60725 !important;
        color: #FFF !important;
    }

    #modal-alert {
        z-index: 1000000000 !important;
    }
</style>


<div class="container mobNoContainerd">

    <div id="dvAgentnotauth" style="flex-align: center; margin: 20px auto; display: none;">
        <img alt="" style="width: 80%;" id="img1" src="@Url.Content("~/Images/Not-Support.png")" />
    </div>
    <div class="row" id="retriveinformation">
        <div class="col-lg-12 mt-5p" style="margin-top: 2%; border-radius: 4px; padding-top: 15px; padding-bottom: 10px;">
            <div class="panel">
                <div class="panel-heading-re">
                    <div id="_queueticketing">

                        <h4 class="Queue-ticketing-header-udk">
                            <em class="spritepage" style="display: none;"><span class="sprit_retbk"></span></em>
                            <i class="fa fa-object-ungroup" aria-hidden="true" style="padding-right: 6px;"></i>Retrieve Booking / Ticketing & Accounting
                            @*@if (TerminalType == "W")
                                {
                                    <span id="dvshowmoreicn" style="float: right;">
                                        <span style="width:25px;height:25px;color: white;background: red;position: absolute;border-radius: 50%;font-size:   18px;cursor: pointer;margin-left: -5%;text-align: center;" onclick="showretrievedetails();">
                                            <i id="dvshowicon" class="fa fa-angle-double-down" aria-hidden="true"></i>
                                        </span>
                                    </span>
                                }*@
                            @if (strProduct.ToUpper().Trim() == "RIYA" && TerminalType != "T")
                            {
                                <span class="row row0 brd_bd" style="float:right">
                                    <span style="font-size: 12px;">Credit Balance</span>
                                    <span>Rs.</span><span id="txtCreditBalance"></span>
                                </span>
                            }
                        </h4>


                    </div>
                </div>
                <div class="panel-body">
                    <div class="row udk-clsretriv-details">
                        <div class="col-lg-12">
                            <div class="">
                                <div class="col-lg-12 col0 col-xs-12">
                                    <div class="row row0">
                                        <div class="col-lg-2 col-md-3 col-xs-12 input-effect mrgbtm20" style="display: none;">
                                            <label for="" class="colrcls" style="margin-top: -15px;">Airline Category<span class="color-red-udk">*</span></label>
                                            <div class="row row10">
                                                <div class="col-xs-6 col0" style="text-align: center; width: 50%;">
                                                    <input type="radio" name="AirCategory" id="rdoaircat_FSC" style="float: left;" checked="checked" onclick="checkcatogory(0);" class="has-content">
                                                    <label for="rdoaircat_FSC" style="float: left; padding: 0px 10px; cursor: pointer;">FSC</label>
                                                </div>
                                                <div style="text-align: center; width: 50%;"
                                                     class="col-xs-6 col0">
                                                    <input type="radio" name="AirCategory" id="rdoaircat_LCC" style="float: left;" onclick="checkcatogory(1);">
                                                    <label for="rdoaircat_LCC" style="float: left; padding: 0px 10px; cursor: pointer;">LCC</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-md-3 col-xs-12 input-effect udk-Category-cls mrgbtm20">
                                            <input type="text" class="txt-anim clshideErr losefocus" id="txt_CRSpnr_Queue" maxlength="7" onkeypress="javascript:return ValidateAlphaNumeric(event);" autocomplete="off" style="width: 100%; text-transform: uppercase">
                                            <label for="txt_CRSpnr_Queue" class="colrcls">CRS PNR <span class="color-red-udk">*</span></label>
                                        </div>
                                        <div class="col-lg-2 col-md-3 col-xs-12 input-effect mrgbtm20" style="display: none;">
                                            <select class="txt-anim clshideErr losefocus has-content" id="ddl_QueueAT" style="padding: 0 6px !important; width: 100%;" onchange="changeairline();">
                                                <option value="-1">--Select--</option>
                                                <option value="D">Domestic</option>
                                                <option value="I">International</option>
                                            </select>
                                            <label class="colrcls" for="ddl_QueueAT">Airport Type <span class="color-red-udk">*</span></label>
                                        </div>
                                        <div class="col-lg-2 col-md-3 col-xs-12 input-effect udk-Airline-cls mrgbtm20">
                                            <select class="txt-anim clshideErr losefocus has-content" id="ddl_QueueStock" style="padding: 0 6px !important; width: 100%;" onchange="Queuechange()">
                                                <option value="-1">--Select--</option>
                                            </select>
                                            <label class="colrcls" for="ddl_QueueStock">CRS Name <span class="color-red-udk">*</span></label>
                                        </div>
                                        <div class="col-lg-2 col-md-2 col-xs-12 input-effect load-queue-no mrgbtm20" style="display: none;">
                                            @*RB25*@
                                            <input type="text" class="txt-anim clshideErr losefocus" id="txt_CRSpnr_QueueNO" maxlength="7" onkeypress="javascript:return isNumericVal(event);" autocomplete="off" style="width: 100%; text-transform: uppercase" />
                                            <label for="txt_CRSpnr_QueueNO" class="colrcls">QUEUE No.<span class="color-red-udk">*</span></label>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-xs-12 input-effect dvagencyname mrgbtm20" id="dvNormalSearch">
                                            @* <select class="txt-anim clshideErr losefocus has-content" id="ddlclient" onchange="clearretrievepnr();" style="padding: 0 6px !important; width: 100%;"></select>*@
                                            @* <option value="-1">--Select--</option>*@
                                            <input class="txt-anim clshideErr losefocus has-content ui-autocomplete-input" autocomplete="off" type="text" id="ddlclient" />
                                            <label class="colrcls" for="ddlclient">Agency Name <span class="color-red-udk">*</span></label>
                                        </div>
                                    </div>

                                    <div class="row row0" style="margin-top: 20px">
                                        <div class="col-lg-2 input-effect mrgbtm20" style="display: none;">
                                            <select class="txt-anim clshideErr losefocus has-content" id="ddl_Faretype" style="padding: 0 6px !important; width: 100%;">
                                                <option value="">--Select--</option>
                                                <option value="N">Normal Fare</option>
                                                <option value="C">Corporate Fare</option>
                                                <option value="R">Retail Fare</option>
                                                <option value="E">E-Coupon Fare</option>
                                                <option value="S">SpecialFare</option>
                                            </select>
                                            <label class="colrcls" for="ddl_Faretype">Fare Type <span class="color-red-udk">*</span></label>
                                        </div>

                                        <div class="col-sm-4 hidden-xs"></div>
                                        <div class="col-xs-6 col-sm-2">
                                            <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="" onclick="RetrievePnr()" style="height: 35px; padding: 3px 0px;"><span>Retrieve </span><i class="fa fa-angle-double-down" style="padding-left: 5px;"></i></a>@*1122*@
                                        </div>

                                        <div class="col-xs-6 col-sm-2">
                                            <a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="" onclick="BtnQueueOk_Clear()" style="height: 35px; padding: 3px 0px;"><span>Clear</span><i class="fa fa-angle-double-down" style="padding-left: 5px;"></i></a> @*1122*@
                                        </div>
                                        <div class="col-sm-offset-3 col-xs-6 col-sm-1" id="dvshowmoreicn" style="display:none;">
                                            <div class="slidedet" onclick="showretrievedetails();">
                                                Slide&nbsp;<i id="dvshowicon" class="fa fa-angle-double-down" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>
                                    @if (strProduct == "DEIRA")
                                    {
                                        <div class="col-sm-12" id="" style="margin-top:20px;display:block;">
                                            <div class="col-sm-12 col-xs-12 retrieve_cmmnt">
                                                <ul>
                                                    <li>
                                                        <i class="fa fa-check"></i>Create a booking as per your CRS.
                                                    </li>                                                    
                                                    <li>
                                                        <i class="fa fa-check"></i>Queue the booking to PCC
                                                    </li>
                                                    <li>
                                                        <i class="fa fa-check"></i>Enter the PNR and select the GDS

                                                    </li>
                                                    <li>
                                                        <i class="fa fa-check"></i>Retrieve the booking with fares.
                                                    </li>
                                                    <li>
                                                        <i class="fa fa-check"></i>Verify the fare and issue the ticket.
                                                    </li>
                                                </ul>
                                                @*<div class="float-left w-100 notesec">
                                                    <span class="float-left w-100 mrgn-btm-10">Note:</span>
                                                    <p class="float-left w-100 fmt-wt-600 font-13">
                                                        If you save multiple fare quote for Saber PNR, multiple ticket number will be generated Deira Travel, will not take
                                                        responsibility of multiple ticket number for the same passengers.
                                                    </p>
                                                </div>*@
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>

                            <div class="row row0 clscheckfarehide">
                                <div class="row row10 udk-faretype-show" style="display: none;">
                                    <div class=" col-lg-offset-9 col-lg-3" style="text-align: right;">
                                        <span>
                                            Booking Fare Type :<span style="color: #59c55a; font-size: 12px; font-weight: 600;" id="spnfareType">Normal Fare</span>
                                        </span>
                                    </div>
                                </div>

                                <div id="dv_avail" class="wholeclassdiv" style="margin-top: 0px;">
                                    <div class="dv_width"><span id="sp_pnr_details"></span></div>
                                </div>

                                @if (GST == "Y")
                                {
                                    <div class="row row10 wholeclassdiv" id="loadGstDetails" style="display: none;">
                                        <div class="col-xs-12 col10" id="divGstDetails">
                                            <div class="row row10">
                                                <div class="col-xs-12 commonadvancesearch">
                                                    <h4 class="bStyle">
                                                        <i class="fa fa-money" style="padding-right: 6px;"></i>GST Details
                                                        <input style="display: none;" id="allow_gst" class="cb" onclick="return Allowgst();" type="checkbox" name="allow_gst" />
                                                        <label class="cbx" for="allow_gst" style="display: inline-block;"></label>
                                                    </h4>
                                                    <hr style="margin-top: 5px; margin-bottom: 10px; border-bottom: 1px dashed #ddd; display: none;" />
                                                    <div id="gst_details" style="display: none;">
                                                        <table class="table table-responsive no-more-tables" style="color: white;">
                                                            <thead style="border: 1px solid #ccc;">
                                                                <tr>
                                                                    <th>State</th>
                                                                    <th>GST Number</th>
                                                                    <th style="white-space: nowrap;">Company Name</th>
                                                                    <th>GST Address </th>
                                                                    <th>Email id </th>
                                                                    <th style="white-space: nowrap;">Mobile Number</th>
                                                                    <th style="white-space: nowrap;" id="thstate">State Code</th>
                                                                    <th style="white-space: nowrap;" id="thcity">City Code</th>
                                                                    <th style="white-space: nowrap;" id="thpin">Pin Code</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody style="background-color: #fff; border: 1px solid #cccccc;">
                                                                <tr>
                                                                    <td data-title="State">
                                                                        <select class="form-control" id="ddlgststate" onchange="Changeddlretrievegststate()">
                                                                            @*//onchange="Changeddlgststate()"*@
                                                                        </select>
                                                                    </td>
                                                                    <td data-title="Number">
                                                                        <input type="text" class="form-control clspstAlphaNumaric clsgstclr" id="txtgstNumber" maxlength="15" onkeypress="javascript:return ValidateAlphaNumeric(event);">
                                                                    </td>
                                                                    <td data-title="Company Name">
                                                                        <input type="text" class="form-control clspstAlphaWithSpace clsgstclr" id="txtgstCompanyname" maxlength="50">
                                                                    </td>
                                                                    <td data-title="Address">
                                                                        <textarea id="txtgstAddress" class="form-control clsgstclr" maxlength="250" style="height: 35px;"></textarea>
                                                                    </td>
                                                                    <td data-title="Email id">
                                                                        <input type="text" class="form-control clsgstclr" id="txtgstEmailid" maxlength="50" autocomplete="new-password" />
                                                                    </td>
                                                                    <td data-title="Mobile Number">
                                                                        <input type="text" class="form-control clspstnumeric clsgstclr" id="txtgstMobileNumber" maxlength="13"
                                                                               onkeypress="javascript:return isNumericVal(event);">
                                                                    </td>
                                                                    <td data-title="State Code">
                                                                        <input type="text" class="form-control clspstnumeric clsgstclr" id="txtgstStatecode" maxlength="13"
                                                                               onkeypress="javascript:return ValidateAlpha(event);">
                                                                    </td>
                                                                    <td data-title="City Code">
                                                                        <input type="text" class="form-control clspstnumeric clsgstclr" id="txtgstCitycode" maxlength="13"
                                                                               onkeypress="javascript:return ValidateAlphaNumeric(event);">
                                                                    </td>
                                                                    <td data-title="Pin Code">
                                                                        <input type="text" class="form-control clspstnumeric clsgstclr" id="txtgstpinecode" maxlength="13" onpaste="pastenumbervalidation(this)"
                                                                               onkeypress="javascript:return isNumericVal(event);">
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }

                                <div class="row row0 wholeclassdiv" id="dvFrequentFlyer" style="display: none;"></div>

                                <div class="row row10 udk-totalfare-show" style="display: none;">
                                    <div class="col-lg-offset-9 col-lg-3" style="text-align: right; margin-top: 20px;">
                                        <span style="padding: 10px; font-weight: 600; font-size: 13px; color: #666565;">Total Gross Fare : <span style="color: #000; font-size: 18px; font-weight: 600;" id="spnTotalgrossfare">0</span> <span id="spnCurrency" class="appcurrency"></span></span>@*1127*@
                                    </div>
                                </div>
                                <div class="row row10 wholeclassdiv" id="dv_row1" style="margin-top: 20px; display: none;margin-bottom: 5%;">
                                    <div class="col-sm-3 col-xs-12 input-effect udk-corporate-code">
                                        <input id="txt_corporateCode" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px;" class="txt-anim clshideErr losefocus has-content" type="text" maxlength="20" autocomplete="off" />
                                        <label for="txt_corporateCode" class="colrcls">Corporate Code <span class="color-red-udk"></span></label>
                                        <span id="spnCorporatecodemsg" style="color: red; font-size: 12px; font-style: italic; display: none;">Note : If the fare priced with code, Kindly enter the respective code and do the ticketing.</span>
                                    </div>
                                    <div class="col-xs-12 col-sm-3 input-effect">
                                        <input id="txtEndorsement" style="height: 34px;" class="txt-anim clshideErr losefocus has-content" type="text" maxlength="100" autocomplete="off" />
                                        <label for="txtEndorsement" class="colrcls">Endorsement</label>
                                    </div>
                                    <div class="col-sm-2 input-effect udk-office-id">
                                        <select class="txt-anim clshideErr losefocus has-content" id="ddl_OfficeID" style="padding: 0 6px !important; width: 100%;"></select>  @*onchange="ShowPccdetails();"*@
                                        <label class="colrcls" for="ddl_OfficeID">Office ID <span class="color-red-udk">*</span></label>
                                    </div>
                                    <div class="col-xs-12 col-sm-2 input-effect">
                                        @if (APP_Terminal == "T")
                                        {
                                            <select class="txt-anim clshideErr losefocus has-content" id="ddl_platingcarrier" style="padding: 0 6px !important; width: 100%;"></select>
                                            <label class="colrcls" for="ddl_platingcarrier">Plating carrier</label>
                                        }
                                    </div>
                                    <!--<div class="col-xs-12 col-sm-2" id="dvdirectbooking" style="display: none;">
                                        @* clearfaredetails()col-sm-offset-1 <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="btn_DirectBook" onclick="DirectBooking();" style="height: 35px; padding: 1px;"><span>Ticketing</span></a>*@
                                    </div>-->
                                    <div class="col-xs-12 col-sm-2" style="float: right;">
                                        @*onclick="LoadPaymentPopup(1)" ConfirmFOP() <input id="btn_getfare" style="width: 150px;" type="button" class="c-button b-50 bg-aqua hv-transparent" value="Check Fare" onclick="javascript: return Get_Fare();" />*@
                                        <a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btn_getfare" onclick="LoadPaymentPopup(1);" style="height: 35px; padding: 1px;"><span>Check Fare</span></a>
                                    </div>
                                    <div class="col-xs-12 col-sm-offset-1 col-sm-10" style="display:none;margin-top:2%;" id="dvPccDetails">
                                        <h5 class="bStyle">PCC Details</h5>
                                        <div style="overflow:auto;" id="dvtablePcc"></div>
                                    </div>
                                </div>
                            </div>

                            <div id="dvBookdata" class="row clsfaredetails" style="display:none;">
                                @*  <div class="flight-form-wrap m-b-20" id="previewflightdet"></div>STS-166  scrollbar*@
                                @*<div class="fltcont-sec m-b-20 flt-lft width100">
                                    <div class="col-sm-12 flttit">
                                    <span><img src="~/Images/FlightSegment.png" style="width:30px;" />&nbsp;&nbsp;Flight Details</span>
                                               </div>
                                                <div class="flt-lft width100" id="previewflightdet"></div>
                                            </div>*@
                                <div class="col-md-12">
                                    <div class="col-md-12">
                                    <div class="bStyle col-md-12">
                                        <div class="col-md-6"><i class="fa fa-money" style="padding-right: 6px;"></i>Fare Details</div>
                                        <div class="col-md-3" style="font-size: 14px ! Important;color: #000;"><span>PNR Owner PCC : <span id="spnPNFOfficeID"></span></span></div>
                                        <div class="col-md-3"><span style="float: right;color:red;">Supplier Commission : <span id="spnSuppComm"></span> %</span></div>

                                    </div>
                                    <div class="row" id="dv_farDetails"></div>
                                    @*<div class="row">
                                            <div class="col-lg-3 col-xs-6 col-lg-offset-3" style="text-align: right; margin-top: 1%;">
                                                <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="btnConfirm" onclick="ConfirmFare()" style="height: 35px; padding: 3px 0px;"><span>Ok</span></a>
                                            </div>
                                            <div class="col-lg-3 col-xs-6" style="text-align: left; margin-top: 1%">
                                                <a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btncancel" data-izimodal-close data-izimodal-transitionout="bounceOutDown" onclick="hideFarepopup(0)" style="height: 35px; padding: 3px 0px;"><span>Cancel</span></a>
                                            </div>
                                        </div>*@
                                </div>
                                <div class="col-md-12" id="dvSelectedpax" style="display:none;">
                                    <h4 class="bStyle"><i class="fa fa-money" style="padding-right: 6px;"></i>Edit Earnings</h4>
                                    <div id="dvSelectedCommdetails" style="width:100%;"></div>
                                </div>
                                <div class="col-sm-3 col-xs-12 input-effect tourclass" style="margin-top: 20px;display: none;">
                                    <input id="txt_PricingCode" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px;" class="txt-anim clshideErr losefocus has-content" type="text" maxlength="15" autocomplete="off">
                                    <label for="txt_PricingCode" class="colrcls">Tour Code <span class="color-red-udk"></span></label>
                                    <span id="spnPricingcodemsg" style="color: red; font-size: 12px; font-style: italic; display: none;">Note : If the fare priced with code, Kindly enter the respective code and do the ticketing.</span>
                                </div>
                                <div class="col-sm-3 col-xs-12 input-effect Approvalclass" style="margin-top: 20px;display: none;">
                                    <select id="txt_ApprovedBY" style="height: 34px;width:100%;" class="txt-anim clshideErr losefocus has-content" autocomplete="off"></select>
                                    <label for="txt_ApprovedBY" class="colrcls">Approved By <span class="color-red-udk"></span></label>
                                </div>
                                <div class="col-md-offset-2 col-md-2 col-xs-12 chkclass" style="margin-top: 20px;">
                                    <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="btnConfirm" onclick="ConfirmFare()" style="height: 35px; padding: 3px 0px;"><span>Confirm Fare</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12 " id="divPrintOptIconvpnr1" style="display: none; position: relative; top: 70px;">
        <div>
            <i id="printtcktclose" class="fa fa-times-circle" style="font-size: 35px; float: right; color: black; cursor: pointer;"></i>
        </div>
        <div class="main-title" style="color: initial;">
            <i class="fa fa-print" aria-hidden="true" style="float: right; font-size: 25px; border: 1px solid; border-radius: 50%; padding: 2px 0px 3px 4px; cursor: pointer; color: #ff6600; margin-right: 15px;"
               id="iprinticon1" onclick="javascript: return PrintOption();"></i>
        </div>
    </div>
    <div id="Ticketsprintpagevpnr" style="background-color: #fff; display: none; margin-top: 6%;"></div>
</div>

<div class="row" id="loadTicket" style="display: none;">
    <div class="container">
        <div class="col-lg-12" id="print_mail_pdf" style="top: 104px; position: relative; z-index: 1;">
            <ul class="checkIssueTicket" style="text-align: right; float: right; padding-left: 0px; cursor: pointer; font-size: 15px;">
                <li style="position: relative; display: inline-block; padding: 0px 15px;">
                    <span id="btn_printticket" onclick="javascript: return RetrivePrintTicket();">
                        <i class="fa fa-print"></i>
                        <span style="position: relative;">Print</span>
                    </span>
                </li>
                <li style="position: relative; display: inline-block; padding: 0px 15px;">
                    <span id="btn_printMail" onclick="RetriveEmailPrintTicket()">
                        <i class="fa fa-envelope"></i>
                        <span style="position: relative;">Mail</span>
                    </span>
                </li>
            </ul>
        </div>
        <div class="col-lg-12" id="ticketPageDetails" style="background: #fff; margin-top: 1%; min-height: 400px; box-shadow: 0px 0px 1px 1px #ececec;">
        </div>
    </div>
</div>
</div>
<div id="modal-FarePopup" class="iziModal">
    @* <div id="dvBookdata" class="row" style="padding: 20px; padding-top: 2px; margin-bottom: 2px; background-color: #f2f2f2;">
            <div class="col-md-12">
                <div class="row" id="dv_farDetails" style="padding: 0px;"></div>
                <div class="row">
                    <div class="col-lg-3 col-xs-6 col-lg-offset-3" style="text-align: right; margin-top: 1%;">
                        <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="btnConfirm" onclick="ConfirmFare()" style="height: 35px; padding: 3px 0px;"><span>Ok</span></a>
                    </div>
                    <div class="col-lg-3 col-xs-6" style="text-align: left; margin-top: 1%">
                        <a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btncancel" data-izimodal-close data-izimodal-transitionout="bounceOutDown" onclick="hideFarepopup(0)" style="height: 35px; padding: 3px 0px;"><span>Cancel</span></a>
                    </div>
                </div>
            </div>
        </div>*@
    <div id="dvPaymentdata" class="row" style="padding: 10px 40px; display: none;">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-12" style="text-align: center;">
                    Your total ticket cost is <span class="appcurrency">-</span> <span id="spnPopupFare" style="text-decoration: none; font-weight: 600; font-size: 16px;"></span><a id="popupfare" style="text-decoration: none; font-weight: 600; font-size: 16px; display: none"></a>
                </div>
            </div>
            <div class="row" style="margin: 3%;">
                <div class="paymntdiv row row0" style="background: #f4f4f4;">
                    <div class="row row0" style="margin-bottom: 10px; margin-top: 0; padding: 8px 6px; background: #eceaea;">
                        <div class="col-sm-4 col-xs-12 col0 scrl-btm-line">
                            <h5 style="font-size: 13px !important; margin: 0px; font-weight: 600;">Payment details</h5>
                        </div>
                        <div class="col-sm-6 col-xs-12 col0 scrl-btm-line">
                            <h5 id="CRSFOP" style="margin: 0px; font-weight: 600;color:#b00002"></h5>
                        </div>
                    </div>
                    <div class="col-sm-offset-0 col-sm-9 paymentdynachangclss">
                        <div class="row row0" id="paymentdiv">
                            <div class="col-sm-12 col-xs-12 rowtop" style="padding-bottom: 2%;">
                                <div class="row row10" style="padding-bottom: 10px">
                                    <div class="col-sm-4 col-xs-5 col10 " style="text-align: right;">
                                        <span style="white-space: nowrap" class="hotel-loc clsPaymentMode">Payment Mode</span>
                                    </div>
                                    <div class="col-sm-1 col-xs-1 col10">:</div>
                                    <div class="col-sm-7 col-xs-6 col10" id="dvPayment">
                                        @*<select id="ddlPaymentMode" class="form-control" onchange="fetchpassthrough(this.id)">
                                                <option value="0" selected="selected">--Select--</option>
                                                <option value="C">Credit</option>
                                                <option value="B">Pass Through</option>
                                            </select>
                                                @if (ViewBag.Paymentdetails != null && ViewBag.Paymentdetails != "")
                                                {
                                                    string[] Paymentoptions = ViewBag.Paymentdetails.ToString().TrimEnd('~').Split('~');
                                                    string defaultselectpaymode = Paymentoptions.Count() == 1 ? "selected ='selected'" : "";
                                                    <select id="ddlPaymentMode" class="form-control" onchange="fetchpassthrough(this.id)">
                                                        <option value="0">--Select--</option>
                                                        @for (int k = 0; k < Paymentoptions.Count(); k++)
                                                        {
                                                            if (Paymentoptions[k] == "T")
                                                            {
                                                            <option value="T" @defaultselectpaymode>Topup</option>
                                                            }
                                                            if (Paymentoptions[k] == "B")
                                                            {
                                                            <option id='passthrough' value='B' @defaultselectpaymode>Pass&nbsp;Through</option>
                                                            }
                                                            if (Paymentoptions[k] == "P" && ViewBag.SpecialFlag != null && ViewBag.SpecialFlag.ToString() == "N" && ViewBag.SpecialFlag.ToString() != "M")
                                                            {
                                                            <option id='paymentgate' value='P' @defaultselectpaymode>Payment&nbsp;Gateway</option>
                                                            }
                                                            if (Paymentoptions[k] == "C")
                                                            {
                                                            <option value='C' @defaultselectpaymode>Credit</option>
                                                            }
                                                        }
                                                    </select>
                                                }*@
                                        <select id="ddlPaymentMode" class="form-control" onchange="fetchpassthrough(this.id)">
                                            <option value="0">--Select--</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row row10 rowtop">
                                    <div class="col-sm-4 col-xs-5 col10 " style="text-align: right;">
                                        <span class="hotel-loc" style="">Remarks</span>
                                    </div>
                                    <div class="col-sm-1 col-xs-1 col10">:</div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <textarea id="txtar_remarks" class="form-control" style="height: 60px !important"></textarea>
                                        <input type="hidden" id="hdfBooktype" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-9" id="divviewcarddetails" style="display: none;">
                        <div class="row row0" style="margin-bottom: 5%;">
                            <div class="col-sm-12" style="border: 2px solid #eee; box-shadow: 3px 1px 4px 1px #eee; padding: 14px 18px 8px 1px">
                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-12 col-xs-12 col10" style="text-align: left; float: left;">
                                        <span style="white-space: nowrap" class="hotel-loc clsPaymentMode"></span>
                                    </div>
                                </div>
                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">Card Type</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <select id="txtar_CardType" class="form-control">
                                            <option value="">--Select--</option>
                                            <option value="VISA(VI)">VISA</option>
                                            <option value="MASTERCARD(CA)">MASTERCARD</option>
                                            <option value="AMERICAN EXPRESS(AX)">AMERICAN EXPRESS</option>
                                            <option value="AIRPLUS(TP)">AIRPLUS</option>
                                            <option value="JCB(JC)">JCB</option>
                                            <option value="DINERS CLUB(DC)">DINERS CLUB</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">Bank Name</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <input type="text" id="txt_BankName" class="form-control" />
                                    </div>
                                </div>
                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">Holder Name</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <input type="text" id="txt_HolderName" class="form-control" />
                                    </div>
                                </div>
                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">Card No.</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <input id="txtar_cardNo" class="form-control" maxlength="25" onkeypress="javascript:return isNumericVal(event);" />
                                        @*<textarea id="txtar_cardNo" class="form-control" maxlength="25" onkeypress="javascript:return isNumericVal(event);"></textarea>*@
                                        <input type="hidden" id="hdfcardNo" value="BOOK">
                                    </div>
                                </div>

                                <div class="row row10 rowtop" style="padding: 3px;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">CVV.</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">
                                        <input type="password" id="txtar_cvv" class="form-control" maxlength="5" onkeypress="javascript:return isNumericVal(event);" />
                                    </div>
                                </div>
                                <div class="row row10 rowtop" style="padding-bottom: 3%;">
                                    <div class="col-sm-5 col-xs-6 col10 " style="text-align: center;">
                                        <span class="hotel-loc">Expiry Date</span>
                                    </div>
                                    <div class="col-sm-7 col-xs-6 col10 ">

                                        <div class="row">
                                            <div class="col-sm-7 col-xs-7" style="padding-right: 0px;">
                                                <select id="ddlMonth" class="form-control">
                                                    <option value="">--Select--</option>
                                                    <option value="01">January</option>
                                                    <option value="02">February</option>
                                                    <option value="03">March</option>
                                                    <option value="04">April</option>
                                                    <option value="05">May</option>
                                                    <option value="06">June</option>
                                                    <option value="07">July</option>
                                                    <option value="08">August </option>
                                                    <option value="09">September</option>
                                                    <option value="10">October</option>
                                                    <option value="11">November</option>
                                                    <option value="12">December</option>

                                                </select>
                                            </div>
                                            <div class="col-sm-5 col-xs-5" style="padding-left: 0px;">

                                                <select id="ddlyear" class="form-control">
                                                    <option value="">--Select--</option>
                                                    <option value="@ViewBag.ServerDateTime">@Convert.ToInt16(ViewBag.ServerDateTime)</option>
                                                    @for (int i = Convert.ToInt16(ViewBag.ServerDateTime); i < (Convert.ToInt16(ViewBag.ServerDateTime) + 50); i++)
                                                    {
                                                        <option value="@i">@Convert.ToInt16(i)</option>
                                                    }
                                                </select>

                                            </div>
                                            <input type="hidden" id="hdfMonthyear" value="BOOK">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="paymntdiv row row0" id="dvcashpayment" style="display:none;background: #f4f4f4;">
                    <div class="row row0" style="margin-bottom: 10px; margin-top: 0; padding: 8px 6px; background: #eceaea;">
                        <div class="col-xs-12 col0 scrl-btm-line">
                            <h5 style="font-size: 13px !important; margin: 0px; font-weight: 600;">Cash Payment details</h5>
                        </div>
                    </div>
                    <div class="row row0">
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Customer mobile<span style="color:red;">*</span></label>
                            <input autocomplete="off" class="form-control clsNumeric clsClear" id="txtcash_contactno" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" maxlength="10" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Customer Email</label>
                            <input autocomplete="off" class="form-control clsClear" id="txtcash_email" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Reference</label>
                            <input autocomplete="off" class="form-control clsClear" id="txtcash_Ref" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Date of payment<span style="color:red;">*</span></label>
                            <input autocomplete="off" class="form-control clsClear" id="txtcash_Paymentdate" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 8px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Payment Method<span style="color:red;">*</span></label>
                            <select autocomplete="off" class="form-control clsClear" id="txtcash_PaymentMethod" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;">
                                <option value="">--Select-</option>
                                <option value="CASH">Cash</option>
                                <option value="DEBITCARD">Debit Card</option>
                                <option value="CREDITCARD">Credit Card</option>
                                <option value="BANKTRANSFER">Bank Transfer</option>
                            </select>
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Pancard no<span style="color:red;">* (mandatory for <b>Fare > 50000</b>)</span></label>
                            <input autocomplete="off" class="form-control clsAlphaNumeric clsClear" id="txtcash_pancard" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Free text</label>
                            <input autocomplete="off" class="form-control clsClear" id="txtcash_freetext" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                        <div class="col-xs-12 col-sm-6" style="margin-bottom: 10px;">
                            <label style="font-size: 12px; margin-bottom: 0px;">Employee code<span style="color:red;">*</span></label>
                            <input autocomplete="off" class="form-control clsAlphaNumeric clsClear" id="txtcash_EmpCode" type="text" style="text-transform: uppercase; border-radius: 0px 3px 3px 0px !important;" />
                        </div>
                    </div>
                </div>
                <div class="paymntdiv row row0" id="dvEmpDetails" style="display:none;background: #f4f4f4;">
                    <div class="row row0" style="margin-bottom: 10px; margin-top: 0; padding: 8px 6px; background: #eceaea;">
                        <div class="col-xs-12 col0 scrl-btm-line">
                            <h5 style="font-size: 13px !important; margin: 0px; font-weight: 600;">Employee details</h5>
                        </div>
                    </div>
                    <div class="row row0">

                        <div class="col-xs-12 col-sm-12 text-center w-100" id="dvEmployee" style="margin-bottom:10px;display:none;">

                        </div>
                    </div>
                </div>
            </div>
            <div class="row" style="margin: 3%;">
                <div class='set_5_button col-lg-3 col-xs-6 col-lg-offset-3' id="btnTicketingPopUp">
                    <a class="c-button b-50 bg-aqua hv-transparent action-button color" id="btnYes" data-izimodal-transitionout="bounceOutDown" onclick="Ticketing()" style="height: 35px; padding: 3px 0px;"><span>YES</span></a>
                </div>
                <div class='set_5_button col-lg-3 col-xs-6' id="dvNoTicketing">
                    <a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btnNo" data-izimodal-transitionout="bounceOutDown" onclick="hidePopUp()" style="height: 35px; padding: 3px 0px;"><span>NO</span></a>
                </div>
            </div>
        </div>
    </div>
    <div id="dvinnerFaRe" style="padding-top: 1%; max-height: 360px; overflow: auto;"></div>
</div>

@*Fare or Class reverse Confirmation*@
<div class="modal fade" id="modal_confirm" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-md" style="top: 15%;">
        <div class="modal-content">
            <div class="modal-body clsPopupBody" style="padding: 10px;">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="header paymentpopups">Confirmation</div>
                    </div>
                </div>
                <div class="main">
                    <div class="row row5" style="margin: 15px;">
                        <div class="col-lg-12 col-xs-12 col5 maindivcontact" id="div_reverce_content"></div>
                    </div>
                    <hr />
                    <div class="row" style="margin-bottom: 15px;">
                        <div class="col-md-offset-3 col-md-3 col-xs-6">
                            <input type="button" value="Ok" class="btn btn-md btn-primary width100per" data-dismiss="modal" id="btnreverseOK" onclick="javascript: Get_Fare(1);" />
                        </div>
                        <div class="col-md-3 col-xs-6">
                            <input type="button" value="Cancel" data-dismiss="modal" class="btn btn-md btn-danger width100per" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>ddl_paymenttype
</div>
@*Fare or Class reverse Confirmation*@

<div id="modal-AccountingPopup" class="iziModal">
    <div style="padding: 3%;">
        <div class="row row15">
            <div class="col-lg-offset-2 col-lg-8 input-effect" style="margin-bottom: 10px;">
                <label class="colrcls" for="ddl_paymenttype">Payment Mode <span class="color-red-udk">*</span></label>
                <select class="form-control" id="ddl_paymenttype" onchange="changePayment()" style="padding: 8px 6px !important">
                    <option value="0">--Select--</option>
                </select>
                @*  <option value="-1">--Select--</option>
                    <option value="C">Credit</option>
                    <option value="B">Pass Through</option>
                        @if (ViewBag.Paymentdetails != null && ViewBag.Paymentdetails != "")
                        {
                            string[] Paymentoptions = ViewBag.Paymentdetails.ToString().TrimEnd('~').Split('~');
                            string defaultselectpaymode = Paymentoptions.Count() == 1 ? "selected ='selected'" : "";
                            <select class="txt-anim clshideErr losefocus has-content" id="ddl_paymenttype" onchange="changePayment()" style="padding: 0 6px !important; width: 100%;">
                                <option value="-1">--Select--</option>
                                @for (int k = 0; k < Paymentoptions.Count(); k++)
                                {
                                    if (Paymentoptions[k] == "T")
                                    {
                                    <option value="T" @defaultselectpaymode>Topup</option>
                                    }
                                    if (Paymentoptions[k] == "B")
                                    {
                                    <option id='passthrough' value='B' @defaultselectpaymode>Pass&nbsp;Through</option>
                                    }
                                    if (Paymentoptions[k] == "P" && ViewBag.SpecialFlag != null && ViewBag.SpecialFlag.ToString() == "N" && ViewBag.SpecialFlag.ToString() != "M")
                                    {
                                    <option id='paymentgate' value='P' @defaultselectpaymode>Payment&nbsp;Gateway</option>
                                    }
                                    if (Paymentoptions[k] == "C")
                                    {
                                    <option value='C' @defaultselectpaymode>Credit</option>
                                    }
                                }
                            </select>
                        }*@

            </div>
        </div>
        <div class="row row15" style="margin-top: 0%;">
            <div class="col-lg-offset-2   col-lg-8   input-effect payment-track-ref " style="display: none;">
                <input id="ddl_PaymentREF" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px;" class="txt-anim clshideErr losefocus has-content" type="text" maxlength="25" />
                <label for="ddl_PaymentREF" class="colrcls">Payment Ref. No <span class="color-red-udk">*</span></label>
            </div>
        </div>
        <div class="row row15" style="margin-top: 0%;">
            <div class="col-lg-offset-2 col-lg-8 input-effect passthrough-details-ref " style="display: none; margin-bottom: 15px; float: left;">
                <div>
                    <div class="md-radio">
                        <input type="radio" name="B" id="rdiocustomer" style="float: left;" checked="checked" onclick="showText()" />
                        <label for="rdiocustomer" style="float: left; padding-right: 5px; padding-left: 25px; cursor: pointer; margin-right: 10px; margin-bottom: 10px;">Customer Card</label>
                    </div>
                    <div class="md-radio">
                        <input type="radio" name="B" id="rdioriya" style="float: left;" onclick="showText()">
                        <label for="rdioriya" style="float: left; padding-right: 5px; padding-left: 25px; cursor: pointer; margin-right: 10px; margin-bottom: 10px;">Riya Card</label>
                    </div>
                    <span style="padding-right: 5px; padding-left: 5px; float: left; cursor: pointer; color: red; display: none; margin-bottom: 15px;" id="spnNoteText">Amount will be debited from Corporate/Group balance</span>
                </div>
            </div>
            <br />
            <div class="col-lg-offset-2 col-lg-8 input-effect passthrough-details-ref " style="display: none; margin-bottom: 15px;">
                <input id="ddl_PassthrougUATP" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px;" class="txt-anim clshideErr losefocus has-content" type="text" maxlength="25">
                <label for="ddl_PassthrougUATP" class="colrcls">Card No.<span class="color-red-udk">*</span></label>
            </div>
        </div>
        <div class="row row15" style="margin-top: 15px;">
            <div class="col-lg-offset-2   col-lg-8 input-effect" style="">
                <textarea class="txt-anim has-content" maxlength="100" rows="3" cols="50" onkeypress="return ValidateSpecialChar(event);" id="remarksretrivePNR" style="border: 1px solid #ccc; width: 100%; height: 2%;"></textarea>
                <label class="colrcls" for="remarksviewpnr"><span id="RemoveBookRemarks">Remarks</span> </label>
            </div>
        </div>
        <div class="row row15">
            <div class="col-sm-offset-4 col-sm-4  MailBtn" style="text-align: right; margin-top: 15px;">
                <a class="c-button MailBtn b-50 bg-aqua hv-transparent" id="pay-det-acc" onclick="Get_Fare(0);">Accounting</a> @*1512*@
            </div>
        </div>
    </div>
</div>

<div id="datailtabmail" class="iziModal" tabindex="-1" role="dialog" aria-hidden="false" style="overflow: hidden;">
    <div id="dvinnerFRmail" style="padding: 20px !important;">
        <div class="row row0" id="wholecontentdivmail" style="text-align: center; margin-left: 0px; margin-right: 0px;">
        </div>
        <div id="Retrivesendmailticket">
            <div class="row row15">
                <div class="col-sm-12 input-effect" style="margin: 20px 0% !important">
                    <input type="text" class="txt-anim clshideErr losefocus" id="sendmailViewPnr" onkeypress="javascript:return ValidateEmailtxtViewPnr(event);" placeholder="" style="width: 100%" />
                    <label class="colrcls" for="sendmailViewPnr"><span id="RemoveBookMail">Enter Mail id</span></label>
                </div>
            </div>
            <div class="row row15">
                <div class="col-sm-12 input-effect" style="margin: 20px 0% !important">
                    <textarea class="txt-anim" maxlength="100" rows="3" cols="50" onkeypress="return ValidateSpecialChar(event);" id="remarksviewpnr" style="border: 1px solid #ccc; width: 100%; height: 2%;"></textarea>
                    <label class="colrcls" for="remarksviewpnr"><span id="RemovBookRemarks">Remarks</span> </label>
                </div>
            </div>
            <div class="row row15">
                <div class="col-sm-4 col-sm-offset-4 col-xs-12">
                    <a class="c-button MailBtn b-50 bg-aqua hv-transparent action-button colorB1" style="height: 35px; padding: 1px;" onclick="sendmailview()">Send Mail</a>
                </div>
            </div>
        </div>
    </div>
</div>

@*FOP Popup*@
<div id="modal-FOPPopup" class="iziModal" tabindex="-1" role="dialog" aria-hidden="false" style="overflow: hidden;">
    <div class="row" style="padding: 20px !important;">
        <div class="col-sm-12 col-xs-12">
            <span style="font-size:14px;" id="spnFOP"></span>
        </div>
    </div>
    <div class="row" style="margin-bottom: 15px;">
        <div class="col-md-offset-3 col-md-3 col-xs-6">
            <input type="button" value="Ok" class="btn btn-md btn-primary width100per" data-izimodal-close="" onclick="javascript: LoadPaymentPopup(2);" />
        </div>
        <div class="col-md-3 col-xs-6">
            <input type="button" value="Cancel" data-izimodal-close="" class="btn btn-md btn-danger width100per" onclick="javascript: LoadPaymentPopup(1);" />
        </div>
    </div>
</div>
@*Fare Change Popup*@
<div id="modal-FareChangePopup" class="iziModal" tabindex="-1" role="dialog" aria-hidden="false" style="overflow: hidden;">
    <div class="row" style="padding: 20px !important;">
        <div class="col-sm-12 col-xs-12">
            <span style="font-size:14px;" id="spnFareChangeMsg"></span>
        </div>
    </div>
    <div class="row" style="margin-bottom: 15px;">
        <div class="col-md-offset-3 col-md-3 col-xs-6">
            <input type="button" value="Ok" class="btn btn-md btn-primary width100per" data-izimodal-close="" onclick="javascript: Ticketing(1);" />
        </div>
        <div class="col-md-3 col-xs-6">
            <input type="button" value="Cancel" data-izimodal-close="" class="btn btn-md btn-danger width100per" />
        </div>
    </div>
</div>

<div id="dvPaxCount"></div>
<input id="hdf_farechanged_session" type="hidden" value="" />
<input id="hdf_tstcount" type="hidden" value="0" />
<input id="hdf_pnrinfo" type="hidden" value="" />
<input id="hdf_fareinfo" type="hidden" value="" />
<input type="hidden" id="hdn_crspnr" />
<input type="hidden" id="hdn_crs" />
<input type="hidden" id="hdn_queuenum" />
<input type="hidden" id="hdn_farequalifier" />
<input type="hidden" id="hdn_pricingToken" />
<input type="hidden" id="hdn_TSTReference" />
<input type="hidden" id="hdfPrintSessionvpnr" />
<input type="hidden" id="hdnOBCAmount" />
<input type="hidden" id="hdnOBCAmountTopup" />
<input type="hidden" id="hdnCorporateCode" />
<input type="hidden" id="hdnClientID" value="" />
<input type="hidden" id="hdnBranchID" value="" />
<input type="hidden" id="hdncash_Empname" value="" />
<input type="hidden" id="hdncash_Empemail" value="" />
<input type="hidden" id="hdncash_Empmobile" value="" />
<input type="hidden" id="hdncash_Empbranch" value="" />
<script type="text/javascript">
    var AgentLoadURL = '@Url.Action("GetClientdetails", "HOME")';
    var AirlineNameXmlURL = "@Url.Content("~/XML/AirlineNames.xml")";
    var QueueticketingUrl = '@Url.Action("Fetch_QueuePNR_Details", "RetriveBooking")';
    var Getbalancesss = '@Url.Action("CheckClientBalance", "Home")';
    var RetrivePNRDetails = '@Url.Action("RetrivePNRDetails", "RetriveBooking")';
    var QueueticketingCheckFareUrl = '@Url.Action("Fetch_QueueFARE_Details", "RetriveBooking")';
    var QueueticketingAccountingUrl = '@Url.Action("Fetch_Queue_Accounting", "RetriveBooking")';
    var GSTFlag = "@ViewBag.GSTFlag";
    var GST = "@GST";
    var loadurl = "@strLoaderURL";
    var ConfirmFareURL = '@Url.Action("ConfirmFare", "RetriveBooking")';
    var TicketingConfirm = '@Url.Action("Ticketing_QueuePNR_Details", "RetriveBooking")';
    var FetchPassthrought_URL = '@Url.Action("Fetch_PassThrough_Card_details", "RetriveBooking")';
    var xmlcountry = '@Url.Content("~/XML/Country.xml")';
    var AirlinenamesXML = '@Url.Content("~/XML/AirlineNames.xml")';
    var VarX = "0";
    var FareRule = '@Url.Action("RetrieveFareRules", "RetriveBooking")';
    var TerminalType = '@TerminalType';
    var StrGstdetailsretrieve = [];
    var PNRFlag = "@PNRFlag";
    var Asyncbookingresponse_update = '@Url.Action("Asyncbookingresponse", "Booking")'; //Added for Response status update
    var EditEarnings = '@Url.Action("EditEarnings", "RetriveBooking")';
    var GetEarningsURL = '@Url.Action("GetEarnings", "RetriveBooking")';
    var CommissionType = "";//'CommissionType';
    var SessionRedirectURL = "@Url.Action("SessionExp", "Redirect")";
    var PCCDetailsURL = "@Url.Action("LoadPCCDetails", "RetriveBooking")";
    var APP_Terminal = "@APP_Terminal";
    var ApprovalData = [];
    var GetEmployeeDetURL = "@Url.Action("GetEmployeeDetails", "Home")";
    var ProductType = '@strProduct';

    function changePayment() {
        var Pay_options = $("#ddl_paymenttype").val();
        if (Pay_options == "P") {
            $(".payment-track-ref").show();
            $(".passthrough-details-ref").hide();
        } else if (Pay_options == "B") {
            $(".payment-track-ref").hide();
            $(".passthrough-details-ref").show();
        } else {
            $(".payment-track-ref").hide();
            $(".passthrough-details-ref").hide();
        }
    }

    var check_session = '@ViewBag.SessionExp';
    $(document).ready(function () {
        InvokeAirlineXml();
        if (check_session != null && check_session != "") {
            showerralert(check_session, "", "");
            window.location.href = $('#dvDataProp').data('session-url');
            return false;
        }

        if (TerminalType == "T") {
            LoadClient();
            $(".dvagencyname").show();
            $(".udk-office-id").show();
        }
        else {
            $('#hdnClientID').val("@ClientID");
            $('#hdnBranchID').val("@BranchID");
            $(".dvagencyname").hide();
            $(".udk-office-id").hide();
            ClientBalanceCheck();
        }

        var strgstary = [];
        var json = "";
        var JsonData = "";
        var strstate = "";

        $.ajax({
            type: "GET",
            url: '@Url.Content("~/XML/State.xml")',
            async: false,
            dataType: "xml",
            success: function (xmlResponse) {
                json = $.xml2json(xmlResponse);
                JsonData = json.STATE;
                strstate += "<option value='ALL'>--Select--</option>";
                $.each(JsonData, function (index, val) {
                    if (StrGstdetailsretrieve != null) {
                        strgstary = $.grep(StrGstdetailsretrieve, function (n, i) {
                            return n.CLT_GST_STATE == val.STATE_ID
                        });
                    }
                    if (strgstary != null && strgstary != "") {
                        for (var N = 0; strgstary.length > N; N++) {
                            strstate += "<option value=" + val.STATE_ID + " data-gstno = " + strgstary[N].CLT_GST_NO + ">" + val.STATE_NAME + "-" + strgstary[N].CLT_GST_NO + "</option>";
                        }
                    }
                    else {
                        strstate += "<option value=" + val.STATE_ID + " data-gstno=" + "" + ">" + val.STATE_NAME + "</option>";
                    }
                });
                $("#ddlgststate").html(strstate);
            }
        });
        loadAirline();
    });

    function loadAirline() {
        var json = "";
        $.ajax({
            url: AirlinenamesXML,
            dataType: 'xml',
            async: false,
            success: function (response) {
                try {
                    json = $.xml2json(response);
                    var aryjsonval = json.AIRLINEDET
                    var aryjson = aryjsonval.filter(function (item, val) {
                        return item._CATEGORY == "FSC";
                    });
                    var ddlOnwardSement3 = document.getElementById("ddl_platingcarrier");
                    var ddloptions = "";
                    var optioncount = 1;
                    var childOptionCSelect = new Option();
                    childOptionCSelect.value = "";
                    childOptionCSelect.text = "Select an option";
                    childOptionCSelect.title = "";
                    ddlOnwardSement3[0] = childOptionCSelect;
                    $.each(aryjson, function (index, val) {
                        var childOptionCSelect = new Option();
                        childOptionCSelect.value = val._CODE;
                        childOptionCSelect.text = val._NAME + " " + "(" + val._CODE + ")";
                        childOptionCSelect.title = val._NAME + " " + "(" + val._CODE + ")";
                        ddlOnwardSement3[optioncount] = childOptionCSelect;
                        optioncount++;
                    });
                    if ($("#ddl_platingcarrier_chosen").length)
                        $('#ddl_platingcarrier').chosen('destroy');
                    $("#ddl_platingcarrier").chosen();
                }
                catch (e) {
                    console.log(e.message);
                }
            }
        });
    }

    var FOPFlag = false;
    function ConfirmFOP() {
        var strCard = $("#ddl_PassthrougUATP").val();
        if (strCard == "" || strCard == null) {
            //FOPFlag = false;
            LoadPaymentPopup(1);
        }
        else {
            $('#spnFOP').html("Are you sure to continue with **" + strCard.substring(strCard.length, strCard.length - 4));//Payment done via Agent User Card
            //FOPFlag = true;
            Callpopup("Confirm FOP", "modal-FOPPopup", "500px");
        }
    }

    function LoadPaymentPopup(arg) {

        //if (arg == 1) {
        //    FOPFlag = false;
        //}
        //else {
        //    FOPFlag = true;
        //}

        var RAT = true;
        var RATLCC = true;
        var missing_title = "";
        var temp = "";
        var missing_title = "";
        var TST = "";
        var status = false;
        var totalfare = 0;
        var totalfares = 0;
        var noOfCheckBox = document.getElementById('table1').getElementsByTagName('input');
        $('#dvNoTicketing').html('<a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btnNo" onclick="hidePopUp()" data-izimodal-transitionout="bounceOutDown" style="height: 35px; padding: 1px;"><span>NO</span></a>');
        if ($("#rdoaircat_FSC")[0].checked) { RATLCC = false } else { RATLCC = true }

        //STS-166
        //if (sessionStorage.getItem("ticketstatus") == "1") {
        //    RAT = false;
        //    $("#btn_getfare span").html("Accounting");
        //} else {
        //    RAT = true;
        //    $("#btn_getfare span").next().html("Check Fare");
        //}

        //$(".udk-totalfare-show").hide();//STS-166
        for (var j = 0; j < noOfCheckBox.length; j++) {
            if (noOfCheckBox[j].checked == true) {
                status = true;
                totalfare = totalfare + noOfCheckBox[j].value;
                TST = noOfCheckBox[j].id.replace('tst', '');

                var paxcount = $('#' + TST + 'hdf_paxcount').val();
                var adult_count = paxcount.split('|')[0];
                var child_count = paxcount.split('|')[1];
                var infant_count = paxcount.split('|')[2];

                if ($('#' + TST + 'title_adult1').length) {
                    for (var i = 1; i <= adult_count; i++) {
                        if ($('#' + TST + 'title_adult' + i).length) missing_title += $('#' + TST + 'title_adult' + i).val() + ",";
                        else break;
                    }
                }
                if ($('#' + TST + 'title_child1').length) {
                    for (var i = 1; i <= child_count; i++) {
                        if ($('#' + TST + 'title_child' + i).length) missing_title += $('#' + TST + 'title_child' + i).val() + ",";
                        else break;
                    }
                }
                if ($('#' + TST + 'title_infant1').length) {
                    for (var i = 1; i <= infant_count; i++) {
                        if ($('#' + TST + 'title_infant' + i).length) missing_title += $('#' + TST + 'title_infant' + i).val() + ",";
                        else break;
                    }
                }
            }
        }


        //if ($("#ddl_Faretype").val() == "-1" || $("#ddl_Faretype").val() == "") {
        //    infoAlert('Please select Fare Type !', "ddl_Faretype");
        //    return false;
        //}

        if (TerminalType == "T" && ($("#ddl_OfficeID").val() == "-1" || $("#ddl_OfficeID").val() == "")) {
            infoAlert('Please select office Id !', "ddl_OfficeID");
            return false;
        }

        if (missing_title.indexOf("Title") > -1 && RAT != false && RATLCC == false) {
            infoAlert("Please select Title", "");
            return false;
        }

        var strCount = $(".RadioSelected").length;
        if (parseInt(strCount) > 1 && RAT != false && RATLCC == false) {
            infoAlert("Only one TST is allowed at a time.", "");
            return false;
        }

        if (GST == "Y" && $("#ddlgststate").val() != "ALL") {
            if ($("#ddlgststate").val() == null || $("#ddlgststate").val() == "") {
                infoAlert("Please select GST state.", "ddlgststate");
                return false;
            }
            if ($("#txtgstNumber").val() == null || $("#txtgstNumber").val() == "") {
                infoAlert("Please enter GST number.", "txtgstNumber");
                return false;
            }
            if ($("#txtgstCompanyname").val() == null || $("#txtgstCompanyname").val() == "") {
                infoAlert("Please enter GST Company .", "txtgstCompanyname");
                return false;
            }
            if ($("#txtgstAddress").val() == null || $("#txtgstAddress").val() == "") {
                infoAlert("Please enter GST Address .", "txtgstAddress");
                return false;
            }
            if ($("#txtgstEmailid").val() == null || $("#txtgstEmailid").val() == "") {
                infoAlert("Please enter GST Mail id .", "txtgstEmailid");
                return false;
            }
            if ($("#txtgstMobileNumber").val() == null || $("#txtgstMobileNumber").val() == "") {
                infoAlert("Please enter GST Mobile number .", "txtgstMobileNumber");
                return false;
            }
        }

        //var filter = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;

        //   if ($("#btn_getfare span").data("Retrieveflag").trim() != "0") {

        var faretypereason = "";
        var erromanflag = false;
        var errorval = "";
        $(".slttxtfrereason").each(function () {
            if ($(this).data("mandatoryflag") == "Y") {
                if ($(this).val() == "") {
                    erromanflag = true;
                    errorval = $(this).data("idname");
                    return false; //This line is coming out from the each function
                }
            }
            faretypereason += $(this).data("dataid") + "|" + $(this).data("idname") + "|" + $(this).val() + "~";
        });
        if (erromanflag) {
            infoAlert("Please select " + errorval, errorval);
            return false;
        }
        //  }
        if ($("#btn_getfare span").data("Retrieveflag").trim() == "0") { // 0- check fare, 1- Accounting
            TicketingMode = "CT";
            Get_Fare(0);
        }
        else {
            $("#ddl_paymenttype").val("0");
            $("#remarksretrivePNR").val("");
            CallFarepopup("Payment Details", "modal-AccountingPopup", "700");
        }
    }
</script>
<link href="~/Content/CSS/raysModal.css?@StrVersion" rel="stylesheet" />
<script src="~/js/raysModal.js?@StrVersion"></script>
<script src="~/js/jquery.blockUI.js?@StrVersion"></script>
<script src="~/js/AppsJS/QueueTicketing.js?@StrVersion"></script>

<script>


    function Changeddlretrievegststate(stateid) {
        var strstate = stateid != null && stateid != undefined && stateid != "" ? stateid : $("#ddlgststate").val();
        var strgstselt = $("#ddlgststate option:selected").data("gstno") != null && $("#ddlgststate option:selected").data("gstno") != "" && $("#ddlgststate option:selected").data("gstno") != undefined ? $("#ddlgststate option:selected").data("gstno") : "";
        var ssres = "";
        if (StrGstdetailsretrieve != "" && StrGstdetailsretrieve.length > 0) {
            ssres = $.grep(StrGstdetailsretrieve, function (val, index) {
                return val.CLT_GST_STATE == strstate
            });
        }

        if (ssres != "" && ssres.length > 0) {

            if (stateid != undefined) {
                setTimeout(function () {
                    $("#ddlgststate").val(stateid)
                    $("#ddlgststate option[value='" + stateid + "']").attr("selected", "selected");
                }, 1000);
            }
            if (strgstselt != null && strgstselt != "") {
                ssres = $.grep(ssres, function (n, i) {
                    return n.CLT_GST_NO == strgstselt
                });
            }
            $("#txtgstNumber").val(ssres[0].CLT_GST_NO);
            $("#txtgstCompanyname").val(ssres[0].CLT_GST_CLIENT_NAME);
            $("#txtgstAddress").val(ssres[0].CLT_GST_ADDRESS);
            $("#txtgstEmailid").val(ssres[0].CLT_GST_EMAIL);
            $("#txtgstMobileNumber").val(ssres[0].CLT_GST_PHONE);
        }
        else {
            $("#txtgstNumber").val("");
            $("#txtgstCompanyname").val("");
            $("#txtgstAddress").val("");
            $("#txtgstEmailid").val("");
            $("#txtgstMobileNumber").val("");
        }
    }

    function Changeddlgststate(stateid) {

        var strstate = stateid == undefined || stateid == "" || stateid === null ? $("#ddlgststate").val() : stateid; //by vijai to load a default gst based on rights 19032018
        var strgstselt = $("#ddlgststate option:selected").data("gstno") != null && $("#ddlgststate option:selected").data("gstno") != "" && $("#ddlgststate option:selected").data("gstno") != undefined ? $("#ddlgststate option:selected").data("gstno") : "";
        var ssres = "";
        if (StrGstdetails != "" && StrGstdetails.length > 0) {
            ssres = $.grep(StrGstdetails, function (val, index) {
                return val.CLT_GST_STATE == strstate
            });
        }

        if (stateid != null && stateid != undefined && stateid != "") {
            setTimeout(function () {
                $("#ddlgststate").val(stateid)
                $("#ddlgststate option[value='" + stateid + "']").attr("selected", "selected");
            }, 1000);
        }

        if (strgstselt != null && strgstselt != "") {
            ssres = $.grep(ssres, function (n, i) {
                return n.CLT_GST_NO == strgstselt
            });
        }

        if (ssres != "" && ssres.length > 0) {
            $("#txtgstNumber").val(ssres[0].CLT_GST_NO);
            $("#txtgstCompanyname").val(ssres[0].CLT_GST_CLIENT_NAME);
            $("#txtgstAddress").val(ssres[0].CLT_GST_ADDRESS);
            $("#txtgstEmailid").val(ssres[0].CLT_GST_EMAIL);
            $("#txtgstMobileNumber").val(ssres[0].CLT_GST_PHONE);
        }
        else {
            $("#txtgstNumber").val("");
            $("#txtgstCompanyname").val("");
            $("#txtgstAddress").val("");
            $("#txtgstEmailid").val("");
            $("#txtgstMobileNumber").val("");
        }
    }

    function checkcatogory(arg) {
        var str_builder = '';
        var str_air_build = '';
        if (arg == 0) {
            str_builder += ' <input type="text" class="txt-anim clshideErr losefocus has-content" id="txt_CRSpnr_Queue" maxlength="7" onkeypress="javascript:return ValidateAlphaNumeric(event);" autocomplete="off" style="width: 100%; text-transform: uppercase">'
            str_builder += '<label for="txt_CRSpnr_Queue" class="colrcls">CRS PNR <span class="color-red-udk">*</span></label>';
            $(".udk-Category-cls").html(str_builder);

            str_air_build += '<select class="txt-anim clshideErr losefocus has-content" id="ddl_QueueStock" style="padding: 0 6px !important;width:100%;" onchange="Queuechange();">'
            str_air_build += '<option value="-1">--Select--</option>'
            str_air_build += '</select>'
            str_air_build += '<label class="colrcls" for="ddl_QueueStock">CRS Name <span class="color-red-udk">*</span></label>';

            $(".udk-Airline-cls").html(str_air_build);
            LoadCRSdetails();

            //$(".udk-corporate-code").html('<input id="txt_corporateCode" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px; " class="txt-anim clshideErr losefocus has-content" type="text" maxlength="25" /><label for="txt_corporateCode" class="colrcls" >Corporate Pricing Code <span class="color-red-udk"></span></label>');

            $("#ddl_QueueAT").val("-1");
            //$(".udk-office-id").show();//STS-166
            LoadOfficeId("");
        }
        else {
            str_builder += ' <input type="text" class="txt-anim clshideErr losefocus has-content" id="txt_Airlinepnr_Queue" maxlength="7" onkeypress="javascript:return ValidateAlphaNumeric(event);" autocomplete="off" style="width: 100%; text-transform: uppercase">'
            str_builder += '<label for="txt_Airlinepnr_Queue" class="colrcls">Airline PNR <span class="color-red-udk">*</span></label>';
            $(".udk-Category-cls").html(str_builder);
            str_air_build += '<select class="txt-anim clshideErr losefocus has-content" id="ddl_AirlineStock" style="padding: 0 6px !important;width:100%;" onchange="LoadOfficeId()">'
            str_air_build += '<option value="-1">--Select--</option>'
            str_air_build += '</select>'
            str_air_build += '<label class="colrcls" for="ddl_AirlineStock">Airline Name <span class="color-red-udk">*</span></label>';
            $(".udk-Airline-cls").html(str_air_build);
            //$(".udk-corporate-code").html('<input id="txt_PromoCode" onkeypress="javascript:return ValidateAlphaNumeric(event);" style="height: 34px; " class="txt-anim clshideErr losefocus has-content" type="text" maxlength="25" /><label for="txt_PromoCode" class="colrcls" >Promo Code <span class="color-red-udk"></span></label>');
            arrydomestic_ret = [];

            var aryvalload = "";
            aryvalload += '<option value="-1">--Select--</option>';
            var airporttype = "";
            for (var i = 0; i < Airdata1_ret.length; i++) {
                airporttype = $("#ddl_QueueAT").val();
                if (Airdata1_ret[i].care == "LCC" && Airdata1_ret[i].airport_id == airporttype) {

                    aryvalload += "<option  value=" + Airdata1_ret[i].id + '|' + Airdata1_ret[i].care + ">" + Airdata1_ret[i].value + "</option>";
                    arrydomestic_ret.push(Airdata1_ret[i].id + '|' + Airdata1_ret[i].care);
                }
            }
            $("#ddl_AirlineStock").html(aryvalload);

            if ($('#ddl_AirlineStock').length) {
                $('#ddl_AirlineStock').chosen('destroy');
            }

            $('#ddl_AirlineStock').chosen();
            $("#ddl_QueueAT").val("-1");
            LoadOfficeId("");
            //$(".udk-office-id").hide();
        }
    }

    function changeairline() {
        arrydomestic_ret = [];

        var aryvalload = "";
        aryvalload += '<option value="-1">--Select--</option>';
        var airporttype = "";
        for (var i = 0; i < Airdata1_ret.length; i++) {
            airporttype = $("#ddl_QueueAT").val();
            if (Airdata1_ret[i].care == "LCC" && Airdata1_ret[i].airport_id == airporttype) {

                aryvalload += "<option  value=" + Airdata1_ret[i].id + '|' + Airdata1_ret[i].care + ">" + Airdata1_ret[i].value + "</option>";
                arrydomestic_ret.push(Airdata1_ret[i].id + '|' + Airdata1_ret[i].care);
            }
        }

        $("#ddl_AirlineStock").html(aryvalload);
        if ($('#ddl_AirlineStock').length) {
            $('#ddl_AirlineStock').chosen('destroy');
        }

        $('#ddl_AirlineStock').chosen();
        clearretrievepnr();
    }

    var arrydomestic_ret = [];
    var Airdata1_ret = "";
    var Airlinedatacount_ret = "";

    $(document).ready(function () {
        //LoadOfficeId();
        $.ajax({
            type: "GET",
            url: '@Url.Content("~/XML/AirlineNames.xml")',
            async: false,
            dataType: "xml",
            success: function (xmlResponse) {

                Airdata1_ret = $("AIRLINEDET", xmlResponse).map(function () {
                    return {
                        value: $("_NAME", this).text(),
                        id: $("_CODE", this).text(),
                        care: $("_CATEGORY", this).text(),
                        airport_id: $("AIRPORT_ID", this).text(),
                    };
                }).get();
            }
        });
        LoadCRSdetails();
    });

    function LoadCRSdetails() {
        var ProductSupportDetails = '@Url.Content("~/XML/ProductSupportDetails.xml?"+ StrVersion)';
        try {
            $.ajax({
                type: "GET",
                url: ProductSupportDetails,
                async: true,
                dataType: "xml",
                success: function (xml) {
                    var json = $.xml2json(xml);
                    var ProductSupportdetails = json[ProductType];
                    if (ProductSupportdetails != undefined && ProductSupportdetails != null && ProductSupportdetails != "" && ProductSupportdetails.CRSNAME.SUPPLIER != undefined) {
                        var stringBuilder = "<option value='-1'>--Select--</option>";
                        var SupplierArry = [];
                        Array.isArray(ProductSupportdetails.CRSNAME.SUPPLIER) ? SupplierArry = ProductSupportdetails.CRSNAME.SUPPLIER : SupplierArry.push(ProductSupportdetails.CRSNAME.SUPPLIER);
                        $.each(SupplierArry, function (i, val) {
                            stringBuilder += "<option value=" + val.ID + ">" + val.NAME + "</option>";
                        });
                        $("#ddl_QueueStock").html(stringBuilder);
                    }
                    else {
                        var stringBuilder = "<option value='-1'>--Select--</option>";
                        stringBuilder += '<option value="1A">Amadeus</option>'
                        stringBuilder += '<option value="1G">Galileo</option>'
                        $("#ddl_QueueStock").html(stringBuilder);
                    }
                    //Footer Content Region End

                },
                error: function (data) {
                    console.log(data);
                }
            });
        }
        catch (ex) {
            $(".dvFooter").hide();
            console.log(ex)
        }
    }

    function LoadLocation_GST(cityname) {
        var locationgstdetails = "";
        locationgstdetails = loadcityxml();
        locationgstdetails = locationgstdetails.CITY;
        locationgstdetails = $.grep(locationgstdetails, function (n, i) {
            return cityname.toUpperCase().indexOf(n.CITY_NAME.toUpperCase()) != -1
        });
        return locationgstdetails;
    }

    function loadcityxml() {
        var json = "";
        $.ajax({
            url: cityxmlurl,
            dataType: 'xml',
            async: false,
            success: function (response) {

                try {
                    json = $.xml2json(response);
                }
                catch (ex) {
                    json = "";
                }
            }
        });
        return json;
    }

    var aryglobalcitys = [];
    // var loadGlobalcityArrry = [];


    loadGlobalcityArrry();
    function loadGlobalcityArrry() {
        aryglobalcitys = [];
        $.ajax({
            type: "GET",
            url: '@Url.Content("~/XML/AirlineNames.xml")',
            dataType: 'xml',
            async: false,
            success: function (response) {
                try {

                    var json = $.xml2json(response);
                    var JsonData = json.AIRLINEDET;
                    aryglobalcitys = JsonData;
                }
                catch (ex) {
                    //Lobibox.alert('warning', {   //eg: 'error' , 'success', 'info', 'warning'
                    //    msg: "Problem occured while load  cities.",
                    //    closeOnEsc: false, callback: function ($this, type) {
                    //        $.unblockUI();
                    //    }
                    //});
                    showerralert('Problem occured while load cities.', "", "");
                    $.unblockUI();
                }
            }
        });
    }

    function RetrivePrintTicket() {
        var Pnr = $("#Retrive_riyaPnr").text();

        //Pnr = document.getElementById('S_pnr').value;
        //if (document.getElementById("Chk_fare").checked == true)
        //    var fare = "yes";
        //else
        //    fare = "no";
        //if (document.getElementById("Chk_fare1").checked == true)
        //    var single = "yes";
        //else
        //    single = "no";

        var fare = "no";
        var single = "no";
        var logo = "yes";
        var breakup = "yes";
        var sf = "yes";

        if ($(window).width() < 768) { //For Mobile View...
            var iurl = "@Url.Action("PrintTickets", "AfterBooking")" + "?strSPNRNO=" + Pnr + "|" + fare + "|" + logo + "|" + breakup + "|" + sf + "&single=" + single + "&Page=" + "B";
            var ititle = "Print Ticket";
            var isubtitle = "";
            var ifull = false;
            ShowiFramePop(iurl, ititle, isubtitle, ifull);
        }
        else {
            newwindow = window.open("@Url.Action("PrintTickets", "AfterBooking")" + "?strSPNRNO=" + Pnr + "|" + fare + "|" + logo + "|" + breakup + "|" + sf + "&single=" + single + "&Page=" + "B");
        }
        if (window.focus) {
            newwindow.focus()
        }
        return false;
    }

    $("#printtcktclose").click(function () {
        $("#divPrintOptIconvpnr1").hide();
        $("#Ticketsprintpagevpnr").hide();
        $("#loadTicket").show();
    });

    function PrintOption() {

        var printContent = $("#hdfPrintSessionvpnr").val();
        var windowUrl = 'about:blank';
        var windowName = 'Print';
        var WinPrint = window.open(windowUrl, windowName, 'left=10,top=10,bottom=100,width=400,height=400');
        if (WinPrint != null) {
            WinPrint.document.write('<html><head></head><' + 'body style="background:none !important"' + '>');
            WinPrint.document.write(printContent);
            WinPrint.document.write('</body></html>');
            WinPrint.document.close();
            WinPrint.focus();
            WinPrint.print();
            WinPrint.close();
        }
    }

    function RetriveEmailPrintTicket(arg) {
        $("#sendmailViewPnr").val("");
        $("#remarksviewpnr").val("")
        Callpopup("Send E-Mail", "datailtabmail", "500px");
    }

    function sendmailview() {
        var mailReg = /^([\w-\.]+@@([\w-]+\.)+[\w-]{2,45})?$/;
        var strSPNRNO = $("#Retrive_riyaPnr").text();
        var send_user_mail = $("#sendmailViewPnr").val().trim();

        if (send_user_mail == "" || send_user_mail == null) {
            $("#sendmailViewPnr").addClass("bordercls");
            $("#sendmailViewPnr").addClass("has-content");
            $("#sendmailViewPnr").attr("placeholder", "Please Enter Email-Id")
            $("#sendmailViewPnr").css("color", "red")
            return false;
        }
        if (!mailReg.test(send_user_mail)) {
            $("#sendmailViewPnr").addClass("has-content");
            $("#sendmailViewPnr").val("");
            $("#sendmailViewPnr").addClass("bordercls");
            $("#sendmailViewPnr").attr("placeholder", "Please enter valid email id");
            $("#sendmailViewPnr").css("color", "red");
            return false;
        }

        $('#datailtabmail').iziModal('close');

        $.blockUI({
            message: '<img alt="Please Wait..." src="' + loadurl + '" style="background-color:#fff; border-radius:8px; margin-top:12%;" id="FareRuleLodingImage" />',
            css: { padding: '5px' }
        });
        var Query = {
            strSPNRNO: strSPNRNO,
            txtEmailID: send_user_mail,
            pdf: "",
            strPaymentmode: "",
            blntktmailflag: false,
        };
        //var Query = { strSPNRNO: strSPNRNO, Usermailid: send_user_mail }

        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: '@Url.Action("btnEmail_pdforhtml_Click", "AfterBooking")',//EmailPrintTicketcall
            data: JSON.stringify(Query),
            async: true,
            dataType: "json",
            success: function (data) {
                $.unblockUI();
                var d = data.Approvaldata;
                if (data.status == "1") {
                    showerralert(d[1], "", "");
                }
                else {
                    showerralert("Mail not sent.", "", "");
                }
            },
            error: function (result) {
                $.unblockUI();
                showerralert('Unable to connect remote server.', "", "");
                return false;
            },
        });
    }

    //#endregion
    function EmployeeFrequentFlyer() {
        var Airdata1 = "";
        var Airlinedatacount = "";

        $.ajax({
            type: "GET",
            url: AirlinenamesXML,
            async: false,
            dataType: "xml",
            success: function (xmlResponse) {

                Airdata1 = $("AIRLINEDET", xmlResponse).map(function () {
                    return {
                        value: $("_NAME", this).text(),
                        id: $("_CODE", this).text(),
                        care: $("_CATEGORY", this).text(),
                    };
                }).get();
            }
        });

        var PlatingCarriers = $("body").data("Platingcarrier");
        var paxdet = $("body").data("Paxdet");
        var Num_FLT = PlatingCarriers.split('|');
        var paxsplit = paxdet.split("|")
        var TotalCount = $("body").data("TotalCount");
        var jsnDatess = $("body").data("jsnDatess")//, jsnDatess);
        var selectedcount = TotalCount;
        var FFNadult_cnt = paxsplit[0];
        var child_cnt = paxsplit[1];
        var combinationcnt = Number(Number(Number(FFNadult_cnt) + Number(child_cnt)));
        var FFNTotalCount = Number(Number(Number(FFNadult_cnt) + Number(child_cnt))) * Number(selectedcount)
        $("body").data("arrcount", FFNTotalCount);
        var checkadt = 0;
        //var arysTemp = JSON.stringify(SelectedFltDet_UDK);
        //var myarys = JSON.parse(JSON.parse(arysTemp));
        var childcnt = 1;
        var ffncnt = 0;
        var ss = 0;
        var cnt = 0;
        var chdcnt = 0;

        var flag = "0";
        var ffnselectedname = "";
        var flightffnnumber = "";
        var noOfCheckBox = document.getElementById('table1').getElementsByTagName('input');
        // var Num_FLT = _.groupBy(PlatingCarriers.split('|').split('~')[0], function (d) { return PlatingCarriers.split('|').split('~')[0] });
        //$(":checkbox").map(function () {return this.id;}).get().join();
        if ($("#rdoaircat_FSC")[0].checked == true) {
            for (var k = 0; k < noOfCheckBox.length; k++) {
                if (noOfCheckBox[k].checked == true) {

                    TST = noOfCheckBox[k].id.replace('tst', '');
                    var paxcount = $('#' + TST + 'hdf_paxcount').val();
                    var adult_count = paxcount.split('|')[0];
                    var child_count = paxcount.split('|')[1];
                    var infant_count = paxcount.split('|')[2];

                    TotalCount = parseInt(adult_count) + parseInt(child_count) + parseInt(infant_count);

                    Airlinedatacount += '<div class="col-xs-12 col10">';
                    Airlinedatacount += '<div class="row row10">';
                    Airlinedatacount += '<div class="col-xs-12 col10">';
                    Airlinedatacount += '<div class="row row10 tabheaderflg">';
                    Airlinedatacount += '<div class="col-sm-3 col-xs-12 col-pad">';
                    Airlinedatacount += '<h5>Frequent Flyer Info</h5>';
                    Airlinedatacount += '</div>';
                    Airlinedatacount += '</div>';
                    Airlinedatacount += '<div class="clearfix"></div>';
                    Airlinedatacount += '<div class="acc-body row row10">'
                    Airlinedatacount += '<div class="row row10">'
                    Airlinedatacount += '<div class="col-md-2 col-xs-2 col10">Type'
                    Airlinedatacount += '</div>'
                    Airlinedatacount += '<div class="col-md-2 col-xs-2 col10">Sector'
                    Airlinedatacount += '</div>'
                    Airlinedatacount += '<div class="col-md-2 col-xs-5 col10">Airline'
                    Airlinedatacount += '</div>'
                    Airlinedatacount += '<div class="col-md-2 col-xs-5 col10">FFN Number'
                    Airlinedatacount += '</div>'
                    Airlinedatacount += '</div>'
                    Airlinedatacount += '<div class="row row10">'
                    Airlinedatacount += '<div class="col-sm-12 col-xs-12 col10" id="Getalldata" style="margin-top: 10px;">'

                    var ffnNew = $.grep(Num_FLT, function (n, i) {
                        return n.split('~')[3] == TST
                    });
                    //for (var s = 0; s < Number(TotalCount) ; s++) {

                    for (var i = 0; ffnNew.length > i; i++) {
                        cnt = i + Number(1);
                        if ($("#rdoaircat_FSC")[0].checked == true) {

                            flag = "0";
                            ffnselectedname = "";
                            flightffnnumber = "";

                            ffnselectedname = ffnNew[i].trim()
                            Airlinedatacount += '<div class="row row10">'
                            //Airlinedatacount += ' <div class="col-sm-1 col-xs-12 col-pad clspadding"></div>'

                            if (paxsplit[0] >= cnt) {

                                Airlinedatacount += '<div class="col-sm-3 col-lg-2 col-xs-12 col-pad clspadding">Adult' + cnt + '</div>'
                            }
                            else {
                                chdcnt = cnt - paxsplit[1]
                                Airlinedatacount += '<div class="col-sm-3 col-lg-2 col-xs-12 col-pad clspadding">Child' + chdcnt + '</div>'
                            }

                            //if (paxsplit[0] >= cnt) {

                            //    Airlinedatacount += '<div class="col-sm-3 col-lg-2 col-xs-12 col-pad clspadding">Child' + chdcnt  + '</div>'
                            //    childcnt++;
                            //}
                            //else {
                            //    chdcnt = cnt - paxsplit[1]
                            //    Airlinedatacount += '<div class="col-sm-3 col-lg-2 col-xs-12 col-pad clspadding">Adult' + cnt + '</div>'
                            //}
                            //Airlinedatacount += '<div class="col-sm-4 col-xs-12 col-pad clspadding">Airline</div>'

                            Airlinedatacount += '<div class="col-sm-2 col-xs-5 col10">'
                            Airlinedatacount += '<span>' + ffnNew[i].split("~")[1] + '</span>'
                            Airlinedatacount += '</div>'
                            Airlinedatacount += '<div class="col-sm-2 col-xs-5 col10">'
                            Airlinedatacount += '<select class="form-control clsFFNAirline" data-IntinrefFFN = "' + TST + '" id="' + TST + "FFNAirline_" + ffncnt + ffnNew[i].split("~")[0] + '" onchange="GetFFNNumber(this.id);">'
                            var strffnstatus = "";
                            if (jsnDatess != null && jsnDatess != "") {

                                var Arrffnnumber = jsnDatess;
                                for (var j = 0; Arrffnnumber.length > j; j++) {
                                    if (Arrffnnumber[j].AIRLINECODE != "") {

                                        if (Arrffnnumber[j].AIRLINECODE == ffnNew[i].split("~")[0]) {
                                            flag++
                                            var sub_arrs = $.grep(Airdata1, function (n, nn) {
                                                return n.id == Arrffnnumber[j].AIRLINECODE
                                            });
                                            Airlinedatacount += '<option value=' + sub_arrs[0].id + '> ' + sub_arrs[0].value + ' </option>';
                                            flightffnnumber = Arrffnnumber[j].FFNCODE;
                                        }
                                        else {
                                            Airlinedatacount += '<option value=' + ffnNew[i].split("~")[0] + '> ' + loadairportcityname(ffnNew[i].split("~")[0]) + ' </option>';
                                        }
                                        strffnstatus += Arrffnnumber[j].AIRLINECODE + "|" + Arrffnnumber[j].FFNCODE + "~";
                                    }
                                }
                            }
                            if (flag == "0") {
                                var sub_arr = $.grep(Airdata1, function (n, i) {
                                    return n.id == ffnselectedname
                                });
                                if (sub_arr.length > 0) {
                                    Airlinedatacount += '<option value=' + sub_arr[0].id + '> ' + sub_arr[0].value + ' </option>';
                                    flightffnnumber = "";
                                    strffnstatus += sub_arr[0].id + "|" + flightffnnumber + "~";
                                }
                            }


                            Airlinedatacount += '</select>'
                            Airlinedatacount += '</div>'
                            // Airlinedatacount += '<div class="col-sm-2 col-xs-12 col-pad clspadding">FFNNumber</div>'
                            Airlinedatacount += '<div class="col-sm-2 col-xs-5 col10">'
                            Airlinedatacount += '<input type="text" class="clspstnumeric txt-anim clshideErr losefocus has-content" autocomplete="off" id="' + TST + "FFNNUMBER_" + ffncnt + ffnNew[i].split("~")[0] + '" value="' + flightffnnumber + '" data-paxref=' + ffnNew[i].split("~")[2] + ' data-segref=' + "1" + '  data-Itinref=' + i + '  maxlength="20" onkeypress="javascript:return isNumericVal(event);"/>'
                            Airlinedatacount += ' </div>'

                            Airlinedatacount += ' </div>'

                            Airlinedatacount += ' <br/>'
                            //Airlinedatacount += ' <br/>'
                            //Airlinedatacount += ' <br/>'
                            ffncnt++;
                        }
                    }
                    if (FFNadult_cnt < checkadt) {
                        // ss++;
                    }
                }
                Airlinedatacount += '</div>'
                Airlinedatacount += '</div>'
                Airlinedatacount += '</div>';

                Airlinedatacount += '</div>';
                Airlinedatacount += '</div>';
                Airlinedatacount += '</div>';
            }
            //  }
        }
        $("body").data("Changeffnno", strffnstatus);
        if (Airlinedatacount != "" && Airlinedatacount != null) {
            $("#dvFrequentFlyer").html(Airlinedatacount);

            $("#dvFrequentFlyer").css("display", "block")

        }
        VarX = "1";
    }

    function showText() {
        if ($("#rdiocustomer")[0].checked) {
            $("#spnNoteText").hide();
        }
        else if ($("#rdioriya")[0].checked) {
            $("#spnNoteText").show();
        }
    }

    var TicketingMode = "CT";
    function DirectBooking() {
        TicketingMode = "DT";
        var status = false;
        var noOfCheckBox = document.getElementById('table1').getElementsByTagName('input');
        var TST = "", TSTRef = "";
        var TotalFare = "";
        var FareType = "";
        for (var i = 0; i < noOfCheckBox.length; i++) {
            if (noOfCheckBox[i].checked) {
                status = true;
                TotalFare = noOfCheckBox[i].value;
                TST = noOfCheckBox[i].id.replace('tst', '');
                TSTRef = $('#' + noOfCheckBox[i].id).data("tstref");
                FareType = $('#' + TST).data("farequalifier").toUpperCase().trim();
            }
        }

        //$('#popupfare').html(TotalFare);
        //$('#spnPopupFare').html(TotalFare);
        var markupvalue = $("body").data("markupvalue");
        $('#popupfare').html(TotalFare);
        $('#spnPopupFare').html(Number(TotalFare) + Number(markupvalue));
        $("#hdn_farequalifier").val(FareType);
        $("#hdn_pricingToken").val();
        $("#hdn_TSTReference").val(TSTRef);
        $('#hdnOBCAmountTopup').val("0");
        $('#hdnOBCAmount').val("0");

        if (status == false) {
            infoAlert("Select atleast one TST for Direct Booking!", "");
            return false;
        }

        var strCount = $(".RadioSelected").length;
        if (parseInt(strCount) > 1) {
            infoAlert("Only one TST is allowed at a time.", "");
            return false;
        }

        if (GST == "Y" && $("#ddlgststate").val() != "ALL") {
            if ($("#ddlgststate").val() == null || $("#ddlgststate").val() == "") {
                infoAlert("Please select GST state.", "ddlgststate");
                return false;
            }
            if ($("#txtgstNumber").val() == null || $("#txtgstNumber").val() == "") {
                infoAlert("Please enter GST number.", "txtgstNumber");
                return false;
            }
            if ($("#txtgstCompanyname").val() == null || $("#txtgstCompanyname").val() == "") {
                infoAlert("Please enter GST Company .", "txtgstCompanyname");
                return false;
            }
            if ($("#txtgstAddress").val() == null || $("#txtgstAddress").val() == "") {
                infoAlert("Please enter GST Address .", "txtgstAddress");
                return false;
            }
            if ($("#txtgstEmailid").val() == null || $("#txtgstEmailid").val() == "") {
                infoAlert("Please enter GST Mail id .", "txtgstEmailid");
                return false;
            }
            if ($("#txtgstMobileNumber").val() == null || $("#txtgstMobileNumber").val() == "") {
                infoAlert("Please enter GST Mobile number .", "txtgstMobileNumber");
                return false;
            }
        }
        $('#ddlPaymentMode').val("0");
        $('#txtar_remarks').val("");
        $('#dvBookdata').hide();
        $('#dvinnerFaRe').html("");
        $('#dvPaymentdata').show();
        $('#dvNoTicketing').html('<a class="c-button b-50 bg-aqua hv-transparent action-button colorB1" id="btnNo" data-izimodal-close data-izimodal-transitionout="bounceOutDown" style="height: 35px; padding: 1px;"><span>NO</span></a>');
        CallFarepopup("Payment Details", "modal-FarePopup", "700");
    }

    function Allowgst() {
        if (document.getElementById('allow_gst').checked == true) {
            $("#gst_details").slideDown();
        }
        else {
            $("#gst_details").slideUp();
            $("#ddlgststate").val("ALL");
            $("#txtgstNumber").val("");
            $("#txtgstCompanyname").val("");
            $("#txtgstAddress").val("");
            $("#txtgstEmailid").val("");
            $("#txtgstMobileNumber").val("");
        }
    }

    function ClientBalanceCheck() {
        try {

            var strAgentID = $('#hdnClientID').val();
            var strBranchID = $('#hdnBranchID').val();

            $.blockUI({
                message: '<img alt="Please Wait..." src="' + loadurl + '" style="background-color:#fff; border-radius:8px; margin-top:12%;" id="FareRuleLodingImage" />',
                css: { padding: '5px' }
            });
            $.ajax({
                type: "POST", 		//GET or POST or PUT or DELETE verb
                url: "@Url.Action("GetClientBalance", "RetriveBooking")",// Location of the service
                data: '{strAgentID:"' + strAgentID + '",strBranchID:"' + strBranchID + '"}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data.Status == "-1") {
                        window.location.href = '@Url.Action("SessionExp","Redirect")';
                        return false;
                    }
                    else if (data.Status == "02") {
                        $.unblockUI();
                        alert(data.Message);
                        $("#dvAgentnotauth").show();
                        $("#retriveinformation").hide();

                    }
                    else if (data.Status == "01") {
                        $.unblockUI();
                        var arr = JSON.parse(data.Result);
                        var creditbalance = arr.P_FETCH_POS_CREDIT_BALANCE;
                        //if (creditbalance.length > 0) {
                        //$('#txtCreditAmount').html(arr.P_FETCH_POS_CREDIT_BALANCE7.length > 0 ? arr.P_FETCH_POS_CREDIT_BALANCE7[0].ADD_CREDIT_AMOUNT : "0");
                        //$('#txtCreditLimit').html(creditbalance[0].CAPPINGAMOUNT);//SHADOWBALANCE_LIMIT
                        $('#txtCreditBalance').html(creditbalance[0].CREDITBALANCE);
                        // $('#txtCreditOut').html(creditbalance[0].CREDIT_OUTSTANDING);
                        // }
                        // $('#divbalance').show();
                    }
                    else {
                        $.unblockUI();
                        alert(data.Message);
                    }
                },
                error: function (ex) {
                    $.unblockUI();
                    alert(ex.responseText);
                }
            });
        }
        catch (e) {
            console.log(e.message);
        }
    }

    function ShowHideAccountingBtn() {
    }
</script>
